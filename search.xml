<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>å­—ç¬¦é›†æ€»ç»“</title>
      <link href="/2018/05/05/%E5%AD%97%E7%AC%A6%E9%9B%86%E6%80%BB%E7%BB%93/"/>
      <url>/2018/05/05/%E5%AD%97%E7%AC%A6%E9%9B%86%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p><img src="https://img.vim-cn.com/b5/2b3603aa71348a0956bac67ccc45303ec07e05.png" alt="ä¸€å›¾è¯»æ‡‚å„ç§å­—ç¬¦é›†"></p><p>SBCS(single-byte character set)ï¼šISO-8859-1<br>DBCS(double-byte character set)ï¼šUSC-2<br>MBCS(multi-byte character set)ï¼šGB2312ã€GBKã€UTF-8ã€â€¦<br>Big Endianï¼šæ­£åºå­˜å‚¨å­—èŠ‚ï¼Œå¯¹äºå­—ç¬¦ä¸² <code>AB</code> å­˜å‚¨å½¢å¼ä¸º <code>00 41 00 42</code><br>Littile Endianï¼šé€†åºå­˜å‚¨å­—èŠ‚ï¼Œå¯¹äºå­—ç¬¦ä¸² <code>AB</code> å­˜å‚¨å½¢å¼ä¸º <code>41 00 42 00</code><br>Big Endianä¸Littile Endianä½¿ç”¨BOMåŒºåˆ†ï¼š<br>BOM(Big Endian)ï¼šæ–‡ä»¶å¼€å¤´æ·»åŠ 0xFEFF<br>BOM(Littile Endian)ï¼šæ–‡ä»¶å¼€å¤´æ·»åŠ 0xFFFE<br>ä¸‹å›¾ä¸ºwindowsç³»ç»Ÿè®°äº‹æœ¬å­˜å‚¨å¯¹åº”ç¼–ç ï¼š<br><img src="https://img.vim-cn.com/80/0a9c7790e1566c24c40c3f6ef9751a8058eb47.png" alt="è®°äº‹æœ¬å­˜å‚¨å¯¹åº”ç¼–ç "></p><p>USC-2è½¬UTF-8è§„åˆ™ï¼š<br>ISO-8859-1 ä¸å˜</p><p>00000000 10000000â†”0x0080 =&gt; <strong>110</strong>0000 <strong>10</strong>000000<br>â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“<br>00000xxx 1xxxxxxxxâ†”0x0XXX =&gt; <strong>110</strong>xxxxx <strong>10</strong>xxxxxx<br>â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“<br>00000111 11111111â†”0x07FF =&gt; <strong>110</strong>11111 <strong>10</strong>111111</p><p>00001000 00000000â†”0x0800 =&gt; <strong>1110</strong>0000 <strong>10</strong>000000 <strong>10</strong>000000<br>â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“<br>xxxx1xxx xxxxxxxxxâ†”0xXXXX =&gt; <strong>1110</strong>xxxx <strong>10</strong>xxxxxx <strong>10</strong>xxxxxx<br>â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“<br>11111111 11111111â†”0xFFFF =&gt; <strong>1110</strong>1111 <strong>10</strong>111111 <strong>10</strong>111111</p><p>Qï¼šåœ¨è®°äº‹æœ¬ä¸­å­˜å‚¨å­—ç¬¦ä¸²â€œè”é€šâ€å†æ¬¡æ‰“å¼€ä¹±ç ï¼Ÿ<br>Aï¼š<br>è®°äº‹æœ¬é»˜è®¤ä½¿ç”¨ANSIç¼–ç å­˜å‚¨å­—ç¬¦ï¼Œåœ¨ç®€ä½“ä¸­æ–‡ç³»ç»Ÿä¸­å³ä¸ºGBKç¼–ç ã€‚â€œè”é€šâ€å¯¹åº”GBKç¼–ç ä¸ºï¼š<br>11000001 10101010<br>â€“Câ€”-1â€“ â€“Aâ€”-Aâ€“<br>11001101 10101000<br>â€“Câ€”-Dâ€“ â€“Aâ€”-8â€“<br>ä¸UTF-8ä¸¤å­—èŠ‚ç¼–ç è§„åˆ™ç›¸å»åˆï¼Œæ•…è®°äº‹æœ¬è¯¯ä»¥ä¸ºæ˜¯UTF-8ç¼–ç çš„ä¸¤ä¸ªå­—ç¬¦<br><strong>110</strong>00001 <strong>10</strong>101010<br><strong>110</strong>01101 <strong>10</strong>101000<br>å»é™¤å‰ç¼€ï¼Œå‰é¢è¡¥0ï¼Œå¾—å‡ºç›¸åº”USC-2ç¼–ç <br>00000000 01101010<br>â€“0â€”-0â€“ â€“6â€”-Aâ€“<br>00000011 01101000<br>â€“0â€”-3â€“ â€“6â€”-8â€“<br>æ•…ä¹±ç </p>]]></content>
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­—ç¬¦ </tag>
            
            <tag> å­—ç¬¦é›† </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SSHæ¡†æ¶-åˆè¯†Spring</title>
      <link href="/2018/04/23/SSH%E6%A1%86%E6%9E%B6-%E5%88%9D%E8%AF%86Spring/"/>
      <url>/2018/04/23/SSH%E6%A1%86%E6%9E%B6-%E5%88%9D%E8%AF%86Spring/</url>
      <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æœ€åˆçš„Java EEï¼ˆç°è¢«Oracleå…¬å¸æ”¹ç§°Jakarta EEï¼ŒçœŸä¼šç©ğŸ˜‚ï¼‰è§„èŒƒç”±Sunå…¬å¸åˆ¶å®šï¼ŒåŒ…å«JDBCã€JNDIã€JavaBeanã€Annotationã€JPAã€CDIï¼ˆå®¹å™¨ä¾èµ–æ³¨å…¥ï¼‰ç­‰å¤šé¡¹é‡é‡çº§æŠ€æœ¯ï¼Œå…¶å®ç°çº·ç¹å¤æ‚ã€‚<br>è€ŒSpringæ¡†æ¶è½»é‡å®ç°Java EEæŠ€æœ¯ï¼Œå°è£…è¯¸å¦‚JDBCã€JavaMailå¤šé¡¹æŠ€æœ¯é™ä½ä½¿ç”¨éš¾åº¦ï¼Œä¸”å®ç°æ§åˆ¶åè½¬ï¼ˆIoCï¼‰æ¨¡å¼ä¸é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰çš„ç‹¬ç‰¹åŠŸèƒ½å¤§å¤§è§£æ”¾ç¨‹åºå‘˜åŒæ‰‹ï¼</p><h1 id="IoC"><a href="#IoC" class="headerlink" title="IoC"></a>IoC</h1><p>IoCï¼ˆæ§åˆ¶åè½¬ï¼Œå³å¯¹è±¡æ§åˆ¶æƒè½¬äº¤è‡³å®¹å™¨ï¼‰æ˜¯ä¸€ç§å…¨æ–°çš„è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡DIï¼ˆä¾èµ–æ³¨å…¥ï¼Œå³è‡ªåŠ¨æ³¨å…¥è¢«ä¾èµ–å±æ€§ï¼‰å°†å¯¹è±¡çš„åˆ›å»ºä¸ç»´æŠ¤è½¬äº¤IoCå®¹å™¨ï¼ˆæˆ–ç§°å·¥å‚ï¼‰æ§åˆ¶ã€‚ç”¨æˆ·ä»…éœ€ç¼–å†™(xml)é…ç½®æ–‡ä»¶æ— éœ€ <code>new</code> æ“ä½œå³å¯é™ä½ä»£ç è€¦åˆåº¦ã€‚<br>å…¶åŸç†ç±»ä¼¼å·¥å‚æ¨¡å¼çš„åå°„æœºåˆ¶ <code>Class.forName(str).newInstance()</code> ã€‚</p><h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><p>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯ä¸€ç§å‡½æ•°å¼ç¼–ç¨‹çš„æŠ€æœ¯ã€‚é€šè¿‡é¢„ç¼–è¯‘æˆ–åŠ¨æ€ä»£ç†æ’å…¥æ‰§è¡Œä¸šåŠ¡æ— å…³ç‰‡æ®µï¼Œå¦‚æ—¥å¿—è®°å½•ã€å®‰å…¨æ§åˆ¶ã€æ€§èƒ½ç»Ÿè®¡ã€‚ç”¨æˆ·æ— éœ€å¢æ·»ä¸šåŠ¡å†…å®¹ä»è€Œé™ä½ä»£ç è€¦åˆåº¦ã€‚<br>é€šä¿—åœ°è¯´ï¼Œè§†ä¸šåŠ¡ä»£ç ä¸ºé¢å›¢ï¼Œè§†æ’å…¥ä»£ç æ®µä¸ºå¯å¤šæ¬¡é‡å¤åˆ‡å…¥ä½¿ç”¨çš„åˆ€ç‰‡ï¼Œåˆ€åˆ‡é¢è¡Œä¸ºå°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://img.vim-cn.com/86/0fdbdc454594de2397a63caa3a951409b4badf.png" alt="AOPæ¦‚å¿µå›¾"></p><ul><li>é¢„ç¼–è¯‘æŒ‡åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ’å…¥ä»£ç æ®µï¼Œéœ€è¦ç›¸å…³ç¼–è¯‘å™¨ï¼Œå®ç°ä»£è¡¨æœ‰AspectJæ¡†æ¶ã€‚</li><li><p>åŠ¨æ€ä»£ç†æŒ‡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œæ— éœ€ç‰¹å®šç¼–è¯‘å™¨ï¼Œå®ç°ä»£è¡¨åˆ†ä¸ºJDKåŠCGLIBç±»åº“ï¼š</p><ul><li><p>JDKé‡‡ç”¨åå°„æœºåˆ¶å®ç°åŠ¨æ€ä»£ç†ï¼Œä»…ä»£ç†æ¥å£ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doJob</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleImpl</span> <span class="keyword">implements</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Running method: doJob()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExampleHandler</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxyObject, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">//æ‰§è¡Œæ—¥å¿—è®°å½•ç­‰åŠŸèƒ½</span></span><br><span class="line">        System.out.println(<span class="string">"Before method: "</span> + method.getName());</span><br><span class="line">        Obeject result = method.invoke(target, args);</span><br><span class="line">        System.out.println(<span class="string">"After method: "</span> + method.getName());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyUtil</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¯¥æ–¹æ³•æ— éœ€æ”¹åŠ¨</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">getProxy</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        ProxyHandler proxyHandler = <span class="keyword">new</span> ProxyHandler(target);</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºç”Ÿæˆä»£ç†ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°ç”¨äºæŒ‡å®šä»£ç†æ¥å£é›†åˆï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ç”¨äºå®ç°ä»£ç†å¯¹è±¡æ–¹æ³•</span></span><br><span class="line">        T proxy = (T) Proxy.newProxyInstance(</span><br><span class="line">                target.getClass().getClassLoader(),</span><br><span class="line">                target.getClass().getInterfaces(),</span><br><span class="line">                proxyHandler</span><br><span class="line">            );</span><br><span class="line">        <span class="keyword">return</span> proxy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Example example = Proxy.getProxy(<span class="keyword">new</span> ExampleImpl());</span><br><span class="line">        example.doJob();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>newProxyInstance</code> æ–¹æ³•å®ç°åŸç†å¦‚ä¸‹ï¼š<br><code>`</code>Java<br>public static Object newProxyInstance(ClassLoader classLoader, Class&lt;?&gt;[] intfs, InvocationHandler handler) throws IllegalArgumentException {<br>  Objects.requireNonNull(handler);<br>  final Class&lt;?&gt;[] interfaces = intfs.clone();<br>  final SecurityManager sm = System.getSecurityManager();<br>  if (sm != null)</p><pre><code>checkProxyAccess(Reflection.getCallerClass(), classLoader, interfaces);</code></pre><p>  //åˆ›å»ºä»£ç†ç±»<br>  Class&lt;?&gt; clazz = getProxyClass0(classLoader, interfaces);<br>  /*</p><ul><li>æ ¹æ®ç”Ÿæˆçš„classé€šè¿‡åå°„è·å–æ„é€ å‡½æ•°å¯¹è±¡å¹¶ç”Ÿæˆä»£ç†ç±»å®ä¾‹<br>*/<br>try {<br> if (sm != null) {<pre><code>checkNewProxyPermission(Reflection.getCallerClass(), clazz);</code></pre> }<br> final Constructor&lt;?&gt; constructor = clazz.getConstructor(constructorParams);<br> final InvocationHandler finalHandler = handler;<br> if (!Modifier.isPublic(cl.getModifiers())) {<pre><code>AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {    public Void run() {        cons.setAccessible(true);        return null;    }});</code></pre> }<br> return cons.newInstance(new Object[]{h});<br>} catch (IllegalAccessException|InstantiationException e) {<br> throw new InternalError(e.toString(), e);<br>} catch (InvocationTargetException e) {<br> Throwable t = e.getCause();<br> if (t instanceof RuntimeException) {<pre><code>throw (RuntimeException) t;</code></pre> } else {<pre><code>throw new InternalError(t.toString(), t);</code></pre> }<br>} catch (NoSuchMethodException e) {<br> throw new InternalError(e.toString(), e);<br>}<br>}<h1 id="Strutsç®€å²"><a href="#Strutsç®€å²" class="headerlink" title="Strutsç®€å²"></a>Strutsç®€å²</h1></li></ul></li></ul></li></ul><h1 id="è¿‡æ»¤å™¨-filter"><a href="#è¿‡æ»¤å™¨-filter" class="headerlink" title="è¿‡æ»¤å™¨(filter)"></a>è¿‡æ»¤å™¨(filter)</h1><h1 id="Struts2åŸç†"><a href="#Struts2åŸç†" class="headerlink" title="Struts2åŸç†"></a>Struts2åŸç†</h1><h1 id="Struts2ä½¿ç”¨"><a href="#Struts2ä½¿ç”¨" class="headerlink" title="Struts2ä½¿ç”¨"></a>Struts2ä½¿ç”¨</h1><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><h2 id="åˆ›å»ºaction"><a href="#åˆ›å»ºaction" class="headerlink" title="åˆ›å»ºaction"></a>åˆ›å»ºaction</h2>]]></content>
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSH </tag>
            
            <tag> æ¡†æ¶ </tag>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SSHæ¡†æ¶-åˆè¯†Hibernate</title>
      <link href="/2018/04/08/SSH%E6%A1%86%E6%9E%B6-%E5%88%9D%E8%AF%86Hibernate/"/>
      <url>/2018/04/08/SSH%E6%A1%86%E6%9E%B6-%E5%88%9D%E8%AF%86Hibernate/</url>
      <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æ—©æœŸçš„åº”ç”¨ç¨‹åºå‡ç›´æ¥è°ƒç”¨æ•°æ®åº“è½¯ä»¶æä¾›çš„æ–¹æ³•æ‰‹å†Œè¯»å–æ•°æ®ï¼Œå½“éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œæ›´æ¢ã€å‡çº§æ—¶ï¼Œå¿…é¡»é‡å†™ä¸æ•°æ®åº“çš„é€šè®¯æ–¹æ³•ï¼Œè¿™å¯¹å¼€å‘äººå‘˜æ˜¯ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ã€‚å› æ­¤å­•è‚²å‡ºJDBCè§£å†³æ–¹æ¡ˆã€‚<br>JDBC(Java DataBase Connectivity)æ–¹æ¡ˆæ˜¯Javaè¿æ¥æ•°æ®åº“çš„æ ‡å‡†è§„èŒƒã€‚é€šè¿‡å¢åŠ ä¸€å±‚å›ºå®šçš„æ ‡å‡†ç±»ä¸æ¥å£ï¼Œä½¿å¾—å¼€å‘äººå‘˜æ— éœ€å…³æ³¨æ•°æ®åº“æ“ä½œæ–¹æ³•ï¼Œåªéœ€è°ƒç”¨JDBCæä¾›çš„å„ç§APIå³å¯ã€‚è€Œæ•°æ®åº“ç”Ÿäº§å•†åªéœ€å®ç°JDBCé©±åŠ¨å±‚å³å¯ã€‚å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://img.vim-cn.com/62/cf9adff5bed9654011a935c0f44be15980eb94.png" alt="JDBCç®€å›¾"> <img src="https://img.vim-cn.com/e9/9d088616fa0c3a624145894150334460afb475.png" alt="JDBC API"><br>JDBCæ‰§è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š<br><img src="https://img.vim-cn.com/7c/4a08c875f8ffc2c4077b8979fba1fb54bd81a3.png" alt="JDBCæ‰§è¡Œæµç¨‹å›¾"><br>ç°åœ¨åªéœ€å¯¼å…¥ç›¸åº”æ•°æ®åº“JDBCé©±åŠ¨åŒ…ï¼Œæ ¹æ®æµç¨‹å›¾ï¼Œå³å¯å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//æ ¹æ®Javaåå°„æœºåˆ¶åŠ¨æ€åŠ è½½é©±åŠ¨ç¨‹åº</span></span><br><span class="line">        Class.forName(<span class="string">"com.dataBase.jdbc.Driver"</span>);</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(</span><br><span class="line">                        <span class="string">"jdbc:dataBase://localhost:port/example"</span>,</span><br><span class="line">                        <span class="string">"username"</span>,</span><br><span class="line">                        <span class="string">"password"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Product</span><span class="params">(<span class="keyword">int</span> id, String name, <span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        Statement st = <span class="keyword">null</span>;</span><br><span class="line">        ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            conn = JDBCUtil.getConnection();</span><br><span class="line">            st = conn.createStatement();</span><br><span class="line">            rs = st.executeQuery(<span class="string">"select id,name,price from t_product where id='"</span> + id + <span class="string">"'"</span>);</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                <span class="keyword">int</span> id = rs.getInt(<span class="string">"id"</span>);</span><br><span class="line">                String name = rs.getString(<span class="string">"name"</span>);</span><br><span class="line">                <span class="keyword">float</span> price = rs.getFloat(<span class="string">"price"</span>);</span><br><span class="line">                Product product = <span class="keyword">new</span> Product(id, name, price);</span><br><span class="line">                <span class="keyword">return</span> product;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                rs.close();</span><br><span class="line">                st.close();</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç°åœ¨åªç”¨JDBCUtilç±»å³å¯ï¼Œè€Œæ— éœ€å…³å¿ƒæ•°æ®åº“è°ƒç”¨æ–¹å¼ã€‚ä¸è¿‡æ¯æ¬¡æ‰§è¡ŒSQLè¯­å¥å‡éœ€é‡æ–°åˆ›å»ºConnectionå¯¹è±¡ä¸æ•°æ®åº“è¿æ¥ï¼Œä¸”ä»£ç ä¸­ä¾æ—§å¤¹æ‚ç€é©±åŠ¨ç¨‹åºåŒ…åã€JDBC URLåœ°å€ã€ç”¨æˆ·åã€å¯†ç ï¼Œä¸ä¾¿ä¿®æ”¹ã€‚äºæ˜¯å¼•å…¥JNDIæŠ€æœ¯ï¼Œé€šè¿‡åˆ›å»ºæ•°æ®åº“è¿æ¥æ± ç¼“å­˜Connectionå¯¹è±¡ï¼ŒåŒæ—¶å°†é…ç½®å­—æ®µå†™å…¥XMLé…ç½®æ–‡ä»¶ï¼Œæ— éœ€æ”¹åŠ¨JDBCè¿æ¥ä»£ç ï¼Œä»¥ä¸å˜åº”ä¸‡å˜ã€‚ä»¥Tomcatä¸ºä¾‹ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><ol><li><p>é…ç½®Tomcatï¼Œåœ¨web.xmlé…ç½®æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">resource-ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-ref-name</span>&gt;</span>dataBaseDataSource<span class="tag">&lt;/<span class="name">res-ref-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-ref-type</span>&gt;</span>javax.sql.DataSource<span class="tag">&lt;/<span class="name">res-ref-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-auth</span>&gt;</span>Container<span class="tag">&lt;/<span class="name">res-auth</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">res-sharing-scope</span>&gt;</span>Shareable<span class="tag">&lt;/<span class="name">res-sharing-scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource-ref</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨MATA-INFæ–‡ä»¶å¤¹ä¸­åˆ›å»ºæ–‡ä»¶ <code>context.xml</code> å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">antiJARLocking</span>=<span class="string">"true"</span> <span class="attr">path</span>=<span class="string">"/webProject"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--auth="Container"è¡¨ç¤ºèµ„æºç”±å®¹å™¨ç®¡ç†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Resource</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"dataBaseDataSource"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">auth</span>=<span class="string">"Container"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"javax.sql.DataSource"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">driverClassName</span>=<span class="string">"com.dataBase.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">url</span>=<span class="string">"jdbc:dataBase://localhost:port/example"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">username</span>=<span class="string">"username"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">password</span>=<span class="string">"password"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºJNDIå·¥å…·ç±»ç”¨äºè¿æ¥æ•°æ®åº“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JNDIUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Connection connOracle = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Context initContext = <span class="keyword">new</span> InitialContext();</span><br><span class="line">            DataSource ds = (DataSource)initContext.lookup(<span class="string">"java:comp/env/dataBaseDataSource"</span>);</span><br><span class="line">            <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>JNDIæ‰§è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š<br><img src="https://img.vim-cn.com/a9/47aa816bdbbafe3533c208ccd59dd8572e6f52.png" alt="JNDIæ‰§è¡Œæµç¨‹å›¾"></p><ol><li>åˆ›å»ºContextå¯¹è±¡è¯»å–é…ç½®æ–‡ä»¶</li><li>é€šè¿‡DataSourceæ•°æ®èµ„æºå¯¹è±¡åº”ç”¨é…ç½®åˆ›å»ºæ•°æ®åº“è¿æ¥æ± </li><li>åˆ›å»ºConnectionæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œè¿æ¥æ•°æ®åº“</li><li>åˆ›å»ºStatementæ•°æ®åº“æ“ä½œå¯¹è±¡ï¼Œç”¨äºæ•°æ®å­˜å–æ“ä½œ</li><li>è°ƒç”¨Statementä¼šè¯å¯¹è±¡çš„æ•°æ®åº“æ“ä½œæ–¹æ³•è¿”å›ResultSetç»“æœé›†å¯¹è±¡ã€‚</li></ol><p>ç„¶è€Œåœ¨æœ‰å…³æ•°æ®åº“çš„æ“ä½œä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦ä½¿ç”¨ <code>æ¨¡å‹(POJO, å³JavaBean) + æ•°æ®åº“æ“ä½œå±‚(Dao)</code> æ¨¡å¼ï¼Œåœ¨Daoå±‚ï¼ˆå¦‚ä¸Šæ–‡ProductDaoç±»ï¼‰ç¼–å†™å¤§é‡å†—ä½™ä»£ç ä»¥åŠä¸åŒSQLè¯­å¥ï¼Œä¸ºè®©ç”Ÿæ´»æ›´åŠ ç¾å¥½ï¼Œå¯¹JDBCè½»é‡å°è£…çš„Hibernateæ¨ªç©ºå‡ºä¸–ï¼Œå…¶é‡‡ç”¨çš„ROMæ¡†æ¶æŠ€æœ¯å¤§å—è¿½æ§ã€‚</p><h1 id="ROMæŠ€æœ¯"><a href="#ROMæŠ€æœ¯" class="headerlink" title="ROMæŠ€æœ¯"></a>ROMæŠ€æœ¯</h1><p>ç”±äºJavaæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰è¯­è¨€ä¸å…³ç³»å‹æ•°æ®åº“æ€æƒ³æ ¼æ ¼ä¸å…¥ï¼Œæ•…äº§ç”ŸORM(Object Relationship Mapping)å³å¯¹è±¡å…³ç³»æ˜ å°„æŠ€æœ¯ï¼Œä½¿å¼€å‘äººå‘˜æ›´åŠ ä¸“æ³¨äºé¢å‘å¯¹è±¡æ€è€ƒã€‚</p><h1 id="Hibernateç®€ä»‹"><a href="#Hibernateç®€ä»‹" class="headerlink" title="Hibernateç®€ä»‹"></a>Hibernateç®€ä»‹</h1><p>Hibernateä¸ºä¸€å®ç°<strong>JPAæ ‡å‡†ï¼ˆå³ ROM+å®ä½“å¯¹è±¡æŒä¹…åŒ– æ ‡å‡†ï¼‰</strong>çš„å¼€æºå¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶ï¼Œæ”¯æŒåˆ†å¸ƒå¼æ•°æ®åº“ã€‚å…¶å¯¹JDBCè¿›è¡Œäº†è½»é‡çº§å¯¹è±¡å°è£…ï¼Œä½¿å¾—ç”±ç›´æ¥æ“çºµæ•°æ®åº“å˜æˆä½¿ç”¨ä¾æ®æ˜ å°„æ•°æ®è¡¨ï¼ˆXMLé…ç½®æ–‡ä»¶ï¼‰æˆ–æ³¨è§£ç”Ÿæˆçš„Javaç±»ï¼Œä¸”ç”Ÿæˆçš„å®ä½“å¯¹è±¡æŒç»­è‡ªåŠ¨å°†æ•°æ®å˜åŠ¨ä¿å­˜è‡³æ•°æ®åº“ï¼ˆå³æŒä¹…åŒ–æŠ€æœ¯ï¼‰ï¼Œä»è€Œä»¥å¯¹è±¡ç¼–ç¨‹æ€ç»´æ“çºµæ•°æ®åº“ã€‚åŒæ—¶ï¼ŒHibernateæ‘†è„±ä¸åŒæ•°æ®åº“SQLè¯­å¥å·®å¼‚ï¼Œè½¬è€Œæ¥æ”¶ç¬¦åˆæè¿°å¯¹è±¡çš„HQLè¯­å¥æ“ä½œã€‚</p><h1 id="HibernateåŸç†"><a href="#HibernateåŸç†" class="headerlink" title="HibernateåŸç†"></a>HibernateåŸç†</h1><p>HibernateåŸç†å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://img.vim-cn.com/70/c704106616b6ce07f62dc11f70ae1d23375337.png" alt="HibernateåŸç†"></p><ul><li>æŒä¹…åŒ–å¯¹è±¡ï¼šä¾æ®æ˜ å°„æ•°æ®è¡¨ï¼ˆHBMï¼Œå³å…³äºç±»çš„XMLé…ç½®æ–‡ä»¶ï¼‰æˆ–æ³¨è§£ç”Ÿæˆçš„èƒ½å¤ŸæŒç»­è‡ªåŠ¨å°†æ•°æ®å˜åŠ¨ä¿å­˜è‡³æ•°æ®åº“çš„å®ä½“å¯¹è±¡ã€‚</li><li>é…ç½®æ–‡ä»¶ï¼šå³Hibernateé…ç½®æ–‡ä»¶hibernate.cfg.xmlã€‚</li><li>æ˜ å°„æ–‡ä»¶ï¼šæŒä¹…åŒ–å¯¹è±¡çš„Javaç±»å¯¹åº”çš„æ˜ å°„æ•°æ®è¡¨æ–‡ä»¶object.hbm.xmlï¼ˆå¦‚student.hbm.xmlï¼‰ï¼Œç”¨äºæ•°æ®åº“æ•°æ®ä¸Javaå¯¹è±¡è½¬åŒ–ã€‚</li></ul><p>Hibernateæ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š<br><img src="https://img.vim-cn.com/e1/6ad72dd100a768dae58a22eabe13bb6854487c.png" alt="Hibernateæ‰§è¡Œæµç¨‹å›¾"></p><ol><li>åˆ›å»ºConfigurationå¯¹è±¡è¯»å–hibernate.cfg.xmlé…ç½®æ–‡ä»¶</li><li>é€šè¿‡StandardServiceRegistryBuilderå¯¹è±¡åº”ç”¨é…ç½®åˆ›å»ºServiceRegistryæœåŠ¡æ³¨å†Œå¯¹è±¡ç”¨äºæ³¨å†Œå„é¡¹æœåŠ¡</li><li>åˆ›å»ºMetaDataå…ƒæ•°æ®ï¼ˆæ•°æ®åº“ä¿¡æ¯ï¼‰å¯¹è±¡ï¼Œæ­¤æ­¥å¯çœç•¥ï¼Œä»…å½“éœ€è¦æ‰§è¡Œè¡¨ç»“æ„æ“ä½œæ—¶ä½¿ç”¨</li><li>åˆ›å»ºSessionFactoryä¼šè¯å·¥å‚å¯¹è±¡ï¼Œé€šè¿‡Configurationå¯¹è±¡çš„ <code>buildSessionFactory(serviceRegistry)</code> ä¼ å…¥æœåŠ¡æ³¨å†Œå¯¹è±¡æ³¨å†Œæ­¤å·¥å‚æœåŠ¡ï¼Œç”¨äºç”Ÿäº§å°è£…äº†è¿æ¥æ± ä¸­Connectionå¯¹è±¡çš„ä¼šè¯ï¼ˆSessionï¼‰å¯¹è±¡ï¼›è‹¥å­˜åœ¨MetaDataå¯¹è±¡ï¼Œä¹Ÿå¯è°ƒç”¨å…¶ <code>buildSessionFactory()</code> æ–¹æ³•</li><li>åˆ›å»ºSessionä¼šè¯å¯¹è±¡ï¼Œç”¨äºæ•°æ®å­˜å–æ“ä½œ</li><li>è°ƒç”¨Sessionä¼šè¯å¯¹è±¡çš„ <code>beginTransaction()</code> å¼€å¯äº‹åŠ¡ï¼Œé€šè¿‡å›æ»šç­‰æ“ä½œé¿å…éƒ¨åˆ†ä¿®æ”¹é€ æˆæ•°æ®ä¸å®Œæ•´ï¼Œç¡®ä¿æ•°æ®åº“è¢«æ­£ç¡®ä¿®æ”¹</li><li>è°ƒç”¨Sessionä¼šè¯å¯¹è±¡çš„æ•°æ®åº“æ“ä½œæ–¹æ³•ç›´æ¥è¿”å›å¯¹è±¡ç»“æœã€‚</li></ol><p><strong>å¯¹æ¯”JNDIå‘ç°é™¤å»å¯çœç•¥çš„è·å–å…ƒæ•°æ®å¯¹è±¡æ­¥éª¤3ï¼Œä»¥åŠå¯åŠ¨äº‹åŠ¡æ­¥éª¤6ï¼ŒåŸºæœ¬å¤§åŒå°å¼‚ã€‚</strong><br>ä¾æ®æµç¨‹å›¾ï¼Œå†™å‡ºå¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Metadata metadata;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SessionFactory sessionFactory;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Session session;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Transaction transaction;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Configuration configuration = <span class="keyword">new</span> Configuration().configure();</span><br><span class="line">        ServiceRegistry serviceRegistry = <span class="keyword">new</span> StandardServiceRegistryBuilder().applySettings(configuration.getProperties()).configure().build();</span><br><span class="line">        metadata = <span class="keyword">new</span> MetadataSources(serviceRegistry).buildMetadata();</span><br><span class="line">        sessionFactory = metadata.buildSessionFactory();</span><br><span class="line">        session = sessionFactory.openSession();</span><br><span class="line">        transaction = session.beginTransaction();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Product product = HibernateUtil.session.get(Product.class, id);</span><br><span class="line">            <span class="keyword">return</span> product;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                HibernateUtil.transaction.commit();</span><br><span class="line">                HibernateUtil.session.close();</span><br><span class="line">                HibernateUtil.sessionFactory.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>çœæ—¶çœåŠ›æœ‰æœ¨æœ‰ğŸ˜‚ï¼<br><strong>Hibernateä¸ä½†æ”¯æŒå•ä¸ªæ•°æ®åº“JDBCè¿æ¥æ–¹å¼ï¼Œä¹Ÿæ”¯æŒå¤šä¸ªæ•°æ®åº“JTAè¿æ¥æ–¹å¼</strong>ï¼Œæœ¬æ–‡ä»…è®¨è®ºå•ä¸ªæ•°æ®åº“è¿æ¥æ–¹å¼ã€‚</p><h1 id="Hibernateä½¿ç”¨"><a href="#Hibernateä½¿ç”¨" class="headerlink" title="Hibernateä½¿ç”¨"></a>Hibernateä½¿ç”¨</h1><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><ol><li>åˆ›å»ºJavaæˆ–Java Webé¡¹ç›®å¹¶å¯¼å…¥ä¸Hibrenateç›¸å…³çš„Jarå¼€å‘åŒ…ã€‚<a href="http://hibernate.org/orm/releases/" target="_blank" rel="noopener">å¼€å‘åŒ…ä¸‹è½½åœ°å€</a></li><li><p>åœ¨srcæ–‡ä»¶å¤¹å†…åˆ›å»ºhibernate.cfg.xmlæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºé…ç½®æ•°æ®åº“è¿æ¥æ–¹å¼ã€é©±åŠ¨ç¨‹åºåŒ…åã€JDBC URLåœ°å€ã€ç”¨æˆ·åã€å¯†ç ç­‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Hibernate/Hibernate Configuration DTD//EN"</span></span><br><span class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:dataBase://localhost:port/schema<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.dataBase.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å±æ€§dialectè¡¨ç¤ºSQLæ–¹è¨€ï¼Œä½¿ç”¨å¯¹åº”äºæ•°æ®åº“çš„SQLæ–¹è¨€é…ç½®æé«˜æ•°æ®åº“æ“ä½œæ•ˆç‡--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.DataBaseDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>username<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>password<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¾“å‡ºSQLè¯­å¥è‡³æ§åˆ¶å°ï¼Œä¸€èˆ¬ç”¨äºè°ƒè¯•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ ¼å¼åŒ–SQLè¯­å¥ï¼Œå³ç¾åŒ–æ˜¾ç¤ºSQLè¯­å¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æœ€è¿‘ä¼šè¯çš„ä¸Šä¸‹æ–‡ï¼ˆç›¸å…³ç¯å¢ƒï¼‰ç±»ï¼Œä»…å½“ä½¿ç”¨sessionFactory.getCurrentSession()æ—¶éœ€è¦æ­¤é…ç½®--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ†threadã€jtaã€æŒ‡å®šäº‹åŠ¡ç®¡ç†ç±»åä¸‰ç§å–å€¼ï¼Œthreadè¡¨ç¤ºåœ¨å½“å‰çº¿ç¨‹äº‹åŠ¡ç®¡ç†å¯¹è±¡ä¸­å¯»æ‰¾æœ€è¿‘ä¼šè¯ï¼Œjtaè¡¨ç¤ºåœ¨åˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å¯¹è±¡ä¸­å¯»æ‰¾æœ€è¿‘ä¼šè¯--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç”±äºæœ¬æ–‡ä¸è®¨è®ºJTAåˆ†å¸ƒå¼æ•°æ®åº“è¿æ¥æ–¹å¼ï¼Œæ•…åªèƒ½å–å€¼thread--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--HBMï¼ˆæ˜ å°„æ•°æ®è¡¨ï¼‰è½¬DDLï¼ˆæ•°æ®åº“æ¨¡å¼å®šä¹‰è¯­è¨€ï¼Œå³SQLå…³é”®è¯ä¸­çš„create alter drop ...ï¼‰æ–¹å¼--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ†createã€updateä¸¤ç§å–å€¼ï¼Œå‰è€…æ¯æ¬¡æ“ä½œå°†é‡æ–°åˆ›å»ºè¡¨ï¼Œåè€…ä»…ä¿®æ”¹è¡¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºHibernateå·¥å…·ç±»è¿›è¡Œä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Metadata metadata;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SessionFactory sessionFactory;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Session session;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Transaction transaction;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Configuration configuration = <span class="keyword">new</span> Configuration().configure();</span><br><span class="line">        ServiceRegistry serviceRegistry = <span class="keyword">new</span> StandardServiceRegistryBuilder().applySettings(configuration.getProperties()).configure().build();</span><br><span class="line">        metadata = <span class="keyword">new</span> MetadataSources(serviceRegistry).buildMetadata();</span><br><span class="line">        sessionFactory = metadata.buildSessionFactory();</span><br><span class="line">        <span class="comment">//ä½¿ç”¨getCurrentSession()æ— éœ€æ‰‹åŠ¨å…³é—­ä¼šè¯ï¼Œç”±ä¼šè¯ç®¡ç†ä¸Šä¸‹æ–‡ï¼ˆå³äº‹åŠ¡ç®¡ç†å¯¹è±¡ï¼‰æ§åˆ¶</span></span><br><span class="line">        session = sessionFactory.getCurrentSession();</span><br><span class="line">        transaction = session.beginTransaction();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="æ˜ å°„æ•°æ®è¡¨"><a href="#æ˜ å°„æ•°æ®è¡¨" class="headerlink" title="æ˜ å°„æ•°æ®è¡¨"></a>æ˜ å°„æ•°æ®è¡¨</h2><p>æ˜ å°„æ•°æ®è¡¨æ–‡ä»¶å†…å®¹æ¨¡æ¿å¦‚ä¸‹ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding='UTF-8'?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Hibernate/Hibernate Mapping DTD//EN"</span></span><br><span class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å±æ€§packageå¯¹åº”åŒ…å--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"pacakge"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å±æ€§nameå¯¹åº”JavBeançš„ç±»å--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å±æ€§tableå¯¹åº”æ•°æ®åº“ä¸­å­˜å‚¨æ­¤ç±»æ•°æ®çš„è¡¨å--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"student"</span> <span class="attr">table</span>=<span class="string">"tb_table"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="id"><a href="#id" class="headerlink" title="id"></a>id</h3><p>idæ ‡ç­¾ç”¨äºæŒ‡å®šä¸»é”®ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"sid"</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><p>generatoræ ‡ç­¾ç”¨äºæŒ‡å®šä¸»é”®ç”Ÿæˆç­–ç•¥ï¼ˆæ‰‹åŠ¨è¾“å…¥æˆ–è‡ªåŠ¨å¢é•¿ç­‰ï¼‰ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"sid"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--nativeè¡¨ç¤ºä¸»é”®å€¼è‡ªåŠ¨å¢é•¿ï¼Œæ ¹æ®æ•°æ®åº“ä¸åŒè‡ªåŠ¨é€‰æ‹©å¯¹åº”è‡ªå¢é…ç½®æ–¹å¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸‹ä¸ºclasså±æ€§å€¼å¯é€‰å†…å®¹ï¼š</p><ul><li>assignedï¼šä¸»é”®ç”±ç¨‹åºç”Ÿæˆ</li><li>incrementï¼šä¸»é”®ä¸ºè¡¨ä¸­æœ€å¤§å€¼åŠ ä¸€</li><li>hiloï¼šä¸»é”®ç”±é«˜ä½ä½æ–¹å¼ï¼ˆhigh lowï¼‰ç”Ÿæˆã€‚å…ˆåœ¨è¡¨ä¸­å¢é•¿highå€¼ï¼Œå†åœ¨[0, max_low]åŒºé—´ä¸­å¢é•¿lowå€¼ï¼Œæœ€åè®¡ç®—high * (max_low + 1) + lowå¾—å‡ºä¸»é”®å€¼</li><li>seqhiloï¼šåŒç†hiloï¼Œä½¿ç”¨åºåˆ—å­˜å‚¨highå€¼</li><li>sequenceï¼šä¸»é”®ä¸ºåºåˆ—ä¸­æœ€å¤§å€¼åŠ ä¸€</li><li>identityï¼šä¸»é”®ç”±æ•°æ®åº“è‡ªå¢å­—æ®µç”Ÿæˆ</li><li>nativeï¼šä¸»é”®ç”±identityæˆ–hiloæˆ–sequenceç”Ÿæˆ</li><li>uuidï¼šä¸»é”®ä¸ºé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUUIDï¼‰å­—ç¬¦ä¸²</li><li>guidï¼šç±»ä¼¼uuidï¼Œä¸»é”®ä¸ºå…¨çƒå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGUIDï¼‰å­—ç¬¦ä¸²</li><li>foreignï¼šä¸»é”®ä¸ºå¦ä¸€è¡¨ä¸­ä¸»é”®</li><li>selectï¼šä¸»é”®ç”±è§¦å‘å™¨ç”Ÿæˆ</li></ul><h3 id="property"><a href="#property" class="headerlink" title="property"></a>property</h3><p>propertyæ ‡ç­¾ç”¨äºæŒ‡å®šæ™®é€šå±æ€§ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--columnè¡¨ç¤ºè¯¥å­—æ®µåœ¨æ•°æ®åº“ä¸­å¯¹åº”åˆ—--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--not-nullè¡¨ç¤ºè¯¥å­—æ®µåœ¨æ•°æ®åº“ä¸­æ˜¯å¦ç¦æ­¢ä¸ºç©º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"sName"</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">not-null</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><p>setæ ‡ç­¾ç”¨äºæŒ‡å®šé›†åˆå±æ€§ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--lazyè¡¨ç¤ºæ˜¯å¦é‡‡ç”¨å»¶è¿ŸåŠ è½½ï¼Œå³è¯»å–æ—¶æ‰æŸ¥æ‰¾è¡¨ä¸­æ•°æ®ç»„æˆé›†åˆ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"scoreSet"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><p>keyæ ‡ç­¾ç”¨äºæŒ‡å®šé›†åˆå¯¹åº”çš„å¤–é”®åˆ—<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"scoreSet"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"scoreId"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="one-to-one"><a href="#one-to-one" class="headerlink" title="one-to-one"></a>one-to-one</h3><p>one-to-oneæ ‡ç­¾ç”¨äºæŒ‡å®šä¸€å¯¹ä¸€å…³ç³»ï¼Œå¦‚å­¦ç”Ÿä¿¡æ¯è¡¨å¯¹èº«ä»½è¯è¡¨<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"cardId"</span> <span class="attr">class</span>=<span class="string">"package.Identity"</span> <span class="attr">cascade</span>=<span class="string">"save-update"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="one-to-many"><a href="#one-to-many" class="headerlink" title="one-to-many"></a>one-to-many</h3><p>one-to-manyæ ‡ç­¾ç”¨äºæŒ‡å®šä¸€å¯¹å¤šå…³ç³»ï¼Œå¦‚æ•™å®¤è¡¨å¯¹å­¦ç”Ÿä¿¡æ¯è¡¨<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å†™äºClass.hbm.xmlæ–‡ä»¶ä¸­--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"userSet"</span> <span class="attr">inverse</span>=<span class="string">"true"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"package.User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="many-to-one"><a href="#many-to-one" class="headerlink" title="many-to-one"></a>many-to-one</h3><p>many-to-oneæ ‡ç­¾ç”¨äºæŒ‡å®šå¤šå¯¹ä¸€å…³ç³»ï¼Œå¦‚å­¦ç”Ÿä¿¡æ¯è¡¨å¯¹æ•™å®¤è¡¨<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å†™äºStudent.hbm.xmlæ–‡ä»¶ä¸­--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"userSet"</span> <span class="attr">inverse</span>=<span class="string">"true"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">class</span>=<span class="string">"package.User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="many-to-many"><a href="#many-to-many" class="headerlink" title="many-to-many"></a>many-to-many</h3><p>many-to-manyæ ‡ç­¾ç”¨äºæŒ‡å®šå¤šå¯¹å¤šå…³ç³»ï¼Œå¦‚å­¦ç”Ÿä¿¡æ¯è¡¨å¯¹æ•™å¸ˆè¡¨<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"userSet"</span> <span class="attr">inverse</span>=<span class="string">"true"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"package.User"</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><p>é™¤æŸäº›è¡¨ç¤ºç±»çš„æ³¨è§£å¤–ï¼Œé€‚ç”¨äºå±æ€§çš„æ³¨è§£æ—¢å¯ç½®äºå±æ€§ä¸Šï¼Œä¹Ÿå¯ç½®äºå¯¹åº”getæ–¹æ³•ä¸Šï¼Œ<strong>å»ºè®®ç½®äºæ–¹æ³•ä¸Š</strong>ã€‚<br>å…³ç³»æ³¨è§£å¯ç»„åˆä½¿ç”¨ï¼Œå¦‚@OneToManyä¸@ManyToOneå¯åˆ†åˆ«åœ¨ä¸¤ä¸ªç±»ä¸­åŒæ—¶å‡ºç°ã€‚</p><h3 id="Entity"><a href="#Entity" class="headerlink" title="@Entity"></a>@Entity</h3><p>Entityæ³¨è§£ç”¨äºè¡¨ç¤ºç±»ä¸ºå®ä½“ï¼ˆæ˜ å°„å¯¹è±¡ï¼‰ç±»ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Table"><a href="#Table" class="headerlink" title="@Table"></a>@Table</h3><p>Tableæ³¨è§£ç”¨äºè¡¨ç¤ºç±»å¯¹åº”çš„æ•°æ®åº“è¡¨ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Embeddable"><a href="#Embeddable" class="headerlink" title="@Embeddable"></a>@Embeddable</h3><p>Embeddableæ³¨è§£ç”¨äºè¡¨ç¤ºç±»ä¸ºåµŒå…¥å¼å®ä½“ï¼ˆæ˜ å°„å¯¹è±¡ï¼‰ç±»ï¼ˆå³æ•°æ®åº“è¡¨ä¸­åµŒå…¥å…¶æ‰€æœ‰å±æ€§ï¼Œè€Œä¸å•ç‹¬åˆ›å»ºè¡¨ï¼‰ï¼Œå¸¸ä¸@Embeddedè”ç”¨ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String country;</span><br><span class="line">    <span class="keyword">private</span> String province;</span><br><span class="line">    <span class="keyword">private</span> String city;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Embedded"><a href="#Embedded" class="headerlink" title="@Embedded"></a>@Embedded</h3><p>Embeddedæ³¨è§£ç”¨äºè¡¨ç¤ºåµŒå…¥å¼å±æ€§çº¦æŸï¼ˆå³æ•°æ®åº“è¡¨ä¸­åµŒå…¥å…¶æ‰€æœ‰å±æ€§ï¼Œè€Œä¸å•ç‹¬åˆ›å»ºè¡¨ï¼‰ï¼Œå¸¸ä¸@Embeddableè”ç”¨ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String country;</span><br><span class="line">    <span class="keyword">private</span> String province;</span><br><span class="line">    <span class="keyword">private</span> String city;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Embedded</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAddress</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> address; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123; <span class="keyword">this</span>.address = address; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="EmbeddedId"><a href="#EmbeddedId" class="headerlink" title="@EmbeddedId"></a>@EmbeddedId</h3><p>EmbeddedIdæ³¨è§£ç”¨äºè¡¨ç¤ºåµŒå…¥å¼ä¸»é”®å±æ€§çº¦æŸï¼Œç±»ä¼¼@Embeddedï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrimaryKey</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrimaryKey</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> PrimaryKey primaryKey;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@EmbeddedId</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrimaryKey</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> primaryKey; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrimaryKey</span><span class="params">(PrimaryKey primaryKey)</span> </span>&#123; <span class="keyword">this</span>.primaryKey = primaryKey; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Id"><a href="#Id" class="headerlink" title="@Id"></a>@Id</h3><p>Idæ³¨è§£ç”¨äºè¡¨ç¤ºä¸»é”®å±æ€§ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(generator = <span class="string">"AutoInc"</span>)</span><br><span class="line">    <span class="meta">@GenericGenerator</span>(name = <span class="string">"AutoInc"</span>, strategy = <span class="string">"native"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="GeneratedValue"><a href="#GeneratedValue" class="headerlink" title="@GeneratedValue"></a>@GeneratedValue</h3><p>GeneratedValueæ³¨è§£ç”¨äºè¡¨ç¤ºä¸»é”®å±æ€§ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="comment">// strategyè¡¨ç¤ºé»˜è®¤ä¸»é”®ç”Ÿæˆæ–¹æ³•ï¼Œgeneratorè¡¨ç¤ºè‡ªå®šä¹‰ä¸»é”®ç”Ÿæˆå™¨ï¼ˆé»˜è®¤ä¸ºç©ºï¼Œæ— éœ€è®¾å®šï¼‰</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.AUTO, generator=<span class="string">""</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸‹ä¸ºstrategyå±æ€§å€¼å¯é€‰å†…å®¹ï¼š</p><ul><li>GenerationType.AUTOï¼šä¸»é”®ç”±ç¨‹åºç”Ÿæˆ</li><li>GenerationType.IDENTITYï¼šä¸»é”®ç”±æ•°æ®åº“è‡ªå¢å­—æ®µç”Ÿæˆ</li><li>GenerationType.SEQUENCEï¼šä¸»é”®ä¸ºåºåˆ—ä¸­æœ€å¤§å€¼åŠ ä¸€</li><li>GenerationType.TABLEï¼šä¸»é”®ä¸ºæ–°å»ºè¡¨ä¸­æœ€å¤§å€¼åŠ ä¸€</li></ul><h3 id="GenericGenerator"><a href="#GenericGenerator" class="headerlink" title="@GenericGenerator"></a>@GenericGenerator</h3><p>ç”±äºGeneratedValueå–å€¼ä¸å¤Ÿçµæ´»<br>GenericGeneratoræ³¨è§£ç”¨äºå®šä¹‰è‡ªå®šä¹‰ä¸»é”®ç”Ÿæˆå™¨ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GenericGenerator</span>(name = <span class="string">"AutoInc"</span>, strategy = <span class="string">"native"</span>)</span><br><span class="line">    <span class="meta">@GeneratedValue</span>(generator = <span class="string">"AutoInc"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Column"><a href="#Column" class="headerlink" title="@Column"></a>@Column</h3><p>Columnæ³¨è§£ç”¨äºè¡¨ç¤ºå±æ€§å¯¹åº”åˆ—ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String introduce;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"column_introduce"</span>, length = <span class="number">100</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIntroduce</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> introduce; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIntroduce</span><span class="params">(String introduce)</span> </span>&#123; <span class="keyword">this</span>.introduce = introduce; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="JoinColumn"><a href="#JoinColumn" class="headerlink" title="@JoinColumn"></a>@JoinColumn</h3><p>JoinColumnæ³¨è§£ç”¨äºè¡¨ç¤ºåº”ç”¨æŸç§å…³ç³»è€ŒåŠ å…¥ä¸»è¡¨çš„åˆ—ï¼Œå¸¸ä¸@OneToOneã€@OneToManyã€@ManyToOneã€@ManyToManyæ³¨è§£ä¸€åŒä½¿ç”¨</p><h3 id="JoinTable"><a href="#JoinTable" class="headerlink" title="@JoinTable"></a>@JoinTable</h3><p>JoinTableæ³¨è§£ç”¨äºè¡¨ç¤ºåº”ç”¨æŸç§å…³ç³»è€ŒåŠ å…¥çš„ä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨ï¼Œå¸¸ä¸@JoinColumnã€@ManyToManyæ³¨è§£ä¸€åŒä½¿ç”¨</p><h3 id="OneToOne"><a href="#OneToOne" class="headerlink" title="@OneToOne"></a>@OneToOne</h3><p>OneToOneæ³¨è§£ç”¨äºè¡¨ç¤ºä¸€å¯¹ä¸€å…³ç³»ï¼Œå¦‚å­¦ç”Ÿä¿¡æ¯è¡¨å¯¹èº«ä»½è¯è¡¨ï¼Œåˆ†ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><ol><li><p>é»˜è®¤èº«ä»½è¯ç±»ä¸å­˜å‚¨å¯¹åº”å­¦ç”Ÿå¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_identify"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Identify</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String cardId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Identify</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCardId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> cardId; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCardId</span><span class="params">(String cardId)</span> </span>&#123; <span class="keyword">this</span>.cardId = cardId; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> Identify identify;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="comment">//cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ</span></span><br><span class="line">    <span class="meta">@OneToOne</span>(cascade = CascadeTtype.ALL)</span><br><span class="line">    <span class="comment">//åŠ å…¥ä¸»è¡¨tb_studentçš„å¤–é”®åˆ—</span></span><br><span class="line">    <span class="comment">//nameè¡¨ç¤ºåˆ—å</span></span><br><span class="line">    <span class="comment">//referencedColumnNameè¡¨ç¤ºå¯¹åº”å¤–è¡¨åˆ—å</span></span><br><span class="line">    <span class="comment">//uniqueè¡¨ç¤ºæ˜¯å¦å”¯ä¸€ï¼Œç”±äºä¸€å¯¹ä¸€å…³ç³»ä¸åŒ…å«é‡å¤å†…å®¹ï¼Œæ•…è®¾ç½®ä¸ºtrue</span></span><br><span class="line">    <span class="meta">@JoinColum</span>(name = <span class="string">"cardId"</span>, referencedColumnName = <span class="string">"cardId"</span>, unique = <span class="keyword">true</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Identify <span class="title">getIdentify</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> identify; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIdentify</span><span class="params">(Identify identify)</span> </span>&#123; <span class="keyword">this</span>.identify = identify; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æ­¤æ—¶æ•°æ®åº“ä¸­ï¼Œä¸»è¡¨ <code>tb_student</code> å°†æ·»åŠ  <code>cardId</code> åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ <code>tb_identify</code> çš„ <code>cardId</code> åˆ—<br> <img src="https://img.vim-cn.com/3a/f003b6d56b305f945f3cfe916c7a6d264902b4.png" alt="æ•°æ®åº“è¡¨å›¾"></p></li><li><p><strong>ä¸æ”¹å˜æ•°æ®åº“è¡¨</strong>ä½¿èº«ä»½è¯ç±»å­˜å‚¨å¯¹åº”å­¦ç”Ÿå¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_identify"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Identify</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String cardId;</span><br><span class="line">    <span class="keyword">private</span> TbStudentEntity student;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Identify</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCardId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> cardId; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCardId</span><span class="params">(String cardId)</span> </span>&#123; <span class="keyword">this</span>.cardId = cardId; &#125;</span><br><span class="line">    <span class="comment">//mappedByè¡¨ç¤ºè¯¥å±æ€§ä¸ºè¢«æ§å±æ€§ï¼Œå†…å®¹ç”±TbStudentEntityå¯¹è±¡çš„getIdentify()æ–¹æ³•æ§åˆ¶ï¼Œtb_identifyè¡¨å¹¶ä¸åŒ…å«æ­¤åˆ—</span></span><br><span class="line">    <span class="meta">@OneToOne</span>(mappedBy = <span class="string">"identify"</span>)</span><br><span class="line">    <span class="meta">@JoinColum</span>(name = <span class="string">"cardId"</span>, unique = <span class="keyword">true</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> TbStudentEntity <span class="title">getStudent</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> student; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudent</span><span class="params">(TbStudentEntity student)</span> </span>&#123; <span class="keyword">this</span>.student = student; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> Identify identify;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="comment">//cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ</span></span><br><span class="line">    <span class="meta">@OneToOne</span>(cascade = CascadeTtype.ALL)</span><br><span class="line">    <span class="comment">//åŠ å…¥ä¸»è¡¨tb_studentçš„å¤–é”®åˆ—</span></span><br><span class="line">    <span class="comment">//nameè¡¨ç¤ºåˆ—å</span></span><br><span class="line">    <span class="comment">//referencedColumnNameè¡¨ç¤ºå¯¹åº”å¤–è¡¨åˆ—å</span></span><br><span class="line">    <span class="comment">//uniqueè¡¨ç¤ºæ˜¯å¦å”¯ä¸€ï¼Œç”±äºä¸€å¯¹ä¸€å…³ç³»ä¸åŒ…å«é‡å¤å†…å®¹ï¼Œæ•…è®¾ç½®ä¸ºtrue</span></span><br><span class="line">    <span class="meta">@JoinColum</span>(name = <span class="string">"cardId"</span>, referencedColumnName = <span class="string">"cardId"</span>, unique = <span class="keyword">true</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Identify <span class="title">getIdentify</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> identify; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIdentify</span><span class="params">(Identify identify)</span> </span>&#123; <span class="keyword">this</span>.identify = identify; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æ­¤æ—¶æ•°æ®åº“ä¸­ï¼Œä¸»è¡¨ <code>tb_student</code> å°†æ·»åŠ  <code>cardId</code> åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ <code>tb_identify</code> çš„ <code>cardId</code> åˆ—<br> <img src="https://img.vim-cn.com/3a/f003b6d56b305f945f3cfe916c7a6d264902b4.png" alt="æ•°æ®åº“è¡¨å›¾"></p></li></ol><h3 id="OneToMany"><a href="#OneToMany" class="headerlink" title="@OneToMany"></a>@OneToMany</h3><p>OneToManyæ³¨è§£ç”¨äºè¡¨ç¤ºä¸€å¯¹å¤šå…³ç³»ï¼Œå¦‚æ•™å®¤è¡¨å¯¹å­¦ç”Ÿä¿¡æ¯è¡¨ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_classroom"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassRoom</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> roomId;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;Student&gt; students;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClassRoom</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRoomId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> roomId; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoomId</span><span class="params">(<span class="keyword">int</span> roomId)</span> </span>&#123; <span class="keyword">this</span>.roomId = roomId; &#125;</span><br><span class="line">    <span class="comment">//cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ</span></span><br><span class="line">    <span class="comment">//fetchè¡¨ç¤ºè¿›è¡Œå…³è”åŠ è½½çš„æ€åº¦</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºeagerã€lazyä¸¤ç§å–å€¼ï¼Œeagerå³ç§¯ææ€åº¦ç«‹å³è¿›è¡Œå…³è”åŠ è½½ï¼Œlazyå³æ‡’æ•£æ€åº¦ç”¨æ—¶è¿›è¡Œå…³è”åŠ è½½</span></span><br><span class="line">    <span class="comment">//æ­¤å¤„è¯»å–å­¦ç”Ÿé›†åˆéœ€å¤§é‡æŸ¥è¯¢æ•…é€‰æ‹©lazy</span></span><br><span class="line">    <span class="meta">@OneToMany</span>(cascade = CascadeTtype.ALL, fetch = FetchType.LAZY)</span><br><span class="line">    <span class="comment">//åŠ å…¥ä¸»è¡¨tb_studentçš„å¤–é”®åˆ—</span></span><br><span class="line">    <span class="comment">//nameè¡¨ç¤ºåˆ—å</span></span><br><span class="line">    <span class="comment">//referencedColumnNameè¡¨ç¤ºå¯¹åº”å¤–è¡¨åˆ—å</span></span><br><span class="line">    <span class="meta">@JoinColumn</span>(name = <span class="string">"crId"</span>, referencedColumnName = <span class="string">"roomId"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Student&gt; <span class="title">getStduents</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> students; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStduents</span><span class="params">(Set&lt;Student&gt; students)</span> </span>&#123; <span class="keyword">this</span>.students = students; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><pre><code>æ­¤æ—¶æ•°æ®åº“ä¸­ï¼Œä¸»è¡¨ `tb_student` å°†æ·»åŠ  `crId` åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ `tb_classroom` çš„ `roomId` åˆ—![æ•°æ®åº“è¡¨å›¾](https://img.vim-cn.com/e7/ac6932a41a10bc21e451063cb10db9fdefa210.png)</code></pre><h3 id="ManyToOne"><a href="#ManyToOne" class="headerlink" title="@ManyToOne"></a>@ManyToOne</h3><p>ManyToOneæ³¨è§£ç”¨äºè¡¨ç¤ºå¤šå¯¹ä¸€å…³ç³»ï¼Œå¦‚å­¦ç”Ÿä¿¡æ¯è¡¨å¯¹æ•™å®¤è¡¨ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_classroom"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassRoom</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> roomId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClassRoom</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRoomId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> roomId; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoomId</span><span class="params">(<span class="keyword">int</span> roomId)</span> </span>&#123; <span class="keyword">this</span>.roomId = roomId; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> ClassRoom room;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="comment">//cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ</span></span><br><span class="line">    <span class="comment">//fetchè¡¨ç¤ºè¿›è¡Œå…³è”åŠ è½½çš„æ€åº¦</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºeagerã€lazyä¸¤ç§å–å€¼ï¼Œeagerå³ç§¯ææ€åº¦ç«‹å³è¿›è¡Œå…³è”åŠ è½½ï¼Œlazyå³æ‡’æ•£æ€åº¦ç”¨æ—¶è¿›è¡Œå…³è”åŠ è½½</span></span><br><span class="line">    <span class="comment">//æ­¤å¤„è¯»å–æ•™å®¤å·æ— éœ€å¤§é‡æŸ¥è¯¢æ•…é€‰æ‹©eager</span></span><br><span class="line">    <span class="meta">@ManyToOne</span>(cascade = CascadeTtype.ALL, fetch = FetchType.EAGER)</span><br><span class="line">    <span class="comment">//åŠ å…¥ä¸»è¡¨tb_studentçš„å¤–é”®åˆ—</span></span><br><span class="line">    <span class="comment">//nameè¡¨ç¤ºåˆ—å</span></span><br><span class="line">    <span class="comment">//referencedColumnNameè¡¨ç¤ºå¯¹åº”å¤–è¡¨åˆ—å</span></span><br><span class="line">    <span class="meta">@JoinColumn</span>(name = <span class="string">"crId"</span>, referencedColumnName = <span class="string">"roomId"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ClassRoom <span class="title">getRoom</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.room; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoom</span><span class="params">(ClassRoom room)</span> </span>&#123; <span class="keyword">this</span>.room = room; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><pre><code>æ­¤æ—¶æ•°æ®åº“ä¸­ï¼Œä¸»è¡¨ `tb_student` å°†æ·»åŠ  `crId` åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ `tb_classroom` çš„ `roomId` åˆ—![æ•°æ®åº“è¡¨å›¾](https://img.vim-cn.com/e7/ac6932a41a10bc21e451063cb10db9fdefa210.png)</code></pre><h3 id="ManyToMany"><a href="#ManyToMany" class="headerlink" title="@ManyToMany"></a>@ManyToMany</h3><p>ManyToManyæ³¨è§£ç”¨äºè¡¨ç¤ºå¤šå¯¹å¤šå…³ç³»ï¼Œå¦‚å­¦ç”Ÿä¿¡æ¯è¡¨å¯¹æ•™å¸ˆè¡¨ï¼Œåˆ†ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><ol><li><p>é»˜è®¤åœ¨æ•°æ®åº“ä¸­æ·»åŠ å­¦ç”Ÿä¸ºä¸»çš„ä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨ä½¿å­¦ç”Ÿç±»å­˜å‚¨å¯¹åº”æ•™å¸ˆå¯¹è±¡é›†åˆï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_teacher"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> teacherId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Teacher</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getTeacherId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> teacherId; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTeacherId</span><span class="params">(String teacherId)</span> </span>&#123; <span class="keyword">this</span>.teacherId = teacherId; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;Teacher&gt; teachers;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="comment">//cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ</span></span><br><span class="line">    <span class="meta">@ManyToMany</span>(cascade = CascadeTtype.ALL)</span><br><span class="line">    <span class="comment">//åŠ å…¥çš„ä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨</span></span><br><span class="line">    <span class="comment">//nameè¡¨ç¤ºè¡¨å</span></span><br><span class="line">    <span class="comment">//joinColumnsè¡¨ç¤ºä¸»é”®å¯¹åº”å¤–è¡¨åˆ—é›†åˆ</span></span><br><span class="line">    <span class="comment">//inverseJoinColumnsè¡¨ç¤ºéä¸»é”®å¯¹åº”å¤–è¡¨åˆ—é›†åˆ</span></span><br><span class="line">    <span class="meta">@JoinTable</span>(</span><br><span class="line">        name = <span class="string">"students_teachers"</span>,</span><br><span class="line">        joinColumns = &#123;<span class="meta">@JoinColum</span>(name = <span class="string">"sid"</span>, referencedColumnName = <span class="string">"id"</span>)&#125;,</span><br><span class="line">        inverseJoinColumns = &#123;<span class="meta">@JoinColum</span>(name = <span class="string">"tid"</span>, referencedColumnName = <span class="string">"teacherId"</span>)&#125;,</span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Teacher&gt; <span class="title">getTeachers</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> teachers; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTeachers</span><span class="params">(Set&lt;Teacher&gt; teachers)</span> </span>&#123; <span class="keyword">this</span>.teachers = teachers; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æ­¤æ—¶æ•°æ®åº“ä¸­ï¼Œä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨ <code>students_teachers</code> å°†æ·»åŠ  <code>sid</code> åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ <code>tb_student</code> çš„ <code>id</code> åˆ—å’Œ <code>teacherId</code> åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ <code>tb_teacher</code> çš„ <code>teacherId</code> åˆ—<br> <img src="https://img.vim-cn.com/7a/2fdb2aea6e63ead5e731a23a153869f739810d.png" alt="æ•°æ®åº“è¡¨å›¾"></p></li><li><p><strong>ä¸æ·»åŠ æ•°æ®åº“æ•™å¸ˆä¸ºä¸»çš„ä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨</strong>ä½¿æ•™å¸ˆç±»å­˜å‚¨å¯¹åº”å­¦ç”Ÿå¯¹è±¡é›†åˆï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_teacher"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> teacherId;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;TbStudentEntity&gt; students;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Teacher</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getTeacherId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> teacherId; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTeacherId</span><span class="params">(String teacherId)</span> </span>&#123; <span class="keyword">this</span>.teacherId = teacherId; &#125;</span><br><span class="line">    <span class="comment">//mappedByè¡¨ç¤ºè¯¥å±æ€§ä¸ºè¢«æ§å±æ€§ï¼Œå†…å®¹ç”±TbStudentEntityå¯¹è±¡çš„getTeachers()æ–¹æ³•æ§åˆ¶ï¼Œå¹¶ä¸åˆ›å»ºä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨</span></span><br><span class="line">    <span class="meta">@ManyToMany</span>(mappedBy = <span class="string">"teachers"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;TbStudentEntity&gt; <span class="title">getStudents</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> students; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudents</span><span class="params">(Set&lt;TbStudentEntity&gt; students)</span> </span>&#123; <span class="keyword">this</span>.students = students; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;Teacher&gt; teachers;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="comment">//cascadeè¡¨ç¤ºè¿›è¡Œå…³è”æ“ä½œçš„æ—¶æœº</span></span><br><span class="line">    <span class="comment">//åˆ†ä¸ºnoneã€save-updateã€deleteã€allå››ç§å–å€¼ï¼Œnoneä¸ºé»˜è®¤å€¼ï¼Œå³ä¸è¿›è¡Œå…³è”æ“ä½œï¼Œsave-updateå³save/updateæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œdeleteå³deleteæ—¶è¿›è¡Œå…³è”æ“ä½œï¼Œallå³save/update/deleteæ—¶è¿›è¡Œå…³è”æ“ä½œ</span></span><br><span class="line">    <span class="meta">@ManyToMany</span>(cascade = CascadeTtype.ALL)</span><br><span class="line">    <span class="comment">//åŠ å…¥çš„ä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨</span></span><br><span class="line">    <span class="comment">//nameè¡¨ç¤ºè¡¨å</span></span><br><span class="line">    <span class="comment">//joinColumnsè¡¨ç¤ºä¸»é”®å¯¹åº”å¤–è¡¨åˆ—é›†åˆ</span></span><br><span class="line">    <span class="comment">//inverseJoinColumnsè¡¨ç¤ºéä¸»é”®å¯¹åº”å¤–è¡¨åˆ—é›†åˆ</span></span><br><span class="line">    <span class="meta">@JoinTable</span>(</span><br><span class="line">        name = <span class="string">"students_teachers"</span>,</span><br><span class="line">        joinColumns = &#123;<span class="meta">@JoinColum</span>(name = <span class="string">"sid"</span>, referencedColumnName = <span class="string">"id"</span>)&#125;,</span><br><span class="line">        inverseJoinColumns = &#123;<span class="meta">@JoinColum</span>(name = <span class="string">"tid"</span>, referencedColumnName = <span class="string">"teacherId"</span>)&#125;,</span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Teacher&gt; <span class="title">getTeachers</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> teachers; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTeachers</span><span class="params">(Set&lt;Teacher&gt; teachers)</span> </span>&#123; <span class="keyword">this</span>.teachers = teachers; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æ­¤æ—¶æ•°æ®åº“ä¸­ï¼Œä¸­é—´ï¼ˆå…³ç³»ï¼‰è¡¨ <code>students_teachers</code> å°†æ·»åŠ  <code>sid</code> åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ <code>tb_student</code> çš„ <code>id</code> åˆ—å’Œ <code>teacherId</code> åˆ—ä½œä¸ºå¤–é”®å…³è”äºè¡¨ <code>tb_teacher</code> çš„ <code>teacherId</code> åˆ—<br> <img src="https://img.vim-cn.com/7a/2fdb2aea6e63ead5e731a23a153869f739810d.png" alt="æ•°æ®åº“è¡¨å›¾"></p></li></ol><h2 id="åˆ›å»ºæ¨¡å‹"><a href="#åˆ›å»ºæ¨¡å‹" class="headerlink" title="åˆ›å»ºæ¨¡å‹"></a>åˆ›å»ºæ¨¡å‹</h2><p>æœ¬æ–‡å°†åˆ›å»º <code>TbStudentEntity</code> ç±»ä½œä¸ºJavaBrean</p><h3 id="ä½¿ç”¨æ˜ å°„æ•°æ®è¡¨"><a href="#ä½¿ç”¨æ˜ å°„æ•°æ®è¡¨" class="headerlink" title="ä½¿ç”¨æ˜ å°„æ•°æ®è¡¨"></a>ä½¿ç”¨æ˜ å°„æ•°æ®è¡¨</h3><ol><li><p>åˆ›å»º <code>TbStudentEntity</code> ç±»ï¼Œå®ç°é»˜è®¤æ„é€ å‡½æ•°ï¼Œä»¥åŠgetã€setæ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> LocalDate birthday;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123; <span class="keyword">this</span>.name = name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> sex; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123; <span class="keyword">this</span>.sex = sex; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocalDate <span class="title">getBirthday</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> birthday; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(LocalDate birthday)</span> </span>&#123; <span class="keyword">this</span>.birthday = birthday; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> address; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123; <span class="keyword">this</span>.address = address; &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        TbStudentEntity that = (TbStudentEntity) o;</span><br><span class="line">        <span class="keyword">return</span> id == that.id &amp;&amp;</span><br><span class="line">                Objects.equals(name, that.name) &amp;&amp;</span><br><span class="line">                Objects.equals(sex, that.sex) &amp;&amp;</span><br><span class="line">                Objects.equals(birthday, that.birthday) &amp;&amp;</span><br><span class="line">                Objects.equals(address, that.address);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(id, name, sex, birthday, address);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åŒæ—¶ï¼Œåœ¨ <code>hibernate.cfg.xml</code> æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Hibernate/Hibernate Configuration DTD//EN"</span></span><br><span class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         <span class="comment">&lt;!--è½½å…¥æ˜ å°„æ•°æ®è¡¨ï¼Œè®¾ç½®resourceå±æ€§å€¼ä¸ºæ˜ å°„æ•°æ®è¡¨æ–‡ä»¶è·¯å¾„--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"package/TbStudentEntity.hbm.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>éšååœ¨ <code>TbStudentEntity</code> ç±»åŒçº§æ–‡ä»¶å¤¹å†…åˆ›å»º <code>TbStudentEntity.hbm.xml</code> æ˜ å°„æ•°æ®è¡¨æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding='UTF-8'?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Hibernate/Hibernate Mapping DTD//EN"</span></span><br><span class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"pacakge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"TbStudentEntity"</span> <span class="attr">table</span>=<span class="string">"tb_student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"sid"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"sname"</span>  <span class="attr">type</span>=<span class="string">"java.lang.String"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">column</span>=<span class="string">"ssex"</span>  <span class="attr">type</span>=<span class="string">"java.lang.String"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">column</span>=<span class="string">"sage"</span>  <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">column</span>=<span class="string">"sbirthday"</span>  <span class="attr">type</span>=<span class="string">"java.lang.LocalDate"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">column</span>=<span class="string">"saddress"</span>  <span class="attr">type</span>=<span class="string">"java.lang.String"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="ä½¿ç”¨æ³¨è§£"><a href="#ä½¿ç”¨æ³¨è§£" class="headerlink" title="ä½¿ç”¨æ³¨è§£"></a>ä½¿ç”¨æ³¨è§£</h3><p>XMLæ–‡ä»¶æ‰‹åŠ¨ç¼–å†™å¹¶ä¸æ–¹ä¾¿ï¼Œéœ€ç”¨å·¥å…·ç”Ÿæˆã€‚æ‰€ä»¥<strong>Hibernateæä¾›æ³¨è§£æ–¹å¼ï¼ˆæ³¨è§£å±äºJPAæ ‡å‡†ï¼‰ï¼Œæ— éœ€ç¼–å†™HBMã€‚æœ¬æ–‡å»ºè®®ä½¿ç”¨æ³¨è§£</strong>ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>åˆ›å»º <code>TbStudentEntity</code> ç±»ï¼Œå®ç°é»˜è®¤æ„é€ å‡½æ•°ï¼Œä»¥åŠgetã€setæ–¹æ³•ï¼Œå¹¶åŠ ä¸Šæ³¨è§£ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_student"</span>, schema = <span class="string">"hibernate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TbStudentEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> LocalDate birthday;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TbStudentEntity</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(generator = <span class="string">"AutoInc"</span>)</span><br><span class="line">    <span class="meta">@GenericGenerator</span>(name = <span class="string">"AutoInc"</span>, strategy = <span class="string">"native"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123; <span class="keyword">this</span>.id = id; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123; <span class="keyword">this</span>.name = name; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> sex; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123; <span class="keyword">this</span>.sex = sex; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocalDate <span class="title">getBirthday</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> birthday; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(LocalDate birthday)</span> </span>&#123; <span class="keyword">this</span>.birthday = birthday; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> address; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123; <span class="keyword">this</span>.address = address; &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        TbStudentEntity that = (TbStudentEntity) o;</span><br><span class="line">        <span class="keyword">return</span> id == that.id &amp;&amp;</span><br><span class="line">                Objects.equals(name, that.name) &amp;&amp;</span><br><span class="line">                Objects.equals(sex, that.sex) &amp;&amp;</span><br><span class="line">                Objects.equals(birthday, that.birthday) &amp;&amp;</span><br><span class="line">                Objects.equals(address, that.address);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(id, name, sex, birthday, address);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åŒæ—¶ï¼Œåœ¨ <code>hibernate.cfg.xml</code> æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Hibernate/Hibernate Configuration DTD//EN"</span></span><br><span class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         <span class="comment">&lt;!--è½½å…¥æ˜ å°„æ•°æ®è¡¨ï¼Œè®¾ç½®classå±æ€§å€¼ä¸ºæ˜ å°„æ•°æ®è¡¨ç±»è·¯å¾„--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"package.TbStudentEntity"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="æ“ä½œæ–¹æ³•"><a href="#æ“ä½œæ–¹æ³•" class="headerlink" title="æ“ä½œæ–¹æ³•"></a>æ“ä½œæ–¹æ³•</h2><h3 id="session-createQuery"><a href="#session-createQuery" class="headerlink" title="session.createQuery()"></a>session.createQuery()</h3><p>è¯¥æ–¹æ³•ä¼ å…¥HQLè¯­å¥ï¼Œè¿”å› <code>Query</code> å¯¹è±¡ï¼ŒHQLå…·ä½“è¯­æ³•æ­¤å¤„ä¸å†ç´¯èµ˜<br>è°ƒç”¨ <code>Query</code> å¯¹è±¡çš„ <code>list()</code> æ–¹æ³•è¿”å›å¯¹åº”æ¨¡å‹ç±»å¯¹è±¡é“¾è¡¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Query query = session.createQuery(<span class="string">"from TbStudentEntity where id = ?"</span>);</span><br><span class="line">query.setParameter(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">List&lt;TbStudentEntity&gt; students = query.list();</span><br></pre></td></tr></table></figure></p><h3 id="session-get"><a href="#session-get" class="headerlink" title="session.get()"></a>session.get()</h3><p>è¯¥æ–¹æ³•ä¼ å…¥æ¨¡å‹ç±»ä¸ä¸»é”®ï¼Œè¿”å›å¯¹åº”æ¨¡å‹ç±»å¯¹è±¡<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TbStudentEntity tbStudentEntity = session.get(tbStudentEntity.class, <span class="number">1</span>);</span><br><span class="line">System.out.println(tbStudentEntity.getClass());</span><br></pre></td></tr></table></figure></p><h3 id="session-load"><a href="#session-load" class="headerlink" title="session.load()"></a>session.load()</h3><p>è¯¥æ–¹æ³•ä¼ å…¥æ¨¡å‹ç±»ä¸ä¸»é”®ï¼Œè¿”å›å¯¹åº”æ¨¡å‹ä»£ç†ç±»çš„å¯¹è±¡ï¼Œå–å€¼æ—¶æ‰å¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TbStudentEntity tbStudentEntity = session.load(tbStudentEntity.class, <span class="number">1</span>);</span><br><span class="line"><span class="comment">//å–å€¼ä¹‹å‰å¯¹è±¡ç±»ä¸ºTbStudentEntity_$$_Javassist_0ä»£ç†ç±»</span></span><br><span class="line">System.out.println(tbStudentEntity.getClass().getName());</span><br><span class="line">System.out.println(tbStudentEntity.name);</span><br><span class="line"><span class="comment">//å–å€¼ä¹‹åå¯¹è±¡ç±»ä¸ºTbStudentEntityæ¨¡å‹ç±»</span></span><br><span class="line">System.out.println(tbStudentEntity.getClass().getName());</span><br></pre></td></tr></table></figure></p><h3 id="session-save"><a href="#session-save" class="headerlink" title="session.save()"></a>session.save()</h3><p>è¯¥æ–¹æ³•ä¼ å…¥æ¨¡å‹å¯¹è±¡ï¼Œå¹¶è‡ªåŠ¨ä¿å­˜å…³è”å¯¹è±¡æ•°æ®<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TbStudentEntity tbStudentEntity = <span class="keyword">new</span> TbStudentEntity(<span class="string">"å°æ˜"</span>, <span class="string">"ç”·"</span>, LocalDate.of(<span class="number">2018</span>, <span class="number">4</span>, <span class="number">8</span>), <span class="string">"å…‰æ˜å°åŒº"</span>);</span><br><span class="line">session.save(tbStudentEntity);</span><br></pre></td></tr></table></figure></p><h3 id="session-delete"><a href="#session-delete" class="headerlink" title="session.delete()"></a>session.delete()</h3><p>è¯¥æ–¹æ³•ä¼ å…¥æ¨¡å‹å¯¹è±¡ï¼Œåˆ é™¤æ•°æ®åº“ä¸­å¯¹åº”æ•°æ®<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TbStudentEntity tbStudentEntity = <span class="keyword">new</span> TbStudentEntity(<span class="string">"å°æ˜"</span>, <span class="string">"ç”·"</span>, LocalDate.of(<span class="number">2018</span>, <span class="number">4</span>, <span class="number">8</span>), <span class="string">"å…‰æ˜å°åŒº"</span>);</span><br><span class="line">session.delete(tbStudentEntity);</span><br></pre></td></tr></table></figure></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è‡³æ­¤ï¼ŒHibernateæ¡†æ¶åŸºæœ¬ä½¿ç”¨æ–¹æ³•æŒæ¡ã€‚</p>]]></content>
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSH </tag>
            
            <tag> æ¡†æ¶ </tag>
            
            <tag> Hibernate </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¼€æºåè®®æ€»ç»“</title>
      <link href="/2018/04/06/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/"/>
      <url>/2018/04/06/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p><img src="https://img.vim-cn.com/c5/07eabfceb868787fd5734274dcd2471f98c08c.png" alt="ä¸€å›¾è¯»æ‡‚å„ç§å¼€æºåè®®"><br>åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­åˆ›å»ºç›¸åº”LICENSEæ–‡ä»¶ï¼Œå¹¶æ‹·è´åè®®å†…å®¹å³å¯ã€‚</p>]]></content>
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼€æº </tag>
            
            <tag> åè®® </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SSHæ¡†æ¶-åˆè¯†Struts2</title>
      <link href="/2018/04/05/SSH%E6%A1%86%E6%9E%B6-%E5%88%9D%E8%AF%86Struts2/"/>
      <url>/2018/04/05/SSH%E6%A1%86%E6%9E%B6-%E5%88%9D%E8%AF%86Struts2/</url>
      <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æœ€åˆçš„Java Webå¼€å‘ç”± <code>JavaBean + JSP</code> æ¨¡å¼å®ç°ï¼Œå¤§é‡é€»è¾‘è§†å›¾ä»£ç æ··æ‚äºJSPä¸­ï¼Œé€ æˆä»£ç å¯ç»´æŠ¤æ€§æå·®ã€‚<br>è€ŒåSunå…¬å¸æ¨å‡ºå…¸å‹MVCæ¨¡å¼ï¼Œå°†é€»è¾‘ä¸è§†å›¾ä»£ç åˆ†ç¦»å‡ºæ¥ã€‚</p><h1 id="MVCæ¨¡å¼"><a href="#MVCæ¨¡å¼" class="headerlink" title="MVCæ¨¡å¼"></a>MVCæ¨¡å¼</h1><p>MVCæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡å…¸èŒƒï¼Œå°†è½¯ä»¶è®¾è®¡åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼š(Model)æ¨¡å‹ + (View)è§†å›¾ + (Controller)æ§åˆ¶å™¨ã€‚ä»¥æ­¤ç»„ç»‡ä»£ç ï¼Œæ–¹ä¾¿ç»´æŠ¤å’Œä¿®æ”¹ã€‚<br>Sunå…¬å¸æ¨å‡ºçš„MVCå®ç°æ–¹å¼ä¸º <code>JavaBean + JSP + Servlet</code>ï¼Œè¿…é€Ÿæ¨è¿›Java Webå¼€å‘å˜é©ã€‚è€Œåå„å¤§MVCæ¨¡å¼å®ç°æ–¹å¼å±‚å‡ºä¸ç©·ï¼Œä¸ºè¾¾æˆç»Ÿä¸€ï¼ŒMVCæ¡†æ¶ç”±æ­¤è€Œç”Ÿã€‚Strutsä¾¿æ˜¯å…¶ä¸­æµè¡Œçš„ä¸€ç§ã€‚</p><h1 id="Strutsç®€å²"><a href="#Strutsç®€å²" class="headerlink" title="Strutsç®€å²"></a>Strutsç®€å²</h1><p>Strutsé¡¹ç›®éš¶å±ApacheåŸºé‡‘ä¼šï¼Œå‡ºèº«åé—¨ã€‚Strutså‰èº«ä¸ºStruts1ï¼Œäº2001å¹´æ¨å‡ºï¼Œéšå³é£é¡å…¨çƒã€‚Struts1è¿è¡Œæµç¨‹å›¾ï¼š<br><img src="https://img.vim-cn.com/f2/2da693e2d7e66ad49525dd3ec6a978516f0d4d.png" alt="Struts1è¿è¡Œæµç¨‹"></p><p>WebWorkä¹Ÿæ˜¯åŒæ—¶ä»£äº§ç‰©ï¼Œç”±äºæŠ€æœ¯å‘å±•é£å¿«ï¼ŒStrutsé¡¹ç›®å¼€å‘ç»„ç»‡èˆå¼ƒé™ˆæ—§çš„Struts1æ¨¡å¼è½¬è€Œäº2007å¹´è®¾è®¡å‡ºåŸºäºWebWorkçš„å…¨æ–°Struts2æ¡†æ¶ã€‚Struts1åŸºäºServlet APIçš„æ§åˆ¶å™¨è®¾è®¡å¯¼è‡´ä¸JSP/Servletè€¦åˆéå¸¸ç´§å¯†ï¼Œé€ æˆå¾ˆå¤šç¼ºé™·ï¼Œè€ŒWebWorké‡‡ç”¨è¿‡æ»¤å™¨(filter)å®ç°ï¼Œå–æ¶ˆå¯¹Servlet APIçš„ä¾èµ–ä½¿æµ‹è¯•æ›´åŠ æ–¹ä¾¿ã€‚Struts2ä¾¿æ˜¯WebWorkçš„å‡çº§ç‰ˆã€‚åœ¨äº†è§£Struts2ä¹‹å‰æœ¬æ–‡å°†å…ˆé˜è¿°è¿‡æ»¤å™¨(filter)ã€‚</p><h1 id="è¿‡æ»¤å™¨-filter"><a href="#è¿‡æ»¤å™¨-filter" class="headerlink" title="è¿‡æ»¤å™¨(filter)"></a>è¿‡æ»¤å™¨(filter)</h1><p>FilteræŠ€æœ¯æ˜¯ServletæŠ€æœ¯ä¸­æœ€æ¿€åŠ¨äººå¿ƒçš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå¼€å‘äººå‘˜é€šè¿‡FilteræŠ€æœ¯ï¼Œå¯¹webæœåŠ¡å™¨çš„webèµ„æºè¿›è¡Œæ‹¦æˆªï¼Œä»è€Œå®ç°ä¸€äº›å¦‚æƒé™æ§åˆ¶ã€è¿‡æ»¤è¯æ±‡ã€å‹ç¼©ä¿¡æ¯ç­‰ç‰¹æ®ŠåŠŸèƒ½ã€‚åœ¨ä¸€ä¸ªwebåº”ç”¨ä¸­ï¼Œå¯ç¼–å†™å¤šä¸ªFilterï¼Œè¿™äº›Filterç»„åˆèµ·æ¥ç§°ä¹‹ä¸ºä¸€ä¸ªFilteré“¾ã€‚å½“è°ƒç”¨FilterChainå¯¹è±¡çš„doFilteræ–¹æ³•æ—¶ï¼ŒwebæœåŠ¡å™¨ä¼šæ£€æŸ¥FilterChainå¯¹è±¡ä¸­æ˜¯å¦è¿˜æœ‰filterï¼Œè‹¥æœ‰åˆ™è°ƒç”¨ç¬¬ä¸‹ä¸ªfilterï¼Œå¦åˆ™è°ƒç”¨å®ç°servletæ¥å£å¯¹è±¡çš„serviceæ–¹æ³•ã€‚Filterå·¥ä½œåŸç†å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://img.vim-cn.com/f5/075c2251151bcf39f5458e05903a0580737b58.png" alt="Filterå·¥ä½œåŸç†"></p><h1 id="Struts2åŸç†"><a href="#Struts2åŸç†" class="headerlink" title="Struts2åŸç†"></a>Struts2åŸç†</h1><p><strong>Struts2åŸºäºè¿‡æ»¤å™¨(filter)å®ç°</strong>ï¼Œå…¶å·¥ä½œåŸç†å¦‚ä¸‹ï¼š<br><img src="https://img.vim-cn.com/b1/d3fd5f785317235e1e1adc389b82e246c9244b.png" alt="Struts2æ¡†æ¶åŸç†"><br>å›¾ä¸­åè¯è§£é‡Šï¼š</p><ul><li><strong>ActionContextCleanUp</strong>ï¼šActionå±æ€§æ¸…é™¤è¿‡æ»¤å™¨ï¼Œç”¨äºæ¸…é™¤Actionå±æ€§ï¼Œè€Œä¸ç”¨Actionè‡ªè¡Œæ¸…é™¤ï¼Œä»¥æ­¤å»¶é•¿Actionå±æ€§ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰å±æ€§ï¼‰ç”Ÿå‘½å‘¨æœŸï¼Œä»¥ä¾¿åœ¨JSPé¡µé¢ä¸­è¿›è¡Œè®¿é—®</li><li><strong>Other Filters(SiteMesh, etc)</strong>ï¼šå…¶ä»–å¯é™„åŠ çš„è¿‡æ»¤å™¨ï¼Œè¯¸å¦‚ç”¨äºå“åº”é¡µé¢ä¿®é¥°çš„SiteMeshè¿‡æ»¤å™¨ç­‰</li><li><strong>StrutsPrepareAndExecuteFilter</strong>ï¼šæ­¤è¿‡æ»¤å™¨ä¸ºStruts2æ ¸å¿ƒï¼Œç”¨äºè°ƒç”¨Actionæ˜ å°„(ActionMapper)ç±»ã€è®¾ç½®ç¼–ç æ ¼å¼ã€è°ƒç”¨Actionä»£ç†(ActionProxy)ç±»åŠ è½½é…ç½®ä¿¡æ¯ï¼›<strong>åŒæ—¶å¯æ‹†åˆ†ä¸ºStrutsPrepareFilterå’ŒStrutsExecuteFilteræ‰§è¡ŒActionå‰ï¼ˆä½ç½®â‘ ï¼‰æˆ–åï¼ˆä½ç½®â‘¡ï¼‰çš„ç”¨æˆ·è‡ªå®šä¹‰è¿‡æ»¤å™¨</strong></li><li><strong>ActionMapper</strong>ï¼šActionæ˜ å°„ç±»ï¼Œç”¨äºåŒ¹é…URLå¯¹åº”çš„Actionæˆ–HTMLæˆ–JSP</li><li><strong>ActionProxy</strong>ï¼šActionä»£ç†ç±»ï¼Œç”¨äºè°ƒç”¨ConfigurationManagerè¯»å–strutsé…ç½®æ–‡ä»¶</li><li><strong>ConfigurationManager</strong>ï¼šé…ç½®ç®¡ç†ç±»ï¼Œç”¨äºè¯»å–strutsç›¸å…³é…ç½®æ–‡ä»¶(struts.xmlã€struts.properties)</li><li><strong>ActionInvocation</strong>ï¼šActionè°ƒç”¨ç±»ï¼Œç”¨äºè§£æOGNLè¡¨è¾¾å¼å’Œä¾ç…§strutsé…ç½®(struts.xml)é¡ºåºè°ƒç”¨æ‹¦æˆªå™¨(Interceptor)å’ŒActionå®ä¾‹ï¼ˆStruts2ä½¿ç”¨ç±»ä¼¼Filteré“¾çš„æ‹¦æˆªå™¨æ ˆ(Interceptor Stack)é¡ºåºè°ƒç”¨æ‹¦æˆªå™¨ï¼‰</li><li><strong>Interceptor (1)(2)(3)</strong>ï¼šæ‹¦æˆªå™¨æ¥å£ï¼Œç”¨äºå¯¹Actionè¿›è¡Œè¿‡æ»¤è¯·æ±‚ï¼ŒåŠŸèƒ½ç±»ä¼¼Filterã€‚ä¸åŒäºå›è°ƒå‡½æ•°å®ç°çš„Filterï¼Œæ‹¦æˆªå™¨åŸºäºJavaåå°„æœºåˆ¶å®ç°ã€‚<strong>æ‹¦æˆªå™¨ä½¿ç”¨æ ˆç»“æ„å­˜å‚¨ï¼Œæ³¨æ„å›¾ä¸­è°ƒç”¨é¡ºåº</strong></li><li><strong>Action</strong>ï¼šActionå®ä¾‹ï¼Œç”¨äºè¿›è¡Œæ¨¡å‹(Model)ä¸é¡µé¢(View)é“¾æ¥çš„é€»è¾‘æ“ä½œï¼Œä¹Ÿå¯åŒ…å«æ¨¡å‹å¯¹è±¡ï¼Œæ•…ä¸èƒ½ç®€å•è§†å…¶ä¸ºæ§åˆ¶å™¨(Controller)</li><li><strong>Result</strong>ï¼šActionæ‰§è¡Œæ–¹æ³•çš„è¿”å›ç»“æœï¼Œå®é™…ä¸ºå­—ç¬¦ä¸²ï¼Œå¦‚ï¼šsuccessã€inputã€errorç­‰</li><li><strong>Template</strong>ï¼šæ˜¾ç¤ºæ¨¡æ¿ï¼Œç”¨äºå“åº”é¡µé¢æ˜¾ç¤ºï¼Œå¦‚JSPã€FreeMarkerã€HTMLç­‰</li></ul><h1 id="Struts2ä½¿ç”¨"><a href="#Struts2ä½¿ç”¨" class="headerlink" title="Struts2ä½¿ç”¨"></a>Struts2ä½¿ç”¨</h1><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><ol><li>åˆ›å»ºJava Webé¡¹ç›®å¹¶å¯¼å…¥ä¸Struts2ç›¸å…³çš„Jarå¼€å‘åŒ…ã€‚<a href="https://struts.apache.org/download.cgi" target="_blank" rel="noopener">å¼€å‘åŒ…ä¸‹è½½åœ°å€</a></li><li><p>é…ç½®web.xmlï¼ŒåŠ å…¥Struts2æ ¸å¿ƒè¿‡æ»¤å™¨(filter)ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨srcæ–‡ä»¶å¤¹å†…åˆ›å»ºstruts.xmlæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºé…ç½®å…¨å±€å±æ€§ã€Interceptorä»¥åŠaction</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span><br><span class="line"><span class="meta">        "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="struts-xml"><a href="#struts-xml" class="headerlink" title="struts.xml"></a>struts.xml</h2><h3 id="constant"><a href="#constant" class="headerlink" title="constant"></a>constant</h3><p>constantæ ‡ç­¾ç”¨äºé…ç½®å…¨å±€å±æ€§ï¼Œå¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--è¯¥å±æ€§æŒ‡å®šéœ€è¦Struts2å¤„ç†çš„è¯·æ±‚åç¼€ï¼Œè¯¥å±æ€§çš„é»˜è®¤å€¼æ˜¯action,å³æ‰€æœ‰åŒ¹é…*.actionæˆ–æ— åç¼€çš„è¯·æ±‚éƒ½ç”±Struts2å¤„ç†ã€‚å¤šä¸ªè¯·æ±‚åç¼€ä¹‹é—´ä»¥è‹±æ–‡é€—å·(,)éš”å¼€--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.action.extension"</span> <span class="attr">value</span>=<span class="string">"action,"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p><p>å¯ä¹Ÿç½®äºstruts.propertiesæ–‡ä»¶ä¸­ï¼Œä»¥é”®å€¼å¯¹å½¢å¼ä¿å­˜<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">struts.action.extension=action,</span><br></pre></td></tr></table></figure></p><p>æ›´å¤šå±æ€§è¯·æŸ¥é˜…Struts2å®˜ç½‘</p><h3 id="package"><a href="#package" class="headerlink" title="package"></a>package</h3><p>packageæ ‡ç­¾è¡¨ç¤ºç‹¬ç«‹æ¨¡å—ï¼Œæ¯ä¸ªpackageéƒ½æœ‰ç‹¬ç«‹çš„interceptorã€actionå®šä¹‰<br>å…¶å±æ€§abstractç”¨äºåˆ›å»ºæŠ½è±¡packageï¼Œnamespaceç”¨äºè·¯å¾„åŒ¹é…ï¼ˆç›¸å½“äºæ–‡ä»¶å¤¹è·¯å¾„ï¼‰ï¼Œextendsç”¨äºç»§æ‰¿é…ç½®ï¼Œä¾‹å¦‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--namespaceå¯¹åº”http://host:port/project/path1/*.actionä¸­çš„path1ï¼Œé»˜è®¤ä¸º"/"--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--exendsè¡¨ç¤ºè¯¥åŒ…ç»§æ‰¿äºæ¡†æ¶æä¾›çš„åä¸ºstruts-defaulté»˜è®¤é…ç½®åŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"example-package"</span> <span class="attr">namespace</span>=<span class="string">"/path1"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--actions...--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>å…³äºURLä¸­ <code>namespace</code> è·¯å¾„çš„è®¿é—®å¹¶éä¸¥æ ¼åŒ¹é…ï¼Œè€Œæ˜¯å±‚çº§å‘ä¸ŠæŸ¥æ‰¾ã€‚</strong>ä¾‹å¦‚ï¼š<br>å½“ä»…æœ‰å•ä¸ªpackageä¸”å…¶ <code>namespace=path1</code> æ—¶ï¼Œå¯¹äºè·¯å¾„ï¼š</p><ul><li><a href="http://host:port/project/path1/example.action" target="_blank" rel="noopener">http://host:port/project/path1/example.action</a></li><li><a href="http://host:port/project/path1/path2/example.action" target="_blank" rel="noopener">http://host:port/project/path1/path2/example.action</a></li><li><a href="http://host:port/project/path1/path2/path3/example.action" target="_blank" rel="noopener">http://host:port/project/path1/path2/path3/example.action</a></li></ul><p>å‡å¯è®¿é—®åˆ°example.actionå¯¹åº”é¡µé¢ã€‚</p><h3 id="action"><a href="#action" class="headerlink" title="action"></a>action</h3><p>actionæ ‡ç­¾ç”¨äºå®šä¹‰URLåå­—å¯¹åº”çš„actionç±»ï¼Œä¾‹å¦‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ­¤æ ‡ç­¾è¡¨ç¤ºhttp://host:port/project/index.actionç½‘å€å¯¹åº”HelloWorldActionç±»--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>nameå±æ€§æ”¯æŒæ­£åˆ™åŒ¹é…ï¼Œå› æ­¤å¯å¯¹å…¶ä½œäº›æ–‡ç« ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ­¤è®¾ç½®è¡¨ç¤ºå½¢å¦‚http://host:port/project/Example.actionç½‘å€å¯¹åº”ExampleActionç±»--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">class</span>=<span class="string">"com.example.project.&#123;1&#125;Action"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å­æ ‡ç­¾ä¹Ÿæ”¯æŒè¯»å–&#123;1&#125;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>è®¾å®šmethodå±æ€§å€¼ï¼Œå¯æŒ‡å®šè°ƒç”¨å¯¹åº”åç§°çš„æ–¹æ³•ï¼Œå¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å°†è°ƒç”¨HelloWorldActionç±»ä¸­è‡ªå®šä¹‰çš„hello()æ–¹æ³•--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">method</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="result"><a href="#result" class="headerlink" title="result"></a>result</h3><p>resultæ ‡ç­¾ç”¨äºæŒ‡å®šactionæ–¹æ³•è¿”å›å€¼å¯¹åº”è·³è½¬é¡µé¢ï¼ˆè·³è½¬é»˜è®¤é‡‡ç”¨forwardæ–¹å¼ï¼Œå³type=â€dispatcherâ€ï¼‰ï¼Œä¾‹å¦‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å½“HelloWorldActionç±»æŸæ–¹æ³•è¿”å›successåˆ™å“åº”hello.jspé¡µé¢--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å±æ€§nameé»˜è®¤å€¼ä¸ºsuccess--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/hello.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å› ä¸ºstruts.xmlæ”¯æŒOGNLè¡¨è¾¾å¼ï¼Œæ•…å¯å–requestã€sessionã€applicationç­‰å±æ€§å€¼ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è¯»å–requestèŒƒå›´ä¸­åä¸ºattrExampleçš„å±æ€§å€¼ä½œä¸ºJSPæ–‡ä»¶å--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/&#123;#request.attrExample&#125;.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸‹ä¸ºStruts2å·²é»˜è®¤åŒ…å«çš„nameå±æ€§å€¼ï¼š</p><ul><li>SUCCESSï¼šActionæ­£ç¡®çš„æ‰§è¡Œå®Œæˆï¼Œè¿”å›ç›¸åº”çš„è§†å›¾ï¼Œsuccessæ˜¯nameå±æ€§çš„é»˜è®¤å€¼ã€‚</li><li>NONEï¼šè¡¨ç¤ºActionæ­£ç¡®çš„æ‰§è¡Œå®Œæˆï¼Œä½†å¹¶ä¸è¿”å›ä»»ä½•è§†å›¾ã€‚</li><li>ERRORï¼šè¡¨ç¤ºActionæ‰§è¡Œå¤±è´¥ï¼Œè¿”å›åˆ°é”™è¯¯å¤„ç†è§†å›¾ã€‚</li><li>INPUTï¼šActionçš„æ‰§è¡Œï¼Œéœ€è¦ä»å‰ç«¯ç•Œé¢è·å–å‚æ•°ï¼ŒINPUTå°±æ˜¯ä»£è¡¨è¿™ä¸ªå‚æ•°è¾“å…¥çš„ç•Œé¢ï¼Œä¸€èˆ¬åœ¨åº”ç”¨ä¸­ï¼Œä¼šå¯¹è¿™äº›å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœéªŒè¯æ²¡æœ‰é€šè¿‡ï¼Œå°†è‡ªåŠ¨è¿”å›åˆ°è¯¥è§†å›¾ã€‚</li><li>LOGINï¼šActionå› ä¸ºç”¨æˆ·æ²¡æœ‰ç™»é™†çš„åŸå› æ²¡æœ‰æ­£ç¡®æ‰§è¡Œï¼Œå°†è¿”å›è¯¥ç™»é™†è§†å›¾ï¼Œè¦æ±‚ç”¨æˆ·è¿›è¡Œç™»é™†éªŒè¯ã€‚</li></ul><p>ä»¥ä¸‹ä¸ºtypeå±æ€§å€¼å¯é€‰å†…å®¹ï¼š</p><ul><li>dispatcherï¼šé»˜è®¤ç»“æœç±»å‹ï¼Œç”¨æ¥å‘ˆç°JSPé¡µé¢</li><li>chainï¼šå°†actionå’Œå¦å¤–ä¸€ä¸ªactioné“¾æ¥èµ·æ¥</li><li>freemarkerï¼šå‘ˆç°Freemarkeræ¨¡æ¿</li><li>httpheaderï¼šè¿”å›ä¸€ä¸ªå·²é…ç½®å¥½çš„HTTPå¤´ä¿¡æ¯å“åº”</li><li>redirectï¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°ä¸€ä¸ªå·²é…ç½®å¥½çš„URL</li><li>redirectActionï¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°ä¸€ä¸ªå·²å®šä¹‰å¥½çš„action</li><li>streamï¼šå°†åŸå§‹æ•°æ®ä½œä¸ºæµä¼ é€’å›æµè§ˆå™¨ç«¯ï¼Œè¯¥ç»“æœç±»å‹å¯¹ä¸‹è½½çš„å†…å®¹å’Œå›¾ç‰‡éå¸¸æœ‰ç”¨</li><li>velocityï¼šå‘ˆç°Velocityæ¨¡æ¿</li><li>xsltï¼šå‘ˆç°XMLåˆ°æµè§ˆå™¨ï¼Œè¯¥XMLå¯ä»¥é€šè¿‡XSLæ¨¡æ¿è¿›è¡Œè½¬æ¢</li><li>plaintextï¼šè¿”å›æ™®é€šæ–‡æœ¬ç±»å®¹</li></ul><h3 id="default-action-ref"><a href="#default-action-ref" class="headerlink" title="default-action-ref"></a>default-action-ref</h3><p>default-action-refæ ‡ç­¾ç”¨äºæŒ‡å®šé»˜è®¤actionå¤„ç†ï¼Œå¸¸ç”¨äº404é¡µé¢å‹å¥½è®¾è®¡ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">default-action-ref</span> <span class="attr">name</span>=<span class="string">"default"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"default"</span> <span class="attr">class</span>=<span class="string">"com.example.project.DefaultAction"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/404.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="interceptor"><a href="#interceptor" class="headerlink" title="interceptor"></a>interceptor</h3><p>interceptoræ ‡ç­¾ç”¨äºæ‹¦æˆªactionè¯·æ±‚å“åº”ï¼Œä¾‹å¦‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptors</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ­¤æ ‡ç­¾è¡¨ç¤ºåˆ›å»ºåä¸ºmyInterceptorçš„æ‹¦æˆªå™¨å¯¹åº”MyInterceptorç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"myInterceptor"</span> <span class="attr">class</span>=<span class="string">"com.example.project.MyInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--interceptor-stackæ ‡ç­¾è¡¨ç¤ºè‡ªå®šä¹‰æ‹¦æˆªå™¨æ ˆï¼Œç”±äºä½¿ç”¨è‡ªå®šä¹‰interceptorå°†è¦†ç›–é»˜è®¤æ‹¦æˆªå™¨æ ˆ(defaultStack)ï¼Œæ•…éœ€é‡æ–°æ˜¾å¼å¼•å…¥ï¼ˆæ³¨æ„æ ˆé¡ºåºï¼‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"myInterceptorStack"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/hello.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®æ­¤actionä½¿ç”¨çš„æ‹¦æˆªå™¨ï¼ˆæ ˆï¼‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myInterceptorStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="default-interceptor-ref"><a href="#default-interceptor-ref" class="headerlink" title="default-interceptor-ref"></a>default-interceptor-ref</h3><p>default-interceptor-refæ ‡ç­¾ç”¨äºæŒ‡å®šé»˜è®¤æ‹¦æˆªå™¨ï¼ˆæ ˆï¼‰</p><h3 id="global-results"><a href="#global-results" class="headerlink" title="global-results"></a>global-results</h3><p>global-resultsæ ‡ç­¾ç”¨äºå…¨å±€ç»“æœé›†è®¾ç½®ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®ä¸€ä¸ªå…¨å±€ç»“æœé›†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">global-results</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"default-result"</span>&gt;</span>/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">global-results</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="åˆ›å»ºaction"><a href="#åˆ›å»ºaction" class="headerlink" title="åˆ›å»ºaction"></a>åˆ›å»ºaction</h2><h3 id="actionå“åº”é¡µé¢å±•ç¤º"><a href="#actionå“åº”é¡µé¢å±•ç¤º" class="headerlink" title="actionå“åº”é¡µé¢å±•ç¤º"></a>actionå“åº”é¡µé¢å±•ç¤º</h3><p>æœ¬æ–‡å°†åˆ›å»º <code>HelloWorldAciton</code> ç±»ç»§æ‰¿äº <code>ActionSupport</code>ï¼Œå®ç°å…¶ <code>execute()</code> æ–¹æ³•ï¼ˆç±»ä¼¼ <code>Servlet</code> æ¥å£ä¸­ <code>service()</code> æ–¹æ³•ï¼‰</p><ol><li><p>åˆ›å»º <code>HelloWorldAciton</code> ç±»ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"HelloWorldAction execute."</span>);</span><br><span class="line">        <span class="keyword">return</span> ActionSupport.SUCCESS;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åŒæ—¶ï¼Œåœ¨ <code>struts.xml</code> æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span><br><span class="line"><span class="meta">        "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"example-package"</span> <span class="attr">namespace</span>=<span class="string">"/"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/hello.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>éšååœ¨webæ–‡ä»¶å¤¹ä¸­åˆ›å»ºåä¸º <code>hello.jsp</code> çš„JSPé¡µé¢ã€‚</p></li></ol><p>è‡³æ­¤ï¼Œæ‚¨å·²æˆåŠŸåˆ›å»ºactionå¹¶æŠ•å…¥è¿è¡Œã€‚<strong>å¹¶ä¸”actionä¸­å¹¶æ— æ˜¾ç¤ºå†…å®¹ç›¸å…³ä»£ç ï¼Œä»…é€šè¿‡è¿”å›å­—ç¬¦ä¸²å†³å®šå“åº”é¡µé¢ï¼Œè¿™ä¾¿æ˜¯MVCä¼˜åŠ¿æ‰€åœ¨ã€‚</strong></p><h3 id="actionè¯»å–è¡¨å•å‚æ•°"><a href="#actionè¯»å–è¡¨å•å‚æ•°" class="headerlink" title="actionè¯»å–è¡¨å•å‚æ•°"></a>actionè¯»å–è¡¨å•å‚æ•°</h3><p>æ¥ä¸‹æ¥ï¼Œç»§ç»­å®ç°è¡¨å•æäº¤åŠŸèƒ½ï¼š</p><ol><li><p>å®ç°Modelï¼Œæ­¤å¤„ä½¿ç”¨Userç±»ä½œä¸ºJavaBeanï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>action</code> ä¸­å®ç° <code>ModelDriven</code> æ¥å£ç»‘å®šModelï¼Œæ­¤å¤„Modelä¸º <code>User</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ModelDriven</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//æ­¤å¤„ä¸€å®šè¦å…ˆå®ä¾‹åŒ–ï¼Œå¦åˆ™Struts2æ¡†æ¶è°ƒç”¨getModelæ–¹æ³•çš„è¿”å›å€¼ä¸ºnull</span></span><br><span class="line">    <span class="keyword">private</span> User user = <span class="keyword">new</span> User();</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ActionSupport.SUCCESS;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>login.jsp</code> é¡µé¢ä¸­å®ç°è¡¨å•æäº¤åŠŸèƒ½</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"index.action"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        ç”¨æˆ·åï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        å¯†ç ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>ç°åœ¨ï¼Œè®¿é—® <code>login.jsp</code> å³å¯å®ç°è¡¨å•æäº¤åŠŸèƒ½ã€‚</p><h3 id="actionå†…å®¹éªŒè¯"><a href="#actionå†…å®¹éªŒè¯" class="headerlink" title="actionå†…å®¹éªŒè¯"></a>actionå†…å®¹éªŒè¯</h3><p>æœ€åå®ç°è¡¨å•å†…å®¹éªŒè¯åŠŸèƒ½ï¼š</p><ol><li><p>å®ç° <code>ActionSupport</code> åŸºç±»çš„ <code>validate()</code> æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == user.getName() || user.getName().equals(<span class="string">""</span>))</span><br><span class="line">        <span class="comment">// å½“addFieldErrorä¹‹åactionè°ƒç”¨è¿”å›å€¼è‡ªåŠ¨å˜æ›´ä¸º `input`</span></span><br><span class="line">        <span class="keyword">this</span>.addFieldError(<span class="string">"username"</span>, <span class="string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>é…ç½® <code>strtuts.xml</code> æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span><br><span class="line"><span class="meta">        "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"example-package"</span> <span class="attr">namespace</span>=<span class="string">"/"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/hello.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹<code>login.jsp</code> é¡µé¢ä»£ç ï¼Œå®ç°é”™è¯¯ä¿¡æ¯è¯»å–</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"index.action"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:fielderror</span> <span class="attr">fieldName</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        ç”¨æˆ·åï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        å¯†ç ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="actionè®¿é—®Servlet-API"><a href="#actionè®¿é—®Servlet-API" class="headerlink" title="actionè®¿é—®Servlet API"></a>actionè®¿é—®Servlet API</h3><p>è®¿é—®Servlet APIï¼Œåªéœ€å®ç° <code>ServletContextAware</code> ã€ <code>ServletRequestAware</code> ã€ <code>ServletResponseAware</code> æ¥å£å³å¯ã€‚<br>ä»¥ä¸‹ä»£ç å®ç° <code>ServletRequestAware</code> æ¥å£çš„ <code>setServletRequest</code> æ–¹æ³•è®¾ç½®requestå±æ€§ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ServletRequestAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HttpServletRequest request;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        request.setAttribute(<span class="string">"path"</span>, <span class="string">"HelloWorld"</span>);</span><br><span class="line">        <span class="keyword">return</span> Action.SUCCESS;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setServletRequest</span><span class="params">(HttpServletRequest httpServletRequest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.request = httpServletRequest;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç»“åˆ <code>struts.xml</code> æ–‡ä»¶ä¸­ <code>result</code> æ ‡ç­¾çš„OGNLè¡¨è¾¾å¼å†…å®¹ï¼Œå³å¯å®ç°åŠ¨æ€è·³è½¬ã€‚</p><h2 id="åˆ›å»ºinterceptor"><a href="#åˆ›å»ºinterceptor" class="headerlink" title="åˆ›å»ºinterceptor"></a>åˆ›å»ºinterceptor</h2><p>æœ¬æ–‡å°†åˆ›å»º <code>MyInterceptor</code> ç±»ç»§æ‰¿äº <code>Interceptor</code>ï¼Œå®ç°å…¶ <code>intercept()</code> æ–¹æ³•ï¼ˆç±»ä¼¼ <code>Filter</code> æ¥å£ä¸­ <code>doFilter()</code> æ–¹æ³•ï¼‰</p><ol><li><p>åˆ›å»º <code>MyInterceptor</code> ç±»ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">extends</span> <span class="title">Interceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">intercept</span><span class="params">(ActionInvocation actionInvocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è¿›å…¥æ‹¦æˆªå™¨"</span>);</span><br><span class="line">        String returnName = actionInvocation.invoke();</span><br><span class="line">        System.out.println(<span class="string">"èµ°å‡ºæ‹¦æˆªå™¨"</span>);</span><br><span class="line">        <span class="keyword">return</span> returnName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åŒæ—¶ï¼Œåœ¨ <code>struts.xml</code> æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"</span></span><br><span class="line"><span class="meta">        "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"example-package"</span> <span class="attr">namespace</span>=<span class="string">"/"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">interceptors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"myInterceptor"</span> <span class="attr">class</span>=<span class="string">"com.example.project.MyInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"myInterceptorStack"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">class</span>=<span class="string">"com.example.project.HelloWorldAction"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/hello.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"myInterceptorStack"</span>&gt;</span><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>å¦æœ‰é’ˆå¯¹æ€§æå¼ºçš„æ–¹æ³•æ‹¦æˆªå™¨ï¼Œå®ç°è¯¥æ‹¦æˆªå™¨éœ€ç»§æ‰¿ <code>MethodFilterInterceptor</code> æ¥å£çš„ <code>doIntercept()</code> æ–¹æ³•ï¼Œä¸å†ç´¯è¿°ã€‚</p><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><p>Q: é…ç½® <code>web.xml</code> ä¸­çš„ <code>welcome-file</code> ä¸ºactionå¯¹åº”URLæ—¶å¹¶æœªç”Ÿæ•ˆï¼Ÿ<br>A: <code>web.xml</code> é…ç½®æ–‡ä»¶ç”±servletå®¹å™¨(tomcat)è¯»å–ï¼Œ<code>tomcat</code> å¯åŠ¨ <code>main</code> å‡½æ•°ç”Ÿæˆ <code>Bootstrap</code> å®ä¾‹ï¼Œéšå³æ‰§è¡Œ <code>init()</code> åˆå§‹åŒ–ï¼Œå¹¶è°ƒç”¨ <code>start()</code> æ–¹æ³•ã€‚<br><code>init()</code> æ–¹æ³•é‡Œåˆå§‹åŒ–classloaderï¼Œç”±æ­¤åˆ›å»º <code>Catalina</code> å®ä¾‹ã€‚<code>Bootstrap</code> çš„ <code>start()</code> æ–¹æ³•è°ƒç”¨ <code>Catalina</code> å®ä¾‹ç›¸åº” <code>load(args)</code> æ–¹æ³•åˆ›å»º <code>Server</code> å¯¹è±¡ã€‚<br><code>Service</code> å¯¹è±¡è°ƒç”¨ <code>init</code> å’Œ <code>start</code> æ–¹æ³•å¯åŠ¨ <code>Container</code> (å³ <code>Engine</code> ã€ <code>Host</code> ã€ <code>Context</code> ã€ <code>Wrapper</code> æ¥å£çš„å„ä¸ªå®ç°ç±»)ã€‚<br>å…¶ä¸­ <code>Context</code> æ¥å£çš„å®ç°ç±» <code>StandardContext</code> åœ¨ <code>bindThread()</code> åè§¦å‘CONFIGURE_START_EVENTäº‹ä»¶ï¼Œ <code>ContextConfig</code> æ¥æ”¶äº‹ä»¶åè°ƒç”¨ <code>configureStart()</code> æ–¹æ³•ã€‚<br>ä¹‹åè°ƒç”¨ <code>webConfig()</code> æ–¹æ³•ï¼Œè¿›å…¥ <code>WebXmlParser</code> å®ä¾‹çš„ <code>parseWebXml()</code> æ–¹æ³•ï¼Œé€šè¿‡ <code>Digester</code> å’Œ <code>WebRuleSet</code> å®ä¾‹è§£æ <code>web.xml</code> ï¼Œå†è¿›å…¥ <code>configureContext(webXml)</code> æ–¹æ³•å°† <code>welcome-file</code> æ ‡ç­¾å†…å®¹é€šè¿‡ <code>StandardContext</code> å®ä¾‹çš„ <code>addWelcomeFile(string)</code> æ–¹æ³•æ·»åŠ å…¶ä¸­ã€‚<br>åœ¨URLè¯·æ±‚æ—¶æŒ‰ç…§æµç¨‹ <code>EndPoint -&gt; Processor -&gt; CoyoteAdapter -&gt; Mapper</code> è¿›è¡Œå¤„ç†ï¼ŒMapperæ ¹æ®ä»¥ä¸‹åŒ¹é…æ¬¡åºè¿›è¡ŒURLå’Œwrapperå®¹å™¨ï¼ˆå®¹å™¨ä¸­åŒ…å«Servletï¼Œå³Servletï¼‰çš„åŒ¹é…ï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">internalMapWrapper</span><span class="params">(ContextVersion contextVersion, CharChunk path, MappingData mappingData)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pathOffset = path.getOffset();</span><br><span class="line">    <span class="keyword">int</span> pathEnd = path.getEnd();</span><br><span class="line">    <span class="keyword">boolean</span> noServletPath = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">int</span> length = contextVersion.path.length();</span><br><span class="line">    <span class="keyword">if</span> (length == (pathEnd - pathOffset)) &#123;</span><br><span class="line">        noServletPath = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> servletPath = pathOffset + length;</span><br><span class="line">    path.setOffset(servletPath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rule 1 -- Exact Match</span></span><br><span class="line">    MappedWrapper[] exactWrappers = contextVersion.exactWrappers;</span><br><span class="line">    internalMapExactWrapper(exactWrappers, path, mappingData);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rule 2 -- Prefix Match</span></span><br><span class="line">    <span class="keyword">boolean</span> checkJspWelcomeFiles = <span class="keyword">false</span>;</span><br><span class="line">    MappedWrapper[] wildcardWrappers = contextVersion.wildcardWrappers;</span><br><span class="line">    <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span>) &#123;</span><br><span class="line">        internalMapWildcardWrapper(wildcardWrappers, contextVersion.nesting, path, mappingData);</span><br><span class="line">        <span class="keyword">if</span> (mappingData.wrapper != <span class="keyword">null</span> &amp;&amp; mappingData.jspWildCard) &#123;</span><br><span class="line">            <span class="keyword">char</span>[] buf = path.getBuffer();</span><br><span class="line">            <span class="keyword">if</span> (buf[pathEnd - <span class="number">1</span>] == <span class="string">'/'</span>) &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                * Path ending in '/' was mapped to JSP servlet based on</span></span><br><span class="line"><span class="comment">                * wildcard match (e.g., as specified in url-pattern of a</span></span><br><span class="line"><span class="comment">                * jsp-property-group.</span></span><br><span class="line"><span class="comment">                * Force the context's welcome files, which are interpreted</span></span><br><span class="line"><span class="comment">                * as JSP files (since they match the url-pattern), to be</span></span><br><span class="line"><span class="comment">                * considered. See Bugzilla 27664.</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                mappingData.wrapper = <span class="keyword">null</span>;</span><br><span class="line">                checkJspWelcomeFiles = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// See Bugzilla 27704</span></span><br><span class="line">                mappingData.wrapperPath.setChars(buf, path.getStart(), path.getLength());</span><br><span class="line">                mappingData.pathInfo.recycle();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(mappingData.wrapper == <span class="keyword">null</span> &amp;&amp; noServletPath &amp;&amp; contextVersion.object.getMapperContextRootRedirectEnabled()) &#123;</span><br><span class="line">        <span class="comment">// The path is empty, redirect to "/"</span></span><br><span class="line">        path.append(<span class="string">'/'</span>);</span><br><span class="line">        pathEnd = path.getEnd();</span><br><span class="line">        mappingData.redirectPath.setChars(path.getBuffer(), pathOffset, pathEnd - pathOffset);</span><br><span class="line">        path.setEnd(pathEnd - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rule 3 -- Extension Match</span></span><br><span class="line">    MappedWrapper[] extensionWrappers = contextVersion.extensionWrappers;</span><br><span class="line">    <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span> &amp;&amp; !checkJspWelcomeFiles) &#123;</span><br><span class="line">        internalMapExtensionWrapper(extensionWrappers, path, mappingData, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rule 4 -- Welcome resources processing for servlets</span></span><br><span class="line">    <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">boolean</span> checkWelcomeFiles = checkJspWelcomeFiles;</span><br><span class="line">        <span class="keyword">if</span> (!checkWelcomeFiles) &#123;</span><br><span class="line">            <span class="keyword">char</span>[] buf = path.getBuffer();</span><br><span class="line">            checkWelcomeFiles = (buf[pathEnd - <span class="number">1</span>] == <span class="string">'/'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (checkWelcomeFiles) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; (i &lt; contextVersion.welcomeResources.length) &amp;&amp; (mappingData.wrapper == <span class="keyword">null</span>); i++) &#123;</span><br><span class="line">                path.setOffset(pathOffset);</span><br><span class="line">                path.setEnd(pathEnd);</span><br><span class="line">                path.append(contextVersion.welcomeResources[i], <span class="number">0</span>, contextVersion.welcomeResources[i].length());</span><br><span class="line">                path.setOffset(servletPath);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Rule 4a -- Welcome resources processing for exact macth</span></span><br><span class="line">                internalMapExactWrapper(exactWrappers, path, mappingData);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Rule 4b -- Welcome resources processing for prefix match</span></span><br><span class="line">                <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    internalMapWildcardWrapper(wildcardWrappers, contextVersion.nesting, path, mappingData);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Rule 4c -- Welcome resources processing for physical folder</span></span><br><span class="line">                <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span> &amp;&amp; contextVersion.resources != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    String pathStr = path.toString();</span><br><span class="line">                    WebResource file = contextVersion.resources.getResource(pathStr);</span><br><span class="line">                    <span class="keyword">if</span> (file != <span class="keyword">null</span> &amp;&amp; file.isFile()) &#123;</span><br><span class="line">                        internalMapExtensionWrapper(extensionWrappers, path, mappingData, <span class="keyword">true</span>);</span><br><span class="line">                        <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span> &amp;&amp; contextVersion.defaultWrapper != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            mappingData.wrapper = contextVersion.defaultWrapper.object;</span><br><span class="line">                            mappingData.requestPath.setChars(path.getBuffer(), path.getStart(), path.getLength());</span><br><span class="line">                            mappingData.wrapperPath.setChars(path.getBuffer(), path.getStart(), path.getLength());</span><br><span class="line">                            mappingData.requestPath.setString(pathStr);</span><br><span class="line">                            mappingData.wrapperPath.setString(pathStr);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            path.setOffset(servletPath);</span><br><span class="line">            path.setEnd(pathEnd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* welcome file processing - take 2</span></span><br><span class="line"><span class="comment">    * Now that we have looked for welcome files with a physical</span></span><br><span class="line"><span class="comment">    * backing, now look for an extension mapping listed</span></span><br><span class="line"><span class="comment">    * but may not have a physical backing to it. This is for</span></span><br><span class="line"><span class="comment">    * the case of index.jsf, index.do, etc.</span></span><br><span class="line"><span class="comment">    * A watered down version of rule 4</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">boolean</span> checkWelcomeFiles = checkJspWelcomeFiles;</span><br><span class="line">        <span class="keyword">if</span> (!checkWelcomeFiles) &#123;</span><br><span class="line">            <span class="keyword">char</span>[] buf = path.getBuffer();</span><br><span class="line">            checkWelcomeFiles = (buf[pathEnd - <span class="number">1</span>] == <span class="string">'/'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (checkWelcomeFiles) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; (i &lt; contextVersion.welcomeResources.length) &amp;&amp; (mappingData.wrapper == <span class="keyword">null</span>); i++) &#123;</span><br><span class="line">                path.setOffset(pathOffset);</span><br><span class="line">                path.setEnd(pathEnd);</span><br><span class="line">                path.append(contextVersion.welcomeResources[i], <span class="number">0</span>, contextVersion.welcomeResources[i].length());</span><br><span class="line">                path.setOffset(servletPath);</span><br><span class="line">                internalMapExtensionWrapper(extensionWrappers, path, mappingData, <span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            path.setOffset(servletPath);</span><br><span class="line">            path.setEnd(pathEnd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rule 7 -- Default servlet</span></span><br><span class="line">    <span class="keyword">if</span> (mappingData.wrapper == <span class="keyword">null</span> &amp;&amp; !checkJspWelcomeFiles) &#123;</span><br><span class="line">        <span class="keyword">if</span> (contextVersion.defaultWrapper != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mappingData.wrapper = contextVersion.defaultWrapper.object;</span><br><span class="line">            mappingData.requestPath.setChars(path.getBuffer(), path.getStart(), path.getLength());</span><br><span class="line">            mappingData.wrapperPath.setChars(path.getBuffer(), path.getStart(), path.getLength());</span><br><span class="line">            mappingData.matchType = MappingMatch.DEFAULT;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Redirection to a folder</span></span><br><span class="line">        <span class="keyword">char</span>[] buf = path.getBuffer();</span><br><span class="line">        <span class="keyword">if</span> (contextVersion.resources != <span class="keyword">null</span> &amp;&amp; buf[pathEnd -<span class="number">1</span> ] != <span class="string">'/'</span>) &#123;</span><br><span class="line">            String pathStr = path.toString();</span><br><span class="line">            WebResource file;</span><br><span class="line">            <span class="comment">// Handle context root</span></span><br><span class="line">            <span class="keyword">if</span> (pathStr.length() == <span class="number">0</span>) &#123;</span><br><span class="line">                file = contextVersion.resources.getResource(<span class="string">"/"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                file = contextVersion.resources.getResource(pathStr);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (file != <span class="keyword">null</span> &amp;&amp; file.isDirectory() &amp;&amp; contextVersion.object.getMapperDirectoryRedirectEnabled()) &#123;</span><br><span class="line">                <span class="comment">// Note: this mutates the path: do not do any processing</span></span><br><span class="line">                <span class="comment">// after this (since we set the redirectPath, there</span></span><br><span class="line">                <span class="comment">// shouldn't be any)</span></span><br><span class="line">                path.setOffset(pathOffset);</span><br><span class="line">                path.append(<span class="string">'/'</span>);</span><br><span class="line">                mappingData.redirectPath.setChars(path.getBuffer(), path.getStart(), path.getLength());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mappingData.requestPath.setString(pathStr);</span><br><span class="line">                mappingData.wrapperPath.setString(pathStr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    path.setOffset(pathOffset);</span><br><span class="line">    path.setEnd(pathEnd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ol><li>ç²¾ç¡®åŒ¹é…(Exact Match)</li><li>å‰ç¼€åŒ¹é…(Prefix Match)</li><li>åç¼€åŒ¹é…(Extension Match)</li><li>åŠ å…¥æ¬¢è¿é¡µé¢åœ°å€åŒ¹é…(Welcome resources processing for servlets)<br> 4.1. æ¬¢è¿é¡µé¢ç²¾ç¡®åŒ¹é…(Welcome resources processing for exact macth)<br> 4.2. æ¬¢è¿é¡µé¢å‰ç¼€åŒ¹é…(Welcome resources processing for prefix match)<br> 4.3. æ¬¢è¿é¡µé¢é™æ€æ–‡ä»¶åŒ¹é…(Welcome resources processing for physical folder)<br> 4.4. æ¬¢è¿é¡µé¢åç¼€åŒ¹é…(welcome file processing - take 2)</li><li>é»˜è®¤Servletè·¯å¾„â€œ/â€åŒ¹é…(Default servlet)</li></ol><p>è¿›å…¥ <code>Mapper</code> æ—¶ç”±äºé¦–æ¬¡å¯åŠ¨è®¿é—®ä¸»é¡µURLä¸º <code>http://host:port/project/</code> ä»¥â€œ/â€ç»“å°¾ï¼Œæ•…æ­¥éª¤1ã€2ã€3å‡åŒ¹é…å¤±è´¥ã€‚<br>è¿›å…¥æ­¥éª¤4ï¼Œè¯·æ±‚URLå˜ä¸º <code>http://host:port/project/*.action</code> ã€‚<br>ç„¶è€Œ <code>wrapperå®¹å™¨</code> ä»…æ”¯æŒæŸ¥æ‰¾ <code>Servlet</code> ï¼Œæ•…æ­¥éª¤4.1ã€4.2å‡å¤±è´¥ï¼Œç”±äºæœªåˆ›å»ºæ–‡ä»¶ <code>*.action</code> æ•…æ­¥éª¤4.3ä¾æ—§å¤±è´¥ã€‚<br><code>wrapperå®¹å™¨</code> ä»…æ”¯æŒæŸ¥æ‰¾ <code>Servlet</code> ï¼ŒåŒç†æ­¥éª¤4.4ä¹Ÿå¤±è´¥ã€‚<br>URLé‡æ–°é€€åŒ–ä¸º <code>http://host:port/project/</code> è¿›å…¥æ­¥éª¤7æˆåŠŸåŒ¹é…ï¼Œä¼ ç»™è¿‡æ»¤å™¨(filter)å¤„ç†ï¼Œè¿›å…¥Struts2æ¡†æ¶ã€‚<br>Struts2æ¡†æ¶æ— æ³•åŒ¹é…æ­¤URLå¯¹åº”actionï¼Œæ•…ä¸»é¡µè®¾ç½®æœªç”Ÿæ•ˆã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è‡³æ­¤ï¼ŒStruts2æ¡†æ¶åŸºæœ¬ä½¿ç”¨æ–¹æ³•æŒæ¡ã€‚</p>]]></content>
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSH </tag>
            
            <tag> æ¡†æ¶ </tag>
            
            <tag> Struts </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜9-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</title>
      <link href="/2018/04/02/%E5%89%91%E6%8C%87Offer-%E9%A2%989-%E7%94%A8%E4%B8%A4%E4%B8%AA%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97/"/>
      <url>/2018/04/02/%E5%89%91%E6%8C%87Offer-%E9%A2%989-%E7%94%A8%E4%B8%A4%E4%B8%AA%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"><a href="#é¢˜ç›®ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—" class="headerlink" title="é¢˜ç›®ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"></a>é¢˜ç›®ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</h1><h2 id="é¢˜ç›®ä¸€ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"><a href="#é¢˜ç›®ä¸€ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—" class="headerlink" title="é¢˜ç›®ä¸€ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"></a>é¢˜ç›®ä¸€ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</h2><p>ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼šè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteHeadï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥ç»“ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ç»“ç‚¹çš„åŠŸèƒ½ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="class"><span class="keyword">class</span> <span class="title">CQueue</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    CQueue();</span><br><span class="line">    ~CQueue();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">appendTail</span><span class="params">(<span class="keyword">const</span> T&amp; node)</span></span>;</span><br><span class="line">    <span class="function">T <span class="title">deleteHead</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">stack</span>&lt;T&gt; stack1;</span><br><span class="line">    <span class="built_in">stack</span>&lt;T&gt; stack2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h2 id="é¢˜ç›®äºŒï¼šç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ ˆå®ç°æ ˆ"><a href="#é¢˜ç›®äºŒï¼šç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ ˆå®ç°æ ˆ" class="headerlink" title="é¢˜ç›®äºŒï¼šç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ ˆå®ç°æ ˆ"></a>é¢˜ç›®äºŒï¼šç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ ˆå®ç°æ ˆ</h2><p>ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆã€‚è¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteTailã€‚</p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><h2 id="è§£æé¢˜ç›®ä¸€"><a href="#è§£æé¢˜ç›®ä¸€" class="headerlink" title="è§£æé¢˜ç›®ä¸€"></a>è§£æé¢˜ç›®ä¸€</h2><p>æ ˆï¼šå…ˆè¿›åå‡º<br>å †ï¼šå…ˆè¿›å…ˆå‡º<br>æƒ³ç”¨æ ˆå®ç°å †ï¼Œåªèƒ½å°†æ ˆå€’æ”¾ã€‚å¥½åœ¨æœ‰ä¸¤ä¸ªæ ˆï¼Œå¯ä»¥å€’åºå­˜å–ã€‚æ•…ä»£ç å¦‚ä¸‹<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">void</span> CQueue&lt;T&gt;::appendTail(<span class="keyword">const</span> T&amp; node)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (!stack2.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        stack1.push(stack2.top());</span><br><span class="line">        stack2.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    stack1.push(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">T CQueue&lt;T&gt;::deleteHead()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (!stack1.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        stack2.push(stack1.top());</span><br><span class="line">        stack1.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    T temp = stack2.top();</span><br><span class="line">    stack2.pop();</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Šä»£ç å­˜åœ¨ä¸¤å¤§é—®é¢˜ğŸ˜­</p><ol><li><code>stack2.pop()</code> æœªè¿›è¡Œæ ˆç©ºåˆ¤æ–­</li><li>å­˜å–å‡æ‹·è´æ ˆæ•°æ®ï¼Œæ•ˆç‡ä½ä¸‹</li></ol><p>æ·±å…¥åˆ†æï¼Œæ ˆç»“æ„ç¬¦åˆå­˜å‚¨æ“ä½œï¼Œæ— éœ€æ”¹åŠ¨ï¼›åˆ é™¤æ“ä½œåªéœ€æ”¹å˜å•ä¸ªæ ˆç»“æ„ï¼Œä¸€ä¸ªå½“å †å¤´ï¼Œä¸€ä¸ªå½“å †å°¾ã€‚å¦‚å›¾æ‰€ç¤º<br><img src="https://img.vim-cn.com/f3/51b58d9a654bb7a95e948dea1243b1fb4da4e0.gif" alt="åŠ¨ç”»æ¼”ç¤º"><br>ä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">void</span> CQueue&lt;T&gt;::appendTail(<span class="keyword">const</span> T&amp; node)</span><br><span class="line">&#123;</span><br><span class="line">    stack1.push(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">T CQueue&lt;T&gt;::deleteHead()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (stack2.empty())</span><br><span class="line">        <span class="keyword">while</span> (!stack1.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            stack2.push(stack1.top());</span><br><span class="line">            stack1.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (stack2.empty())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> exception(<span class="string">"queue is empty"</span>);</span><br><span class="line">    T temp = stack2.top();</span><br><span class="line">    stack2.pop();</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="è§£æé¢˜ç›®äºŒ"><a href="#è§£æé¢˜ç›®äºŒ" class="headerlink" title="è§£æé¢˜ç›®äºŒ"></a>è§£æé¢˜ç›®äºŒ</h2><p>å †ç»“æ„ç¬¦åˆå­˜å‚¨æ“ä½œï¼Œæ— éœ€æ”¹åŠ¨ï¼›åˆ é™¤æ“ä½œéœ€è½¬ç§»ä¸­æ‰§è¡Œï¼Œæ•…ä¸¤ä¸ªå †è½®æµä½¿ç”¨ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">void</span> CStack&lt;T&gt;::appendTail(<span class="keyword">const</span> T&amp; node)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;T&gt; saveQueue = !queue1.empty() ? queue1 : queue2;</span><br><span class="line">    saveQueue.push(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">T CStack&lt;T&gt;::deleteTail()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;T&gt; readQueue = !queue1.empty() ? queue1 : queue2;</span><br><span class="line">    <span class="built_in">queue</span>&lt;T&gt; saveQueue = queue1.empty() ? queue1 : queue2;</span><br><span class="line">    <span class="keyword">while</span> (!readQueue.size() &gt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        saveQueue.push(readQueue.top());</span><br><span class="line">        readQueue.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (saveQueue.empty())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> exception(<span class="string">"stack is empty"</span>);</span><br><span class="line">    T temp = readQueue.top();</span><br><span class="line">    readQueue.pop();</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜8-äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</title>
      <link href="/2018/03/30/%E5%89%91%E6%8C%87Offer-%E9%A2%988-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E4%B8%8B%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9/"/>
      <url>/2018/03/30/%E5%89%91%E6%8C%87Offer-%E9%A2%988-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E4%B8%8B%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹"><a href="#é¢˜ç›®ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹" class="headerlink" title="é¢˜ç›®ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹"></a>é¢˜ç›®ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</h1><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘å’Œå…¶ä¸­çš„ä¸€ä¸ªç»“ç‚¹ï¼Œè¯·æ‰¾å‡ºä¸­åºéå†é¡ºåºçš„ä¸‹ä¸€ä¸ªç»“ç‚¹å¹¶ä¸”è¿”å›ã€‚æ³¨æ„ï¼Œæ ‘ä¸­çš„ç»“ç‚¹ä¸ä»…åŒ…å«å·¦å³å­ç»“ç‚¹ï¼ŒåŒæ—¶åŒ…å«æŒ‡å‘çˆ¶ç»“ç‚¹çš„æŒ‡é’ˆã€‚</p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>é€šè¿‡ä¸¾ä¾‹ç”»å‡ºäºŒå‰æ ‘ï¼Œåˆ†æƒ…å†µè®¨è®º<strong>ï¼ˆæœ‰åºåˆ¤æ–­ï¼Œä¸å¯é¢ å€’ï¼‰</strong>ï¼š</p><ul><li>ç»™å®šèŠ‚ç‚¹å«å³å­èŠ‚ç‚¹ï¼Œåˆ¤æ–­ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹<ul><li>ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹å«å·¦å­èŠ‚ç‚¹ï¼Œå–ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹<strong>å·¦å­å¶</strong></li><li>ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹å«å³å­èŠ‚ç‚¹ï¼Œå–ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹</li><li>ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹ä¸å«å­èŠ‚ç‚¹ï¼Œå–ç»™å®šèŠ‚ç‚¹å³å­èŠ‚ç‚¹</li></ul></li><li>ç»™å®šèŠ‚ç‚¹ä¸å«å³å­èŠ‚ç‚¹ï¼Œåˆ¤æ–­ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹<ul><li>ç»™å®šèŠ‚ç‚¹ä¸ºå…¶çˆ¶èŠ‚ç‚¹å·¦å­èŠ‚ç‚¹ï¼Œå–ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹</li><li>ç»™å®šèŠ‚ç‚¹ä¸ºå…¶çˆ¶èŠ‚ç‚¹å³å­èŠ‚ç‚¹ï¼Œåˆ¤æ–­ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹<ul><li>ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹ä¸ºå…¶çˆ¶èŠ‚ç‚¹å·¦å­èŠ‚ç‚¹ï¼Œå–ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹</li><li>ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹ä¸ºå…¶çˆ¶èŠ‚ç‚¹å³å­èŠ‚ç‚¹ï¼Œåˆ¤æ–­ç»™å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹<ul><li>â€¦â€¦<strong>ï¼ˆå¾ªç¯å¾€å¤ï¼Œç›´è‡³èŠ‚ç‚¹ä¸ºå…¶çˆ¶èŠ‚å·¦å­èŠ‚ç‚¹ï¼‰</strong></li></ul></li></ul></li></ul></li></ul><p>æ ¹æ®è®¨è®ºå†™å‡ºå¦‚ä¸‹ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BinaryTreeNode* <span class="title">findNext</span><span class="params">(BinaryTreeNode *pNode)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == pNode)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    BinaryTreeNode *pNext = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">if</span> (pNode-&gt;right != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pNext = pNode-&gt;right;</span><br><span class="line">        <span class="keyword">if</span> (pNext-&gt;left != <span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (pNext-&gt;left != <span class="literal">nullptr</span>)</span><br><span class="line">                pNext = pNext-&gt;left;</span><br><span class="line">            <span class="keyword">return</span> pNext;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> pNext;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        pNext = pNode-&gt;root;</span><br><span class="line">        <span class="keyword">while</span> (pNext != <span class="literal">nullptr</span> &amp;&amp; pNext-&gt;right == pNode)</span><br><span class="line">        &#123;</span><br><span class="line">            pNode = pNext;</span><br><span class="line">            pNext = pNode-&gt;root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pNext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸ä¹¦ä¸­ä»£ç å¦‚å‡ºä¸€è¾™ğŸ˜ï¼</p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
            <tag> èŠ‚ç‚¹ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜7-é‡å»ºäºŒå‰æ ‘</title>
      <link href="/2018/03/28/%E5%89%91%E6%8C%87Offer-%E9%A2%987-%E9%87%8D%E5%BB%BA%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
      <url>/2018/03/28/%E5%89%91%E6%8C%87Offer-%E9%A2%987-%E9%87%8D%E5%BB%BA%E4%BA%8C%E5%8F%89%E6%A0%91/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šé‡å»ºäºŒå‰æ ‘"><a href="#é¢˜ç›®ï¼šé‡å»ºäºŒå‰æ ‘" class="headerlink" title="é¢˜ç›®ï¼šé‡å»ºäºŒå‰æ ‘"></a>é¢˜ç›®ï¼šé‡å»ºäºŒå‰æ ‘</h1><p>è¾“å…¥æŸäºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœï¼Œè¯·é‡å»ºå‡ºè¯¥äºŒå‰æ ‘ã€‚å‡è®¾è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†ç»“æœä¸­éƒ½ä¸å«é‡å¤çš„æ•°å­—ã€‚ä¾‹å¦‚è¾“å…¥å‰åºéå†åºåˆ— <code>{1,2,4,7,3,5,6,8}</code> å’Œä¸­åºéå†åºåˆ— <code>{4,7,2,1,5,3,8,6}</code> ï¼Œåˆ™é‡å»ºå¦‚å›¾äºŒå‰æ ‘å¹¶è¾“å‡ºå®ƒçš„å¤´èŠ‚ç‚¹ã€‚<br><img src="https://img.vim-cn.com/f7/2158fb00faee41c54508719da32403a6e66671.jpg" alt="äºŒå‰æ ‘"><br>äºŒå‰æ ‘çš„å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BinaryTreeNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    BinaryTreeNode* left;</span><br><span class="line">    BinaryTreeNode* right;</span><br><span class="line">    BinaryTreeNode(<span class="keyword">int</span> x):val(x),left(<span class="literal">NULL</span>),right(<span class="literal">NULL</span>)&#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>äºŒå‰æ ‘å®šä¹‰ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„æ ‘ã€‚åˆåˆ†ä¸º</p><ul><li>æœ€å¤§å †ï¼šæ ¹èŠ‚ç‚¹å€¼æœ€å¤§</li><li>æœ€å°å †ï¼šæ ¹èŠ‚ç‚¹å€¼æœ€å°</li><li>æœç´¢æ ‘ï¼šå·¦å­èŠ‚ç‚¹å€¼å°äºæˆ–ç­‰äºæ ¹èŠ‚ç‚¹å€¼ï¼Œå³å­èŠ‚ç‚¹å€¼å¤§äºæˆ–ç­‰äºæ ¹èŠ‚ç‚¹å€¼</li><li>çº¢é»‘æ ‘ï¼šä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘ä¸­æœ€é•¿è·¯å¾„çš„é•¿åº¦ä¸ä¼šè¶…è¿‡æœ€çŸ­è·¯å¾„çš„ä¸¤å€</li></ul><p>äºŒå‰æ ‘çš„éå†æ–¹å¼åˆ†ä¸º</p><ul><li>å‰åºéå†ï¼šæ ¹èŠ‚ç‚¹-&gt;å·¦å­èŠ‚ç‚¹-&gt;å³å­èŠ‚ç‚¹</li><li>ä¸­åºéå†ï¼šå·¦å­èŠ‚ç‚¹-&gt;æ ¹èŠ‚ç‚¹-&gt;å³å­èŠ‚ç‚¹</li><li>ååºéå†ï¼šå·¦å­èŠ‚ç‚¹-&gt;å³å­èŠ‚ç‚¹-&gt;æ ¹èŠ‚ç‚¹</li><li>å±‚åºéå†(å¹¿åº¦ä¼˜å…ˆéå†)ï¼šä»æ ¹åˆ°å¶åˆ†å±‚ï¼Œæ¯å±‚ä»å·¦åˆ°å³éå†</li></ul><p><strong>å°è¯€çªï¼šä¸­åºéå†å¯ç”±æŠ•å½±æ³•ç›´è§‚å¾—å‡ºã€‚</strong>å¦‚å›¾æ‰€ç¤º<br><img src="https://img.vim-cn.com/54/90fa21c2cac47cab225ab59c7c883c83e1793c.png" alt="ä¸­åºéå†"><br>å¯¹äºé¢˜ä¸­äºŒå‰æ ‘ä¸éš¾å¾—å‡º</p><ul><li>å‰åºéå†ä¸º <code>10 6 4 8 14 12 16</code></li><li>ä¸­åºéå†ä¸º <code>4 6 8 10 12 14 16</code></li><li>ååºéå†ä¸º <code>4 8 6 12 16 14 10</code></li></ul><p>è§‚å¯Ÿå‘ç°</p><ul><li>å‰åºéå†é¡ºåºè®°å½•æ ¹èŠ‚ç‚¹ä¿¡æ¯ï¼Œå³æ ¹èŠ‚ç‚¹ <code>10</code> å…ˆäºå­èŠ‚ç‚¹ <code>6 14</code> éå†</li><li>ä¸­åºéå†è®°å½•å·¦å³å­æ ‘èŒƒå›´ï¼Œå³å·¦å­æ ‘èŠ‚ç‚¹ <code>4 6 8</code> å…ˆäºæ ¹èŠ‚ç‚¹ <code>10</code> éå†ï¼Œå³å­æ ‘èŠ‚ç‚¹ <code>12 14 16</code> åäºæ ¹èŠ‚ç‚¹ <code>10</code> éå†</li><li>ååºéå†å€’åºè®°å½•æ ¹èŠ‚ç‚¹ä¿¡æ¯ï¼Œå³æ ¹èŠ‚ç‚¹ <code>10</code> åäºå­èŠ‚ç‚¹ <code>6 14</code> éå†</li></ul><p>ä»¥å‰åºä¸ºä¸»ï¼Œä¸­åºä¸ºè¾…ï¼Œä¾¿å¯é‡å»ºäºŒå‰æ ‘ğŸ˜ã€‚ä»£ç å¦‚ä¸‹<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BinaryTreeNode* <span class="title">rebuildBinaryTree</span><span class="params">(<span class="keyword">int</span> *preOrder, <span class="keyword">int</span> *inOrder, <span class="keyword">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == preOrder || <span class="literal">nullptr</span> == inOrder || length &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    BinaryTreeNode *pRoot = <span class="literal">nullptr</span>;</span><br><span class="line">    BinaryTreeNode *pNode = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">nullptr</span> != pRoot)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">bool</span> leftNode = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">int</span> position = length;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; length; ++j)</span><br><span class="line">                <span class="keyword">if</span> (inOrder[j] == pNode-&gt;val)</span><br><span class="line">                    position = j;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (inOrder[j] == preOrder[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    leftNode = j &lt; position;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">if</span> (leftNode)</span><br><span class="line">            &#123;</span><br><span class="line">                pNode-&gt;left = <span class="keyword">new</span> BinaryTreeNode(preOrder[i]);</span><br><span class="line">                pNode = pNode-&gt;left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                pNode-&gt;right = <span class="keyword">new</span> BinaryTreeNode(preOrder[i]);</span><br><span class="line">                pNode = pNode-&gt;right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pNode = pRoot = <span class="keyword">new</span> BinaryTreeNode(preOrder[i]);</span><br><span class="line">        <span class="keyword">return</span> pRoot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ­¤æ³•ä½¿ç”¨åŒé‡å¾ªç¯ï¼Œæ•ˆç‡ç”šä½ã€‚å¯ä»¥ä½¿ç”¨mapå°†inOrderä¸­çš„æ•°å€¼å¯¹åº”ä¸‹æ ‡å­˜å‚¨ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´ã€‚<br>ä¸è¿‡ä¹¦ä¸­æä¾›äº†æ›´å¥½çš„æ€è·¯<strong>ï¼ˆåˆ†æ²»æ³•ï¼‰ï¼šæ—¢ç„¶å¯å¾—å‡ºå·¦å³å­æ ‘åŒ…å«æ•°å€¼ï¼Œä¸å¦¨ç»§ç»­å¯¹å­æ ‘ç»§ç»­è¿›è¡Œå·¦å³å­æ ‘åˆ’åˆ†ï¼Œç”±æ­¤å¯å…ˆï¼ˆè§£å†³å°é—®é¢˜ï¼‰å¾—å‡ºå«å¶å­èŠ‚ç‚¹å­æ ‘ï¼Œç»§è€Œï¼ˆè§£å†³å¤§é—®é¢˜ï¼‰åˆå¹¶å­æ ‘æˆè¾ƒå¤§å­æ ‘ï¼Œæœ€ç»ˆå½¢æˆäºŒå‰æ ‘ã€‚</strong>ä¸‹ä¸ºå­æ ‘åˆ†æå›¾ç‰‡<br><img src="https://img.vim-cn.com/2c/d21afdcb4b65d685e86fdfafbea3dacf104fe3.jpg" alt="å­æ ‘åˆ†æå›¾ç‰‡"><br>åˆ†æ²»æ³•éœ€é€’å½’å®ç°ï¼Œä¹¦ä¸­ç¥çº§ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BinaryTreeNode* <span class="title">rebuildBinaryTree</span><span class="params">(<span class="keyword">int</span> *preOrder, <span class="keyword">int</span> *inOrder, <span class="keyword">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == preOrder || <span class="literal">nullptr</span> == inOrder || length &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="comment">// é€’å½’ä¼ å…¥ï¼šå·¦å­æ ‘èµ·ç‚¹ï¼Œå·¦å­æ ‘ç»ˆç‚¹ï¼Œå³å­æ ‘èµ·ç‚¹ï¼Œå³å­æ ‘ç»ˆç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> constructCore(preOrder, preOrder + length - <span class="number">1</span>, inOrder, inOrder + length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">BinaryTreeNode* <span class="title">constructCore</span><span class="params">(<span class="keyword">int</span> *startPreOrder, <span class="keyword">int</span> *endPreOrder, <span class="keyword">int</span> *startInOrder, <span class="keyword">int</span> *endInOrder)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BinaryTreeNode * pRoot = <span class="keyword">new</span> BinaryTreeNode(*startPreOrder);</span><br><span class="line">    <span class="keyword">if</span> (startPreOrder == endPreOrder)</span><br><span class="line">        <span class="keyword">if</span> (startInOrder == endInOrder)</span><br><span class="line">            <span class="keyword">if</span> (*startPreOrder == *startInOrder)</span><br><span class="line">                <span class="keyword">return</span> pRoot;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="built_in">std</span>::exception(<span class="string">"Invalid input"</span>);</span><br><span class="line">    <span class="keyword">int</span> * rootPosition = startInOrder;</span><br><span class="line">    <span class="keyword">while</span> (*rootPosition != *startPreOrder &amp;&amp; rootPosition &lt;= endInOrder)</span><br><span class="line">        ++rootPosition;</span><br><span class="line">    <span class="keyword">if</span> (rootPosition &gt; endInOrder)</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">std</span>::exception(<span class="string">"Invalid input"</span>);</span><br><span class="line">    <span class="keyword">int</span> leftLength = (rootPosition - <span class="number">1</span>) - startInOrder;</span><br><span class="line">    <span class="keyword">int</span> rightLength = endInOrder - (rootPosition + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (leftLength &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ­¤å¤„ä¼ å‚èŒƒå›´éœ€å‚è€ƒå­æ ‘åˆ†æå›¾ç‰‡</span></span><br><span class="line">        pRoot-&gt;left = constructCore(startPreOrder + <span class="number">1</span>, (startPreOrder + <span class="number">1</span>) + leftLength, startInOrder, rootPosition - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (rightLength &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ­¤å¤„ä¼ å‚éœ€èŒƒå›´å‚è€ƒå­æ ‘åˆ†æå›¾ç‰‡</span></span><br><span class="line">        pRoot-&gt;right = constructCore((startPreOrder + <span class="number">1</span>) + leftLength + <span class="number">1</span>, endPreOrder, rootPosition + <span class="number">1</span>, endInOrder);</span><br><span class="line">    <span class="keyword">return</span> pRoot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜6-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</title>
      <link href="/2018/03/27/%E5%89%91%E6%8C%87Offer-%E9%A2%986-%E4%BB%8E%E5%B0%BE%E5%88%B0%E5%A4%B4%E6%89%93%E5%8D%B0%E9%93%BE%E8%A1%A8/"/>
      <url>/2018/03/27/%E5%89%91%E6%8C%87Offer-%E9%A2%986-%E4%BB%8E%E5%B0%BE%E5%88%B0%E5%A4%B4%E6%89%93%E5%8D%B0%E9%93%BE%E8%A1%A8/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"><a href="#é¢˜ç›®ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨" class="headerlink" title="é¢˜ç›®ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"></a>é¢˜ç›®ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</h1><p>è¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œä»å°¾åˆ°å¤´åè¿‡æ¥æ‰“å°æ¯ä¸ªç»“ç‚¹çš„å€¼ã€‚é“¾è¡¨ç»“ç‚¹å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    ListNode* pNext;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>é“¾è¡¨ä¸åŒæ•°ç»„ï¼ŒæŸ¥æ‰¾æŸèŠ‚ç‚¹åªèƒ½è€è€å®å®ä»å¤´éå†ã€‚å¾ªç¯å€’åºéå†éœ€è¦æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ï¼Œä¸å¯å–ã€‚åˆ†å¦‚ä¸‹ä¸¤ç§æƒ…å†µä¼˜åŒ–ï¼š</p><ol><li><p>å¦‚æœå¯ä»¥åè½¬é“¾è¡¨ï¼Œéå†ä¸­è°ƒæ•´ <code>pNext</code> æŒ‡é’ˆæŒ‡å‘ï¼Œæœ€åéå†å³å¯ã€‚ä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printListReversely</span><span class="params">(ListNode *pHead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == pHead)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">     ListNode *pNode = <span class="literal">nullptr</span>;</span><br><span class="line">     ListNode *pNodeNext = pHead;</span><br><span class="line">     ListNode *pTemp = <span class="literal">nullptr</span>;</span><br><span class="line">     <span class="keyword">while</span> (pNodeNext != <span class="literal">nullptr</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         pTemp = pNodeNext-&gt;pNext;</span><br><span class="line">         pNodeNext-&gt;pNext = pNode;</span><br><span class="line">         pNode = pNodeNext;</span><br><span class="line">         pNodeNext = pTemp;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">while</span> (pNode != <span class="literal">nullptr</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, pNode-&gt;value);</span><br><span class="line">         pNode = pNode-&gt;pNext;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å¦‚æœç¦æ­¢ä¿®æ”¹é“¾è¡¨ï¼Œéå†ä¸­å€’åºå­˜å‚¨èŠ‚ç‚¹å†…å®¹ï¼Œæœ€åéå†å³å¯ã€‚ç©ºé—´å¤æ‚åº¦O(n)ã€æ—¶é—´å¤æ‚åº¦O(n)ï¼Œæ­¤ä¸¾æ˜¯ä»¥ç©ºé—´æ¢æ—¶é—´ã€‚ä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printListReversely</span><span class="params">(ListNode *pHead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == pHead)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">     <span class="built_in">std</span>::<span class="built_in">stack</span>&lt;ListNode*&gt; nodes;</span><br><span class="line">     ListNode *pNode = pHead;</span><br><span class="line">     <span class="keyword">while</span> (pNode != <span class="literal">nullptr</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         nodes.push(pNode);</span><br><span class="line">         pNode = pNode-&gt;pNext;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">while</span> (!nodes.empty())</span><br><span class="line">     &#123;</span><br><span class="line">         pNode = nodes.top();</span><br><span class="line">         <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, pNode-&gt;value);</span><br><span class="line">         nodes.pop();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> æ‰“å° </tag>
            
            <tag> é“¾è¡¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜5-æ›¿æ¢ç©ºæ ¼</title>
      <link href="/2018/03/27/%E5%89%91%E6%8C%87Offer-%E9%A2%985-%E6%9B%BF%E6%8D%A2%E7%A9%BA%E6%A0%BC/"/>
      <url>/2018/03/27/%E5%89%91%E6%8C%87Offer-%E9%A2%985-%E6%9B%BF%E6%8D%A2%E7%A9%BA%E6%A0%BC/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šæ›¿æ¢ç©ºæ ¼"><a href="#é¢˜ç›®ï¼šæ›¿æ¢ç©ºæ ¼" class="headerlink" title="é¢˜ç›®ï¼šæ›¿æ¢ç©ºæ ¼"></a>é¢˜ç›®ï¼šæ›¿æ¢ç©ºæ ¼</h1><h2 id="é¢˜ç›®ä¸€ï¼šæ›¿æ¢ç©ºæ ¼"><a href="#é¢˜ç›®ä¸€ï¼šæ›¿æ¢ç©ºæ ¼" class="headerlink" title="é¢˜ç›®ä¸€ï¼šæ›¿æ¢ç©ºæ ¼"></a>é¢˜ç›®ä¸€ï¼šæ›¿æ¢ç©ºæ ¼</h2><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠåŸå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆâ€œ%20â€ï¼Œä¾‹å¦‚è¾“å…¥â€œWe are happyâ€,åˆ™è¾“å‡ºâ€œWe%20are%20happyâ€ã€‚</p><h2 id="é¢˜ç›®äºŒï¼šåˆå¹¶æ’åºæ•°ç»„"><a href="#é¢˜ç›®äºŒï¼šåˆå¹¶æ’åºæ•°ç»„" class="headerlink" title="é¢˜ç›®äºŒï¼šåˆå¹¶æ’åºæ•°ç»„"></a>é¢˜ç›®äºŒï¼šåˆå¹¶æ’åºæ•°ç»„</h2><p>æœ‰ä¸¤ä¸ªæ’åºçš„æ•°ç»„A1å’ŒA2ï¼Œå†…å­˜åœ¨A1çš„æœ«å°¾æœ‰è¶³å¤Ÿå¤šçš„ç©ºä½™ç©ºé—´å®¹çº³A2ã€‚è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠA2ä¸­çš„æ‰€æœ‰æ•°å­—æ’å…¥A1ä¸­ï¼Œå¹¶ä¸”æ‰€æœ‰çš„æ•°å­—æ˜¯æ’åºçš„ã€‚</p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><h2 id="è§£æé¢˜ç›®ä¸€"><a href="#è§£æé¢˜ç›®ä¸€" class="headerlink" title="è§£æé¢˜ç›®ä¸€"></a>è§£æé¢˜ç›®ä¸€</h2><p>æœ¬é¢˜è€ƒæŸ¥å­—ç¬¦ä¸²æ›¿æ¢ï¼Œä¸”åœ¨åŸå­—ç¬¦ä¸²ä¸Šæ”¹åŠ¨ã€‚è‹¥è€ƒè™‘<strong>ä»å¤´è‡³å°¾éå†å­—ç¬¦ä¸²è¿›è¡Œå­—ç¬¦åç§»ï¼Œåˆ™äº§ç”Ÿå¤šæ¬¡å­—æ®µç§»åŠ¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ã€‚</strong><br>è€ƒè™‘ä»å°¾è‡³å¤´éå†å­—ç¬¦ä¸²è¿›è¡Œå­—ç¬¦åç§»ï¼Ÿç»ä¹¦ä¸­ç‚¹æ‹¨ï¼Œæ­¤æ³•ç”šå¦™ğŸ˜‚ï¼<strong>ä»å°¾è‡³å¤´ä»…äº§ç”Ÿä¸€æ¬¡å­—æ®µç§»åŠ¨ï¼Œè™½<em>é¡»é¢„å…ˆæµ‹é‡ç§»åŠ¨è·ç¦»</em>ï¼Œä½†ä»…éå†2næ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚</strong><br>ä»¥ä¸‹ä¸ºæœ¬äººä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">replace</span><span class="params">(<span class="keyword">char</span> *str, <span class="keyword">int</span> length, <span class="keyword">char</span> *aimStr, <span class="keyword">char</span> *replaceStr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == str || length &lt;= <span class="number">0</span> || <span class="literal">nullptr</span> == aimStr || <span class="literal">nullptr</span> == replaceStr)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> strLength = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> replaceCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="string">'\0'</span> != str[strLength++])</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span>  == <span class="built_in">strncmp</span>(&amp;str[index], aimStr, <span class="built_in">strlen</span>(aimStr)))</span><br><span class="line">            ++replaceCount;</span><br><span class="line">    <span class="keyword">int</span> strNewLength = strLength + replaceCount * (<span class="built_in">strlen</span>(replaceStr) - <span class="built_in">strlen</span>(aimStr));</span><br><span class="line">    <span class="keyword">if</span> (strNewLength &gt; length)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> index = strLength;</span><br><span class="line">    <span class="keyword">int</span> indexNew = strNewLength;</span><br><span class="line">    <span class="keyword">while</span> (index &gt;= <span class="number">0</span> &amp;&amp; indexNew &gt; index)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> == <span class="built_in">strncmp</span>(&amp;str[index], aimStr, <span class="built_in">strlen</span>(aimStr)))</span><br><span class="line">        &#123;</span><br><span class="line">            indexNew -= <span class="built_in">strlen</span>(replaceStr) - <span class="built_in">strlen</span>(aimStr);</span><br><span class="line">            <span class="comment">// strcpyå°†è‡ªåŠ¨åœ¨å°¾éƒ¨é™„åŠ ç»“æŸç¬¦\0ï¼Œæ•…é‡‡ç”¨memcpy</span></span><br><span class="line">            <span class="built_in">memcpy</span>(&amp;str[indexNew], replaceStr, <span class="built_in">strlen</span>(replaceStr));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            str[indexNew] = str[index];</span><br><span class="line">        --index;</span><br><span class="line">        --indexNew;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="è§£æé¢˜ç›®äºŒ"><a href="#è§£æé¢˜ç›®äºŒ" class="headerlink" title="è§£æé¢˜ç›®äºŒ"></a>è§£æé¢˜ç›®äºŒ</h2><p>æ€è·¯ä¸ä¸Šé¢˜ç›¸åŒï¼Œé™„ä¸Šæœ¬äººä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">combine</span><span class="params">(<span class="keyword">int</span> *aimArr, <span class="keyword">int</span> aimArrLength, <span class="keyword">int</span> length, <span class="keyword">int</span> *insertArr, <span class="keyword">int</span> insertArrLength)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == aimArr || aimArrLength &lt;= <span class="number">0</span> || length &lt;= <span class="number">0</span> || <span class="literal">nullptr</span> == insertArr || insertArrLength &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> newLength = aimArrLength + insertArrLength;</span><br><span class="line">    <span class="keyword">if</span> (newLength &gt; length)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> indexAim = aimArrLength - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> indexInsert = insertArrLength - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> indexNew = newLength - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (indexNew &gt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> (aimArr[indexAim] &gt; insertArr[indexInsert])</span><br><span class="line">            aimArr[indexNew--] = aimArr[indexAim--];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            aimArr[indexNew--] = insertArr[indexInsert--];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<strong>åœ¨åˆå¹¶æ•°ç»„ï¼ˆåŒ…æ‹¬å­—ç¬¦ä¸²ï¼‰æ—¶ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘ä»åå¾€å‰å¤åˆ¶ã€‚</strong></p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> æ•°ç»„ </tag>
            
            <tag> æ›¿æ¢ </tag>
            
            <tag> ç©ºæ ¼ </tag>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜4-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</title>
      <link href="/2018/03/26/%E5%89%91%E6%8C%87Offer-%E9%A2%984-%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE/"/>
      <url>/2018/03/26/%E5%89%91%E6%8C%87Offer-%E9%A2%984-%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾"><a href="#é¢˜ç›®ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾" class="headerlink" title="é¢˜ç›®ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾"></a>é¢˜ç›®ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</h1><p>åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚</p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>å¯ä»¥è‚¯å®šçš„æ˜¯ç›´æ¥éå†ä¸å¯å–ğŸ™„ã€‚ä¹‹åæƒ³åˆ°è·³æ­¥åˆ¤æ–­ï¼Œå…ˆèµ°æ–œçº¿ï¼Œè‹¥æ­¤æ—¶æ•°å€¼å¤§äºæŸ¥æ‰¾æ•°åˆ™å¾€å·¦æˆ–å¾€å³å€’é€€ï¼Ÿå¾€å·¦ä¹‹åè¯¥å¾€ä¸Šè¿˜æ˜¯å¾€ä¸‹ï¼Ÿç»§è€Œè”æƒ³åˆ°A*è·¯å¾„æŸ¥æ‰¾ç®—æ³•â€¦â€¦<br>naive ! ä¹¦ä¸­æŒ‡å‡º<strong>è€ƒè™‘æ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åº</strong>ã€‚é—®é¢˜å˜å¾—å›°éš¾æ˜¯å› ä¸ºè€ƒè™‘æ•°ç»„ä¸­ä¸­é—´ä½ç½®çš„æ•°ï¼Œæ­¤æ—¶è¯¥ä½ç½®å«æœ‰ä¸¤ä¸ªæ’åºè§„å¾‹ï¼›ä¸å¦‚è€ƒè™‘ç‰¹æ®Šä½ç½®-é¡¶è§’çš„æ•°å‘¢ï¼Ÿ<br>äºŒç»´æ•°ç»„æœ‰å››ä¸ªé¡¶è§’ï¼Œé€‰æ‹©å…¶ä¸­æŸä¸ªé¡¶è§’åˆ†æã€‚ä¸¾ä¾‹åˆ†æï¼š<br>æœ‰å¦‚ä¸‹äºŒç»´æ•°ç»„ï¼ŒæŸ¥æ‰¾æ•°å­— <code>7</code><br>$$<br>\begin{bmatrix}<br>    1 &amp; 2 &amp; 8 &amp; 9 \\<br>    2 &amp; 4 &amp; 9 &amp; 12 \\<br>    4 &amp; 7 &amp; 10 &amp; 13 \\<br>    6 &amp; 8 &amp; 11 &amp; 15 \\<br>\end{bmatrix}<br>$$<br>å¯¹å››ä¸ªé¡¶ç‚¹åˆ†æƒ…å†µè®¨è®º(â†“ã€â†’ã€â†˜è¡¨ç¤ºå¢å¤§æ–¹å‘)ï¼š</p><ul><li>è€ƒè™‘å·¦ä¸Šè§’åˆ™æœ‰è§„å¾‹ï¼šå¯¹äºå·¦ä¸Šè§’æœ‰ä¸‰ä¸ªå‡ºåº¦<br>$$<br>\begin{bmatrix}<br>  â— &amp; \rightarrow &amp; \rightarrow &amp; \rightarrow \\<br>  \downarrow &amp; \searrow &amp; \downarrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \searrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \rightarrow &amp; \searrow \\<br>\end{bmatrix}<br>$$</li><li>è€ƒè™‘å³ä¸‹è§’åˆ™æœ‰è§„å¾‹ï¼šå¯¹äºå³ä¸‹è§’æœ‰ä¸‰ä¸ªå…¥åº¦<br>$$<br>\begin{bmatrix}<br>  ï¼‹ &amp; \rightarrow &amp; \rightarrow &amp; \rightarrow \\<br>  \downarrow &amp; \searrow &amp; \downarrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \searrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \rightarrow &amp; â— \\<br>\end{bmatrix}<br>$$</li><li>è€ƒè™‘å³ä¸Šè§’åˆ™æœ‰è§„å¾‹ï¼š<strong>å¯¹äºå³ä¸Šè§’æœ‰ä¸€ä¸ªå…¥åº¦å’Œä¸€ä¸ªå‡ºåº¦</strong><br>$$<br>\begin{bmatrix}<br>  ï¼‹ &amp; \rightarrow &amp; \rightarrow &amp; â— \\<br>  \downarrow &amp; \searrow &amp; \downarrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \searrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \rightarrow &amp; \searrow \\<br>\end{bmatrix}<br>$$</li><li>è€ƒè™‘å·¦ä¸‹è§’åˆ™æœ‰è§„å¾‹ï¼š<strong>å¯¹äºå·¦ä¸‹è§’æœ‰ä¸€ä¸ªå…¥åº¦å’Œä¸€ä¸ªå‡ºåº¦</strong><br>$$<br>\begin{bmatrix}<br>  ï¼‹ &amp; \rightarrow &amp; \rightarrow &amp; \rightarrow \\<br>  \downarrow &amp; \searrow &amp; \downarrow &amp; \downarrow \\<br>  \downarrow &amp; \rightarrow &amp; \searrow &amp; \downarrow \\<br>  â— &amp; \rightarrow &amp; \rightarrow &amp; \searrow \\<br>\end{bmatrix}<br>$$</li></ul><p>â€œæŸ¿å­è¦æ¡è½¯çš„æâ€ï¼Œå½“ç„¶é€‰ä¸€å‡ºä¸€å…¥çš„çªç ´å£å•Šï¼ä¾‹å¦‚é€‰æ‹©å³ä¸Šè§’æ•°å­— <code>9</code>ï¼Œåˆ™ <code>9 &gt; 7</code> è¯´æ˜ç¬¬å››åˆ—å‡å¤§äº <code>7</code>ï¼Œæ•…åˆ¤æ–­æ•°ç»„èŒƒå›´ç¼©å°ä¸º<br>$$<br>\begin{bmatrix}<br>    1 &amp; 2 &amp; 8 \\<br>    2 &amp; 4 &amp; 9 \\<br>    4 &amp; 7 &amp; 10 \\<br>    6 &amp; 8 &amp; 11 \\<br>\end{bmatrix}<br>$$<br>ç»§ç»­é€‰æ‹©å³ä¸Šè§’æ•°å­— <code>8</code>ï¼Œåˆ™ <code>8 &gt; 7</code> è¯´æ˜ç¬¬å››åˆ—å‡å¤§äº <code>8</code>ï¼Œæ•…åˆ¤æ–­æ•°ç»„èŒƒå›´åˆç¼©å°<br>$$<br>\begin{bmatrix}<br>    1 &amp; 2 \\<br>    2 &amp; 4 \\<br>    4 &amp; 7 \\<br>    6 &amp; 8 \\<br>\end{bmatrix}<br>$$<br>ç»§ç»­é€‰æ‹©å³ä¸Šè§’æ•°å­— <code>2</code>ï¼Œåˆ™ <code>2 &lt; 7</code> è¯´æ˜ç¬¬ä¸€è¡Œå‡å°äº <code>8</code>ï¼Œæ•…åˆ¤æ–­æ•°ç»„èŒƒå›´åŒç¼©å°<br>$$<br>\begin{bmatrix}<br>    2 &amp; 4 \\<br>    4 &amp; 7 \\<br>    6 &amp; 8 \\<br>\end{bmatrix}<br>$$<br>ç»§ç»­é€‰æ‹©å³ä¸Šè§’æ•°å­— <code>4</code>ï¼Œåˆ™ <code>4 &lt; 7</code> è¯´æ˜ç¬¬ä¸€è¡Œå‡å°äº <code>8</code>ï¼Œæ•…åˆ¤æ–­æ•°ç»„èŒƒå›´å’ç¼©å°<br>$$<br>\begin{bmatrix}<br>    4 &amp; 7 \\<br>    6 &amp; 8 \\<br>\end{bmatrix}<br>$$<br>é€‰æ‹©å³ä¸Šè§’æ•°å­— <code>7</code>ï¼Œåˆ™å¯»æ‰¾å®Œæ¯•ğŸ˜„ã€‚è½¬åŒ–ä¸ºä»£ç å¦‚ä¸‹<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">findNumber</span><span class="params">(<span class="keyword">int</span> *arr, <span class="keyword">int</span> rows, <span class="keyword">int</span> columns, <span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == arr || rows &lt; <span class="number">1</span> || columns &lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> row = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> column = columns;</span><br><span class="line">    <span class="keyword">while</span> (row &lt;= rows &amp;&amp; column &gt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (arr + ((row - <span class="number">1</span>) + (column - <span class="number">1</span>) * rows) &gt; number)</span><br><span class="line">            --column;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (arr + ((row - <span class="number">1</span>) + (column - <span class="number">1</span>) * rows) &lt; number)</span><br><span class="line">            ++row;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> æ•°ç»„ </tag>
            
            <tag> äºŒç»´ </tag>
            
            <tag> æŸ¥æ‰¾ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜3-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—</title>
      <link href="/2018/03/25/%E5%89%91%E6%8C%87Offer-%E9%A2%983-%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97/"/>
      <url>/2018/03/25/%E5%89%91%E6%8C%87Offer-%E9%A2%983-%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"><a href="#é¢˜ç›®ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—" class="headerlink" title="é¢˜ç›®ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"></a>é¢˜ç›®ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—</h1><h2 id="é¢˜ç›®ä¸€ï¼šæ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"><a href="#é¢˜ç›®ä¸€ï¼šæ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—" class="headerlink" title="é¢˜ç›®ä¸€ï¼šæ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"></a>é¢˜ç›®ä¸€ï¼šæ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—</h2><p>åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨0~n-1çš„èŒƒå›´å†…ã€‚æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ã€‚ä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—é‡å¤äº†ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥é•¿åº¦ä¸º7çš„æ•°ç»„{2,3,1,0,2,5,3}ï¼Œé‚£ä¹ˆå¯¹åº”çš„è¾“å‡ºæ˜¯é‡å¤çš„æ•°å­—2æˆ–è€…3ã€‚</p><h2 id="é¢˜ç›®äºŒï¼šä¸ä¿®æ”¹æ•°ç»„æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"><a href="#é¢˜ç›®äºŒï¼šä¸ä¿®æ”¹æ•°ç»„æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—" class="headerlink" title="é¢˜ç›®äºŒï¼šä¸ä¿®æ”¹æ•°ç»„æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"></a>é¢˜ç›®äºŒï¼šä¸ä¿®æ”¹æ•°ç»„æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—</h2><p>åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºn+1çš„æ•°ç»„é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨1~nçš„èŒƒå›´å†…ã€‚æ‰€ä»¥æ•°ç»„ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ•°å­—æ˜¯é‡å¤çš„ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ï¼Œä½†ä¸èƒ½ä¿®æ”¹è¾“å…¥çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥é•¿åº¦ä¸º8çš„æ•°ç»„{2,3,5,4,3,2,6,7}ï¼Œé‚£ä¹ˆå¯¹åº”çš„è¾“å‡ºæ˜¯é‡å¤çš„æ•°å­—2æˆ–è€…3ã€‚</p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><h2 id="è§£æé¢˜ç›®ä¸€"><a href="#è§£æé¢˜ç›®ä¸€" class="headerlink" title="è§£æé¢˜ç›®ä¸€"></a>è§£æé¢˜ç›®ä¸€</h2><p>æ•°ç»„åœ¨ç©ºé—´ä¸Šè¿ç»­ä¸”å«æœ‰ä¸‹æ ‡ï¼Œæ­¤é¢˜è€ƒè™‘æŸ¥æ‰¾æ•ˆç‡<br>ç¨åŠ æ€ç´¢ï¼Œå†³å®šåˆ©ç”¨ä¸‹æ ‡ï¼šè‹¥æ•°å€¼ä¸ä¸‹æ ‡ä¸åŒåˆ™ä¸æ•°å€¼å¯¹åº”ä¸‹æ ‡çš„æ•°å€¼è¿›è¡Œç½®æ¢ï¼Œè‹¥ç½®æ¢ä¸­å‘ç°ä¸¤æ•°ç›¸åŒåˆ™æŸ¥æ‰¾ç»“æŸï¼Œå¦‚æ­¤æ—¶é—´å¤æ‚åº¦ä»…O(n)ï¼Œä»£ç å¦‚ä¸‹<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">findDuplicate</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> length, <span class="keyword">int</span> *duplication)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i != arr[i])</span><br><span class="line">            <span class="keyword">if</span> (arr[i] != arr[arr[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = arr[arr[i]];</span><br><span class="line">                arr[arr[i]] = arr[i];</span><br><span class="line">                arr[i] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                *duplication = arr[i];</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯¹ç…§ä¹¦æœ¬å‘ç°æ€è·¯ç›¸åŒï¼Œnice !ğŸ˜<br>åŸæ¥æ— æ„ä¸­å·²åˆ©ç”¨ä¸‹æ ‡å……å½“Hash Table(å“ˆå¸Œè¡¨)çš„æ€æƒ³è§£å†³äº†é—®é¢˜<br>ä¸è¿‡æœ¬äººæ¼æ‰é‡è¦çš„<strong>ç©ºå€¼æ£€æµ‹ã€è¾¹ç•Œæ£€æµ‹</strong>ğŸ˜­ï¼Œä¿®å¤ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">findDuplicate</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> length, <span class="keyword">int</span> *duplication)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">nullptr</span> || length &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &gt;= length || arr[i] &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i != arr[i])</span><br><span class="line">            <span class="keyword">if</span> (arr[i] != arr[arr[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = arr[arr[i]];</span><br><span class="line">                arr[arr[i]] = arr[i];</span><br><span class="line">                arr[i] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                *duplication = arr[i];</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åŸæœ¬ä»¥ä¸ºå®Œç¾æ— ç‘•ï¼Œ<strong>æµ‹è¯•æ•°ç»„{0,2,0}å‘ç°æ— æ³•æ‰¾å‡ºé‡å¤æ•°å­—</strong>ã€‚<br>ç©¶å…¶åŸå› <strong>å¯¹äºæ›¿æ¢æ•°å€¼åçš„æ•°ç»„{0,0,2}æœªå†æ¬¡åˆ¤æ–­ï¼Œå¯¼è‡´ç¬¬äºŒä½ <code>0</code> æˆä¸ºæ¼ç½‘ä¹‹é±¼</strong>ï¼Œä¸‹ä¸ºä¹¦ä¸­ç¥çº§ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">duplicate</span><span class="params">(<span class="keyword">int</span> numbers[], <span class="keyword">int</span> length, <span class="keyword">int</span> *duplication)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (numbers == <span class="literal">nullptr</span> || length &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (numbers[i] &gt;= length || numbers[i] &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="comment">// ä½¿ç”¨whileä¾¿æ— â€œæ¼ç½‘ä¹‹0â€</span></span><br><span class="line">        <span class="keyword">while</span> (i != numbers[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (numbers[i] != numbers[numbers[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = numbers[numbers[i]];</span><br><span class="line">                numbers[numbers[i]] = numbers[i];</span><br><span class="line">                numbers[i] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                *duplication = numbers[i];</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="è§£æé¢˜ç›®äºŒ"><a href="#è§£æé¢˜ç›®äºŒ" class="headerlink" title="è§£æé¢˜ç›®äºŒ"></a>è§£æé¢˜ç›®äºŒ</h2><p>ç¦æ­¢ä¿®æ”¹è¾“å…¥æ•°ç»„ï¼Ÿå‘µï¼æ–­æˆ‘è´¢è·¯ï¼Œemmmmã€‚è‹¦æ€å†¥æƒ³ï¼Œä»…æƒ³åˆ°æ‹·è´æ•°ç»„å¥—ç”¨é¢˜ç›®ä¸€æ–¹æ³•â€¦â€¦<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">findDuplicate</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> length, <span class="keyword">int</span> *duplication)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == arr || length &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &gt;= length || arr[i] &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> *arrTemp = <span class="keyword">new</span> <span class="keyword">int</span>[length - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; ++i)</span><br><span class="line">        arrTemp[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (arrTemp[arr[i] - <span class="number">1</span>] == arr[i])</span><br><span class="line">        &#123;</span><br><span class="line">            *duplication = arr[i];</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        arrTemp[arr[i] - <span class="number">1</span>] = arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> arrTemp;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸€ç­¹è«å±•ä¹‹ä¸‹ï¼Œé˜…è¯»ä¹¦ä¸­è§£æé¡¿è§‰è±ç„¶å¼€æœ—ï¼ä¹¦ä¸­æŒ‡å‡ºï¼Œ<strong>å«é‡å¤æ•°å­—èŒƒå›´å†…æ•°å­—ä¸ªæ•°å¿…å¤§äºè¯¥èŒƒå›´é•¿åº¦</strong>ã€‚ä¾‹å¦‚</p><ul><li>å¯¹äºé•¿åº¦ä¸º3çš„æ•°ç»„{1,2,2}ï¼ŒèŒƒå›´[1,1]å†…çš„æ•°å­—ä¸ªæ•°ä¸º1ç­‰äºèŒƒå›´é•¿åº¦1ï¼Œè€ŒèŒƒå›´[2,2]å†…çš„æ•°å­—ä¸ªæ•°ä¸º2å¤§äºèŒƒå›´é•¿åº¦1ï¼Œå¯ä»¥ç¡®å®šé‡å¤æ•°å­—ä½äºèŒƒå›´[2,2]ä¸­å³ä¸º2ã€‚</li><li>å¯¹äºé•¿åº¦ä¸º5çš„æ•°ç»„{2,2,3,4,4}ï¼ŒèŒƒå›´[1,2]å†…çš„æ•°å­—ä¸ªæ•°ä¸º2ç­‰äºèŒƒå›´é•¿åº¦2ï¼Œè€ŒèŒƒå›´[3,4]å†…çš„æ•°å­—ä¸ªæ•°ä¸º3å¤§äºèŒƒå›´é•¿åº¦2ï¼Œå¯ä»¥ç¡®å®šé‡å¤æ•°å­—ä½äºèŒƒå›´[3,4]ä¸­ã€‚ç»§ç»­åˆ†æèŒƒå›´[3,3]å†…çš„æ•°å­—ä¸ªæ•°ä¸º1ç­‰äºèŒƒå›´é•¿åº¦1ï¼Œè€ŒèŒƒå›´[4,4]å†…çš„æ•°å­—ä¸ªæ•°ä¸º2å¤§äºèŒƒå›´é•¿åº¦1ï¼Œå¯ä»¥ç¡®å®šé‡å¤æ•°å­—ä½äºèŒƒå›´[4,4]ä¸­å³ä¸º4ã€‚<strong>(æ­¤æ–¹æ³•å¯¹äºå¤šä¸ªé‡å¤æ•°å­—ä»…èƒ½æ‰¾åˆ°å…¶ä¸­ä¹‹ä¸€)</strong></li></ul><p>ä»¥ä¸Šä¸¤ä¾‹è¯´æ˜åªéœ€å¯¹è®¡æ•°èŒƒå›´ä¸æ–­äºŒåˆ†æ³•ï¼Œå¿…å®šèƒ½æ‰¾å‡ºé‡å¤æ•°å­—ã€‚å› æ­¤å†™å‡ºä¹¦ä¸­ç¥çº§ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">countRange</span><span class="params">(<span class="keyword">int</span> numbers[], <span class="keyword">int</span> length, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == numbers)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (numbers[i] &gt;= start &amp;&amp; numbers[i] &lt;= end)</span><br><span class="line">            ++count;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">duplicate</span><span class="params">(<span class="keyword">int</span> numbers[], <span class="keyword">int</span> length, <span class="keyword">int</span> *duplication)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == numbers || length &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; ++i)</span><br><span class="line">        <span class="keyword">if</span> (numbers[i] &gt;= length || numbers[i] &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> start = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> end = length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (end &gt;= start)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> middle = ((end - start) &lt;&lt; <span class="number">1</span>) + start;</span><br><span class="line">        <span class="keyword">int</span> count = countRange(numbers, length, start, middle);</span><br><span class="line">        <span class="keyword">if</span> (end == start)</span><br><span class="line">            <span class="keyword">if</span> (count &gt; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                *duplication = start;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (count &gt; (middle - start + <span class="number">1</span>))</span><br><span class="line">            end = middle;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            start = middle + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯¹äºæ­¤äºŒåˆ†æŸ¥æ‰¾æ³•ï¼ŒcountRangeå°†è¢«è°ƒç”¨O(logn)æ¬¡ï¼Œè€ŒcountRangeçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œæ•…æ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼Œè¿™æ˜¯åˆ©ç”¨æ—¶é—´æ¢ç©ºé—´ã€‚</p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> æ•°ç»„ </tag>
            
            <tag> é‡å¤ </tag>
            
            <tag> æ•°å­— </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜2-å®ç°å•ä¾‹æ¨¡å¼</title>
      <link href="/2018/03/24/%E5%89%91%E6%8C%87Offer-%E9%A2%982-%E5%AE%9E%E7%8E%B0Singleton%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/03/24/%E5%89%91%E6%8C%87Offer-%E9%A2%982-%E5%AE%9E%E7%8E%B0Singleton%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šå®ç°å•ä¾‹-Singleton-æ¨¡å¼"><a href="#é¢˜ç›®ï¼šå®ç°å•ä¾‹-Singleton-æ¨¡å¼" class="headerlink" title="é¢˜ç›®ï¼šå®ç°å•ä¾‹(Singleton)æ¨¡å¼"></a>é¢˜ç›®ï¼šå®ç°å•ä¾‹(Singleton)æ¨¡å¼</h1><p>è®¾è®¡ä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬åªèƒ½ç”Ÿæˆè¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹</p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>é¢˜ç›®è¦æ±‚æ˜æ˜¾ï¼Œè®¾è®¡å•ä¾‹æ¨¡å¼ï¼šä»…ç”Ÿæˆå•ä¸ªå®ä¾‹<br>å¦‚æ­¤éœ€è¦è€ƒè™‘ä¸€ä¸‹å‡ ç‚¹ï¼š</p><ul><li>æ„é€ å‡½æ•°éœ€â€œéšè—â€ï¼Œä¸”å¦è®¾æ–¹æ³•é€šè¿‡é™æ€å˜é‡åˆ¤æ–­æ˜¯å¦åˆ›å»ºå®ä¾‹å……å½“æ„é€ å‡½æ•°</li><li>è¿”å›å®ä¾‹çš„æ–¹æ³•å¿…å®šä½¿ç”¨ <code>new</code> åˆ›å»ºå®ä¾‹(å¦åˆ™å°†äº§ç”Ÿå€¼ä¼ é€’ç”Ÿæˆå¤šä¸ªå•ä¾‹)ï¼Œæ•…éœ€å­˜å‚¨é™æ€å®ä¾‹æŒ‡é’ˆå¾…é”€æ¯æ—¶ä½¿ç”¨</li><li>é™æ€å˜é‡ç”¨äºå­˜å‚¨å˜é‡åˆ›å»ºçŠ¶æ€ï¼Œå°†å…¶è®¾ä¸º <code>int flag</code> ï¼Ÿæ­¤ä¸¾é€ æˆå†—ä½™ï¼Œä¸å¦‚åˆ©ç”¨é™æ€å®ä¾‹æŒ‡é’ˆ</li></ul><p>ç†æ¸…ä¸‰ç‚¹åå¥‰ä¸Šæœ¬äººæ¸£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~Singleton();</span><br><span class="line">    <span class="keyword">static</span> Singleton* s_pInstance;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    <span class="comment">// other members......</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C++ä¸­ä»…æœ‰é™æ€æ•´å½¢å¸¸é‡æ‰å¯äºç±»å†…åˆå§‹åŒ–ï¼Œå¦åˆ™å¯¼è‡´æ‰€æœ‰å®ä¾‹å‡å«è¯¥é™æ€æˆå‘˜</span></span><br><span class="line">Singleton* Singleton::s_pInstance = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">Singleton::Singleton() &#123;&#125;</span><br><span class="line"></span><br><span class="line">Singleton::~Singleton()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> != Singleton::s_pInstance)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> Singleton::s_pInstance;</span><br><span class="line">        Singleton::s_pInstance = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::getInstance()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == Singleton::s_pInstance)</span><br><span class="line">        Singleton::s_pInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="keyword">return</span> Singleton::s_pInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>çœ‹ä¼¼å®Œç¾ï¼Œå´æœ¨æœ‰è€ƒè™‘å¤šçº¿ç¨‹ä¸‹åŒæ—¶æ‰§è¡Œ <code>if (nullptr == Singleton::s_pInstance)</code> æƒ…å†µï¼ŒåŠ é”åŠ é”â€¦â€¦<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨window APIæ“æ§é”</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LockBase</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    LockBase()</span><br><span class="line">    &#123;</span><br><span class="line">        ::InitializeCriticalSection(&amp;cs);</span><br><span class="line">    &#125;</span><br><span class="line">    ~LockBase()</span><br><span class="line">    &#123;</span><br><span class="line">        ::DeleteCriticalSection(&amp;cs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ::EnterCriticalSection(&amp;cs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ::LeaveCriticalSection(&amp;cs);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    CRITICAL_SECTION cs;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~Singleton();</span><br><span class="line">    <span class="keyword">static</span> Singleton* s_pInstance;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    <span class="comment">// other members......</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::s_pInstance = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">Singleton::Singleton() &#123;&#125;</span><br><span class="line"></span><br><span class="line">Singleton::~Singleton()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> != Singleton::s_pInstance)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> Singleton::s_pInstance;</span><br><span class="line">        Singleton::s_pInstance = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::getInstance()</span><br><span class="line">&#123;</span><br><span class="line">    LockBase lockBase;</span><br><span class="line">    lockBase.lock();</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == Singleton::s_pInstance)</span><br><span class="line">        Singleton::s_pInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    lockBase.unlock();</span><br><span class="line">    <span class="keyword">return</span> Singleton::s_pInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>very nice ! ğŸ˜€ ç­‰ç­‰ï¼å…¶å®è¿™ä¸ªé”çš„èŒƒå›´æœ‰ç‚¹å¤§äº†ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡ä¼˜åŒ–ï¼Œç¼©å°èŒƒå›´<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Singleton* Singleton::getInstance()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> == Singleton::s_pInstance)</span><br><span class="line">    &#123;</span><br><span class="line">        LockBase lockBase;</span><br><span class="line">        lockBase.lock();</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">nullptr</span> == Singleton::s_pInstance)</span><br><span class="line">            Singleton::s_pInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        lockBase.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Singleton::s_pInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸ä½†ç¼©å°èŒƒå›´ï¼Œè€Œä¸”æå‡æ•ˆç‡ï¼Œæ„Ÿè§‰å¾ˆæ£’æ£’(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ å¯¹ç…§ä¸‹ä¹¦æœ¬<br>æœ‰æœ¨æœ‰æé”™ï¼ç»“æœä¹¦ä¸Šè¯´è¿˜æœ‰æ›´åŠ ä¼˜ç§€çš„è§£æ³•=_=</p><h2 id="åŠ›èè§£æ³•ä¸€ï¼šåˆ©ç”¨é™æ€æ„é€ å‡½æ•°"><a href="#åŠ›èè§£æ³•ä¸€ï¼šåˆ©ç”¨é™æ€æ„é€ å‡½æ•°" class="headerlink" title="åŠ›èè§£æ³•ä¸€ï¼šåˆ©ç”¨é™æ€æ„é€ å‡½æ•°"></a>åŠ›èè§£æ³•ä¸€ï¼šåˆ©ç”¨é™æ€æ„é€ å‡½æ•°</h2><p>é™æ€æ„é€ å‡½æ•°ï¼šå®šä¹‰ç±»æ—¶ä»…è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡çš„å‡½æ•°<br>å¯èƒ½è¦è®©æ‚¨å¤±æœ›äº†ï¼Œä¹¦ä¸­ä½¿ç”¨C#ï¼Œè€ŒC++æ²¡æœ‰é™æ€æ„é€ å‡½æ•°ï¼ğŸ˜‚<br>å…ˆçœ‹çœ‹ä¹¦ä¸­C#ç¥çº§ä»£ç <br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// other members......</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>å†çœ‹çœ‹ <code>C++</code> æ¨¡æ‹Ÿä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~Singleton();</span><br><span class="line">    <span class="keyword">static</span> Singleton* s_pInstance;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    <span class="comment">// other members......</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::s_pInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::getInstance()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Singleton::s_pInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶å®æ˜¯åœ¨å…¨å±€åŸŸä¸­ç›´æ¥è®¾å®šï¼Œç•¥æ˜¾ç‰µå¼ºğŸ˜</p><h2 id="åŠ›èè§£æ³•äºŒï¼šå®ç°æŒ‰éœ€åˆ›å»ºå®ä¾‹"><a href="#åŠ›èè§£æ³•äºŒï¼šå®ç°æŒ‰éœ€åˆ›å»ºå®ä¾‹" class="headerlink" title="åŠ›èè§£æ³•äºŒï¼šå®ç°æŒ‰éœ€åˆ›å»ºå®ä¾‹"></a>åŠ›èè§£æ³•äºŒï¼šå®ç°æŒ‰éœ€åˆ›å»ºå®ä¾‹</h2><p>è§£æ³•ä¸€ä¸­è¿‡æ—©åˆ›å»ºå®ä¾‹å ç”¨å†…å­˜ï¼Œæ‰€ä»¥å¯ç”¨é«˜çº§è¯­è¨€ä¸­ <strong>ç±»ä»…åœ¨ä½¿ç”¨æ—¶è½½å…¥</strong> çš„ç‰¹æ€§æ”¹è¿›ä»£ç <br>C++æ— æ³•å®ç°æ­¤æ–¹æ³•ï¼Œä»¥ä¸‹ä¾æ—§æ˜¯ä¹¦ä¸­C#ç¥çº§ä»£ç <br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Nested.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Nested</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// internalè¡¨ç¤ºè¯¥å˜é‡ä»…å¯åœ¨åŒé¡¹ç›®å†…è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">internal</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// other members......</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h1 id="æœ¬é¢˜æ‰©å±•"><a href="#æœ¬é¢˜æ‰©å±•" class="headerlink" title="æœ¬é¢˜æ‰©å±•"></a>æœ¬é¢˜æ‰©å±•</h1><p>å®ç°å¯ç»§æ‰¿å•ä¾‹ï¼Œæ´¾ç”Ÿç±»éƒ½åªèƒ½äº§ç”Ÿä¸€ä¸ªå®ä¾‹<br>å¯ä»¥åœ¨å•ä¾‹ç±»ä¸­ä½¿ç”¨æŒ‡é’ˆæ•°ç»„åˆ¤æ–­å¯¹åº”å­ç±»æ ‡è®°æ˜¯å¦å·²å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ç›´æ¥è¿”å›ï¼Œåä¹‹åˆ›å»ºå­ç±»ï¼Œåº”åŠ é”å®ç°</p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> å•ä¾‹ </tag>
            
            <tag> Singleton </tag>
            
            <tag> æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰‘æŒ‡Offer-é¢˜1-èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°</title>
      <link href="/2018/03/24/%E5%89%91%E6%8C%87Offer-%E9%A2%981-%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6%E5%87%BD%E6%95%B0/"/>
      <url>/2018/03/24/%E5%89%91%E6%8C%87Offer-%E9%A2%981-%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6%E5%87%BD%E6%95%B0/</url>
      <content type="html"><![CDATA[<h1 id="é¢˜ç›®ï¼šèµ‹å€¼è¿ç®—ç¬¦å‡½æ•°"><a href="#é¢˜ç›®ï¼šèµ‹å€¼è¿ç®—ç¬¦å‡½æ•°" class="headerlink" title="é¢˜ç›®ï¼šèµ‹å€¼è¿ç®—ç¬¦å‡½æ•°"></a>é¢˜ç›®ï¼šèµ‹å€¼è¿ç®—ç¬¦å‡½æ•°</h1><p>å¦‚ä¸‹ä¸ºç±»å‹CMyStringçš„å£°æ˜ï¼Œè¯·ä¸ºè¯¥ç±»å‹æ·»åŠ èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CMyString</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    CMyString(<span class="keyword">char</span>* pData=<span class="literal">NULL</span>);</span><br><span class="line">    CMyString(<span class="keyword">const</span> CMyString&amp; str);</span><br><span class="line">    ~CMyString(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> *m_pData;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>é¢˜ç›®è€ƒå¯Ÿèµ‹å€¼è¿ç®—ç¬¦(=)å‡½æ•°å£°æ˜ï¼Œå¯¹äº<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a;</span><br><span class="line"><span class="comment">// è°ƒç”¨èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°</span></span><br><span class="line">a = <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p><p>è€ƒè™‘å½¢å¦‚ <code>a = 1</code> ï¼Œè§† <code>a</code> ä¸º <code>int</code> å¯¹è±¡åˆ™ä»£ç æ”¹ä¸º <code>a.=(1)</code>ï¼Œå…¶ä¸­ <code>=</code> ä¸ºæ–¹æ³•åï¼Œ <code>1</code> ä¸ºå®å‚ï¼Œç”±æ­¤æ„é€ å‡ºå‡½æ•°å£°æ˜é›å½¢<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿”å›å€¼ =(<span class="keyword">int</span> num);</span><br></pre></td></tr></table></figure></p><p>å› ä¸º <code>printf(&quot;%d&quot;, a = 1)</code> è¾“å‡ºå€¼ä¸ºè¿ç®—ç»“æœï¼Œæ•…è€Œ<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> =(<span class="keyword">int</span> num);</span><br></pre></td></tr></table></figure></p><p>ç”±äºè¿ç®—ç¬¦å‡½æ•°ç‰¹æ®Šæ€§ï¼Œå‡½æ•°ååŠ ä¸Šå…³é”®è¯operator<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">operator</span>=(<span class="keyword">int</span> num);</span><br></pre></td></tr></table></figure></p><p>è€ƒè™‘å‡½æ•°ä»…å¯¹å®å‚å–å€¼ï¼Œæ•…å‚æ•°å¯å¸¸ç±»å‹(const)å¼•ç”¨ä¼ é€’ï¼Œä¿®æ”¹å£°æ˜<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">operator</span>= (<span class="keyword">const</span> <span class="keyword">int</span>&amp; num);</span><br></pre></td></tr></table></figure></p><p>è€ƒè™‘ä»¥ä¸‹ä»»æ„ä¸€ç§æƒ…å†µ</p><ul><li><code>(a = 1) = 2</code> è¿è¡Œé€šè¿‡è¯´æ˜ <code>(a = 1)</code> è¿”å›å€¼ä¸ºå¯ä¿®æ”¹çš„å·¦å€¼å³ <code>a</code></li><li><code>cout &lt;&lt; ... &lt;&lt; ...</code> ä¸­çš„è¿ç®—ç¬¦å‡½æ•° <code>&lt;&lt;</code> å¯æµå¼ç¼–å†™ï¼Œè¯´æ˜ <code>cout &lt;&lt; ...</code> è¿”å›å€¼ä¸ºå¯ä¿®æ”¹å·¦å€¼å³<code>std::out&amp;</code></li></ul><p>æ•…è¿”å›å€¼éœ€å¼•ç”¨ä¼ é€’ï¼Œä¿®æ”¹å£°æ˜<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>&amp; <span class="keyword">operator</span>= (<span class="keyword">int</span>&amp; num);</span><br></pre></td></tr></table></figure></p><p>å¥—ç”¨è¿›ç±» <code>CMyString</code><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CMyString</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    CMyString(<span class="keyword">char</span>* pData=<span class="literal">NULL</span>);</span><br><span class="line">    CMyString(<span class="keyword">const</span> CMyString&amp; str);</span><br><span class="line">    ~CMyString(<span class="keyword">void</span>);</span><br><span class="line">    CMyString&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> CMyString&amp; str);</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> *m_pData;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>é¡ºä¾¿æŠŠå®šä¹‰å†™äº†(åº”è¯¥æ˜¯â€æ·±æ‹·è´â€èµ‹å€¼)<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CMyString&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> CMyString&amp; str)</span><br><span class="line">&#123;</span><br><span class="line">    m_pData = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(str.m_pData) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(m_pData, str.m_pData);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯¹ç…§ä¹¦æœ¬å‘ç°è‡ªå·±è¿˜æ˜¯å¤ªå«©äº†ï¼Œæ²¡æœ‰å¯¹å„ä¸ªå˜é‡è¿›è¡Œåˆ¤æ–­ï¼Œå®‰å…¨ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CMyString&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> CMyString&amp; str)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(&amp;str == <span class="keyword">this</span>)</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">delete</span>[] m_pData;</span><br><span class="line">    m_pData = <span class="literal">nullptr</span>;</span><br><span class="line">    m_pData = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(str.m_pData) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(m_pData, str.m_pData);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶è€Œï¼Œäº‹æƒ…å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•â€¦â€¦ï¼Œä¹¦ä¸­ç¥çº§ä»£ç <br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CMyString&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> CMyString&amp; str)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (&amp;str != <span class="keyword">this</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// (ä»£ç å¼‚å¸¸å®‰å…¨æ€§)å°†newæ“ä½œç½®äºæ„é€ å‡½æ•°ä¸­ï¼Œå¯ä¿æŠ¤å½“å‰m_pDataæ•°æ®å…å—delete</span></span><br><span class="line">        CMyString strTemp(str);</span><br><span class="line">        <span class="keyword">char</span> *pTemp = strTemp.m_pData;</span><br><span class="line">        strTemp.m_pData = <span class="keyword">this</span>-&gt;m_pData;</span><br><span class="line">        <span class="keyword">this</span>-&gt;m_pData = pTemp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> å‰‘æŒ‡Offer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰‘æŒ‡Offer </tag>
            
            <tag> èµ‹å€¼ </tag>
            
            <tag> è¿ç®—ç¬¦ </tag>
            
            <tag> å‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¡ç®—æœºå›¾å½¢å­¦-ç›´çº¿</title>
      <link href="/2018/03/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6-%E7%9B%B4%E7%BA%BF/"/>
      <url>/2018/03/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6-%E7%9B%B4%E7%BA%BF/</url>
      <content type="html"><![CDATA[<h1 id="ç›´çº¿ç»˜åˆ¶ç®—æ³•"><a href="#ç›´çº¿ç»˜åˆ¶ç®—æ³•" class="headerlink" title="ç›´çº¿ç»˜åˆ¶ç®—æ³•"></a>ç›´çº¿ç»˜åˆ¶ç®—æ³•</h1><p><em>æœ¬æ–‡ä»‹ç»å†…å®¹å½’å±è®¡ç®—æœºå›¾å½¢å­¦èŒƒç•´ï¼ŒåŸºäºäºŒç»´å¹³é¢ç›´è§’åæ ‡ç³»ç»˜åˆ¶</em></p><hr><h2 id="ä¸ºä½•ç ”ç©¶ç›´çº¿ç»˜åˆ¶ç®—æ³•ï¼Ÿ"><a href="#ä¸ºä½•ç ”ç©¶ç›´çº¿ç»˜åˆ¶ç®—æ³•ï¼Ÿ" class="headerlink" title="ä¸ºä½•ç ”ç©¶ç›´çº¿ç»˜åˆ¶ç®—æ³•ï¼Ÿ"></a>ä¸ºä½•ç ”ç©¶ç›´çº¿ç»˜åˆ¶ç®—æ³•ï¼Ÿ</h2><p>ç°å®ä¸–ç•Œç»˜åˆ¶ç›´çº¿(æ®µ)åªé ç›´å°ºå’Œç¬”ï¼Œè€Œè®¡ç®—æœºæ˜¾ç¤ºå›¾å½¢éœ€ç‚¹äº®å±å¹•åƒç´ ç‚¹â€”â€”ç»˜ç‚¹æˆçº¿(æ®µ)</p><p>å¦‚åŒä¸€è¿ä¸²è‹±æ–‡å¥ç‚¹ç»˜åˆ¶è€Œæˆçš„åˆ†å‰²çº¿ï¼Œæ•ˆæœå¦‚ä¸‹ï¼ˆ<em>ç¦»æ•£åŒ–çš„è¿‘ä¼¼è¡¨ç°</em>ï¼Œå‡ä½¿æ”¾å¤§é¡µé¢ä¼šå‡ºç°æ˜æ˜¾é—´éš™ï¼‰</p><p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.</p><p>å¯æƒœç›´çº¿ä¸åªæ˜¯æ°´å¹³çº¿ï¼Œè¿˜åŒ…æ‹¬æ–œçº¿å–ï¼ï¼ˆQAQï¼‰</p><p>ä¸ºæ­¤ï¼Œå›¾å½¢å­¦è€…è‡´åŠ›å¯»æ‰¾é«˜æ•ˆç»˜ç‚¹ç®—æ³• (\æŒå£°)ã€‚æˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹ä¸‰ç§ç›´çº¿ç»˜åˆ¶ç®—æ³•ï¼š</p><ol><li>DDAç®—æ³•<ul><li>ç®—æ³•æ€æƒ³<strong>ç®€å•</strong></li><li>ç›´çº¿å¹³æ»‘æ€§å·®ï¼Œæ•ˆç‡è¾ƒé«˜</li></ul></li><li>é€ç‚¹æ¯”è¾ƒç®—æ³•ï¼ˆäº¦ç§°æ’è¡¥æ³•ï¼‰<ul><li><strong>å·¥ä¸šå¸¸ç”¨</strong>ç®—æ³•</li><li>ç›´çº¿å¹³æ»‘æ€§å¥½ï¼Œæ•ˆç‡è¾ƒä½</li></ul></li><li>Bresehamç®—æ³•<ul><li><strong>é«˜æ•ˆ</strong></li><li>å…¼å¹¶DDAç®—æ³•ä¸æ’è¡¥æ³•æ€æƒ³</li></ul></li></ol><h2 id="DDAï¼ˆDIgital-differential-analyzerï¼‰ç®—æ³•"><a href="#DDAï¼ˆDIgital-differential-analyzerï¼‰ç®—æ³•" class="headerlink" title="DDAï¼ˆDIgital differential analyzerï¼‰ç®—æ³•"></a>DDAï¼ˆDIgital differential analyzerï¼‰ç®—æ³•</h2><p>èªæ˜çš„æ•°å­¦å®¶æ—©å°†ç›´çº¿ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºå‡ºæ¥ <strong>y = k Â· x + b</strong></p><p>æ±‚è§£ä¸¤ä¸ªæœªçŸ¥é‡ <code>kã€b</code> æˆ‘ä»¬åªéœ€yçŸ¥æ™“ä¸¤ç»„ç‚¹æ•°æ®å³å¯ï¼ˆä¸¤ç‚¹ç»˜åˆ¶ä¸€æ¡ç›´çº¿ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨çº¿æ®µçš„èµ·ç‚¹å’Œç»ˆç‚¹ä»£å…¥å…¬å¼å§ã€‚ï¼ˆ^_^ï¼‰</p><p><code>èµ·ç‚¹p0(0, 0) ç»ˆç‚¹p6(6, 4) -&gt; k = 1.5ï¼Œb = 0</code>ã€‚è§‚å¯Ÿå‘ç°å½“ <code>x2 = x1 + 1</code> æ—¶ï¼Œ<code>y2 = y1 + k</code></p><p>è®¡ç®—æœºåƒç´ å•ä½é•¿åº¦ä¸º1ï¼ˆå³åƒç´ ç‚¹æ•°æ®å‡ä¸ºæ•´æ•°ï¼‰ï¼Œæˆ‘ä»¬å‡‘å·§å°† y2 å–æ•´æˆ y2â€™ å³å¾—éœ€ç‚¹äº®åƒç´ ç‚¹ä½ç½® <code>(x2, y2&#39;)</code></p><p>ä¾æ­¤ç±»æ¨ï¼Œ<code>x3 = x2 + 1ï¼Œy3 = y2 + kï¼Œy3&#39; = å–æ•´y3</code> â€¦â€¦</p><p>å¤§åŠŸå‘Šæˆï¼Ÿå“¦ä¸ï¼æˆ‘ä»¬è¿˜èƒ½ä¼˜åŒ–ä¸€ä¸‹æ•ˆç‡</p><ul><li><p>å½“ç›´çº¿æ–œç‡ <code>k &lt; 1</code> æ—¶ï¼Œæˆ‘ä»¬ä»¥xä¸ºä¸»ï¼Œé‡‡ç”¨ <code>x2 = x1 + 1</code> çš„æ­¥è¿›æ–¹å¼ï¼ŒåŠ å¿«æ°´å¹³æ–¹å‘å»¶ä¼¸é€Ÿåº¦</p></li><li><p>å½“ç›´çº¿æ–œç‡ <code>k &gt; 1</code> æ—¶ï¼Œæˆ‘ä»¬ä»¥yä¸ºä¸»ï¼Œé‡‡ç”¨ <code>y2 = y1 + 1</code> çš„æ­¥è¿›æ–¹å¼ï¼ŒåŠ å¿«å‚ç›´æ–¹å‘å»¶ä¼¸é€Ÿåº¦</p></li></ul><p><strong><em>å–æ•´æ­¥éª¤éœ€è¦å¯¹å°æ•°å››èˆäº”å…¥ï¼Œå¯¹æ•ˆç‡ç•¥æœ‰å½±å“</em></strong></p><p>æœ€ç»ˆä»£ç å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ä½¿ç”¨openGLçš„glutåº“</span></span><br><span class="line"><span class="comment">#include &lt;gl\glut.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;math.h&gt;</span></span><br><span class="line"><span class="comment">x1 = 0ï¼Œy1 = 0</span></span><br><span class="line"><span class="comment">x2 = 6ï¼Œy2 = 4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawLineDDA</span><span class="params">(GLint x1, GLint y1, GLint x2, GLint y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);<span class="comment">//ç½®é¢œè‰²ä¸ºçº¢</span></span><br><span class="line"><span class="keyword">int</span> dx = x2 - x1;</span><br><span class="line"><span class="keyword">int</span> dy = y2 - y1;</span><br><span class="line">dx = <span class="built_in">abs</span>(dx);</span><br><span class="line">dy = <span class="built_in">abs</span>(dy);</span><br><span class="line"><span class="keyword">int</span> step = dx &gt; dy ? dx : dy;<span class="comment">//åˆ¤æ–­kä¸1çš„å…³ç³»ï¼Œè‹¥dxå¤§ï¼Œæ°´å¹³æ–¹å‘å»¶ä¼¸ä¸ºä¸»ï¼›è‹¥dyå¤§ï¼Œå‚ç›´æ–¹å‘å»¶ä¼¸ä¸ºä¸»</span></span><br><span class="line"><span class="keyword">double</span> xin = dx / step;<span class="comment">//xè½´æ­¥é•¿</span></span><br><span class="line"><span class="keyword">double</span> yin = dy / (<span class="keyword">double</span>)step;<span class="comment">//yè½´æ­¥é•¿</span></span><br><span class="line"><span class="keyword">double</span> x = x1;</span><br><span class="line"><span class="keyword">double</span> y = y1;</span><br><span class="line">glBegin(GL_POINTS);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= step; i++)</span><br><span class="line">&#123;</span><br><span class="line">glVertex2f(x / <span class="number">10.0</span>, <span class="keyword">int</span>(y + <span class="number">0.5</span>) / <span class="number">10.0</span>);<span class="comment">//int(y + 0.5)å°†yå€¼å››èˆäº”å…¥ï¼Œç»˜äºæ ‡å‡†åŒ–åæ ‡ç³»ï¼Œæ•…é™¤ä»¥10.0</span></span><br><span class="line">x = x + xin;</span><br><span class="line">y = y + yin;</span><br><span class="line">&#125;</span><br><span class="line">glEnd();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»˜åˆ¶ç»“æœå¦‚å›¾ï¼ˆè¡¥ä¸Šé»‘è‰²ç½‘æ ¼ï¼Œè“çº¿ä¸ºé¢„æœŸæ•ˆæœï¼Œç»¿ç‚¹ä¸ºå¯ç‚¹äº®åƒç´ ç‚¹ï¼Œç™½è‰²éƒ¨åˆ†ä»£è¡¨åƒç´ ç©ºéš™ï¼ˆæ”¾å¤§æ•ˆæœï¼‰ï¼‰</p><p><img src="https://raw.githubusercontent.com/cz111000/DrawLine/master/DDA.PNG" alt="DDAç®—æ³•æ•ˆæœå›¾"></p><h2 id="é€ç‚¹æ¯”è¾ƒç®—æ³•ï¼ˆæ’è¡¥æ³•ï¼‰"><a href="#é€ç‚¹æ¯”è¾ƒç®—æ³•ï¼ˆæ’è¡¥æ³•ï¼‰" class="headerlink" title="é€ç‚¹æ¯”è¾ƒç®—æ³•ï¼ˆæ’è¡¥æ³•ï¼‰"></a>é€ç‚¹æ¯”è¾ƒç®—æ³•ï¼ˆæ’è¡¥æ³•ï¼‰</h2><p>æ­¤ç®—æ³•ä»¥åƒç´ ç‚¹ä¸ºä¸»ï¼Œ<strong>ç¬¬ä¸€è±¡é™</strong>å‰æä¸‹è€ƒè™‘<strong>å³æ–¹å‘</strong>å’Œ<strong>ä¸Šæ–¹å‘</strong>åƒç´ ç‚¹ä¸ç›´çº¿ä½ç½®ï¼ŒäºŒé€‰ä¸€ç‚¹äº®</p><p>åŒæ ·å– <code>èµ·ç‚¹p0(0, 0) ç»ˆç‚¹pn(6, 4)</code> ä»£å…¥å…¬å¼ <strong>y = k Â· x + b</strong> å¾— <code>k = 1.5ï¼Œb = 0</code></p><p>å½“åƒç´ ç‚¹ <code>p</code> åœ¨ç›´çº¿ä¸Šæ–¹æ—¶ <code>yp / xp &gt; (y6 - y0) / (x6 - x0)</code>ï¼Œå³ <code>yp * (x6 - x0) - (y6 - y0) * xp &gt; 0</code></p><p>å½“åƒç´ ç‚¹ <code>p</code> åœ¨ç›´çº¿ä¸­æ—¶ <code>yp / xp = (y6 - y0) / (x6 - x0)</code>ï¼Œå³ <code>yp * (x6 - x0) - (y6 - y0) * xp = 0</code></p><p>å½“åƒç´ ç‚¹ <code>p</code> åœ¨ç›´çº¿ä¸‹æ–¹æ—¶ <code>yp / xp &lt; (y6 - y0) / (x6 - x0)</code>ï¼Œå³ <code>yp * (x6 - x0) - (y6 - y0) * xp &lt; 0</code></p><p>æŠŠ <code>yp * (x6 - x0) - (y6 - y0) * xp</code> è®°ä¸º <code>F</code> åˆ™ <code>F = yp * (x6 - x0) - (y6 - y0) * xp</code> å³ä¸ºåå·®å…¬å¼ï¼Œä¸”èµ·ç‚¹åå·®åº”ä¸º <code>F0 = 0</code></p><ol><li><p>å½“ <code>F &gt; 0</code> æ—¶ï¼Œ<code>x2 = x1 + 1</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰</p></li><li><p>å½“ <code>F = 0</code> æ—¶ï¼Œ<code>x2 = x1 + 1</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰æˆ– <code>y2 = y1 + 1</code>ï¼ˆå³ç‚¹äº®ä¸Šæ–¹åƒç´ ç‚¹ï¼‰</p></li><li><p>å½“ <code>F &lt; 0</code> æ—¶ï¼Œ<code>y2 = y1 + 1</code>ï¼ˆå³ç‚¹äº®ä¸Šæ–¹åƒç´ ç‚¹ï¼‰</p></li></ol><p>ä½†é€æ¬¡æ±‚è§£å«æœ‰ä¹˜æ³•çš„åå·®å…¬å¼ä¸¥é‡å½±å“æ•ˆç‡<del>æœ‰æœ¨æœ‰å•Š</del>ï¼Œç®€åŒ–ä¸ºä¸‹å¼ï¼ˆå½“ <code>F = 0</code> æ—¶å– <code>x2 = x1 + 1</code>ï¼‰</p><ul><li><p>å½“ <code>F1 &gt;= 0</code> æ—¶ <code>F2 = yp * (x6 - x0) - (y6 - y0) * (xp + 1) = F1 - (y6 - y0)</code></p></li><li><p>å½“ <code>F1 &lt; 0</code> æ—¶ <code>F2 = (yp + 1) * (x6 - x0) - (y6 - y0) * xp = F1 + (x6 - x0)</code></p></li></ul><p><strong><em>å› ä¸ºå¯èƒ½ç‚¹äº®ä¸Šæ–¹åƒç´ ç‚¹ï¼Œæ„å‘³åŒä¸€yå€¼ä¸‹ä¸åªç‚¹äº®ä¸€ç‚¹åƒç´ ï¼Œæ•…æ•ˆç‡è¾ƒä½</em></strong></p><p>åŒç†å¯å¾—ç¬¬äºŒè±¡é™ã€ç¬¬ä¸‰è±¡é™ã€ç¬¬å››è±¡é™æ±‚æ³•ï¼Œè¯·è¯»è€…è‡ªè¡Œè®¡ç®—ï¼Œä¸å†èµ˜è¿°ï¼ˆå·ä¸ªæ‡’ \æ»‘ç¨½ï¼‰</p><p>æœ€ç»ˆä»£ç å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ä½¿ç”¨openGLçš„glutåº“</span></span><br><span class="line"><span class="comment">#include &lt;gl\glut.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;math.h&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawLineInsert</span><span class="params">(GLint x1, GLint y1, GLint x2, GLint y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);<span class="comment">//ç½®é¢œè‰²ä¸ºçº¢</span></span><br><span class="line"><span class="keyword">int</span> dx = x2 - x1;</span><br><span class="line"><span class="keyword">int</span> dy = y2 - y1;</span><br><span class="line"><span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> x = x1;</span><br><span class="line"><span class="keyword">double</span> y = y1;</span><br><span class="line">glBegin(GL_POINTS);</span><br><span class="line"><span class="keyword">while</span> (x &lt; x2 + <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">glVertex2f(x / <span class="number">10.0</span>, y / <span class="number">10.0</span>);<span class="comment">//ç»˜åˆ¶äºæ ‡å‡†åŒ–åæ ‡ç³»ï¼Œæ•…é™¤ä»¥10.0</span></span><br><span class="line"><span class="keyword">if</span> (f &gt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">x = x + <span class="number">1</span>;</span><br><span class="line">f = f - dy;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">y = y + <span class="number">1</span>;</span><br><span class="line">f = f + dx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">glEnd();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»˜åˆ¶ç»“æœå¦‚å›¾ï¼ˆè¡¥ä¸Šé»‘è‰²ç½‘æ ¼ï¼Œè“çº¿ä¸ºé¢„æœŸæ•ˆæœï¼Œç»¿ç‚¹ä¸ºå¯ç‚¹äº®åƒç´ ç‚¹ï¼Œç™½è‰²éƒ¨åˆ†ä»£è¡¨åƒç´ ç©ºéš™ï¼ˆæ”¾å¤§æ•ˆæœï¼‰ï¼‰</p><p><img src="https://raw.githubusercontent.com/cz111000/DrawLine/master/Insert.PNG" alt="æ’è¡¥æ³•æ•ˆæœå›¾"></p><h2 id="Bresenhamç®—æ³•"><a href="#Bresenhamç®—æ³•" class="headerlink" title="Bresenhamç®—æ³•"></a>Bresenhamç®—æ³•</h2><p>æ­¤ç®—æ³•åŸºäºDDAç®—æ³•è¿›è¡Œé€ç‚¹æ¯”è¾ƒæ”¹è¿›è€Œæ¥ï¼ŒåŒé€ç‚¹æ¯”è¾ƒæ³•ä»¥åƒç´ ç‚¹ä¸ºä¸»ï¼Œè€ƒè™‘<strong>å³æ–¹å‘</strong>å’Œ<strong>å³ä¸Šæ–¹å‘</strong>åƒç´ ç‚¹ä¸ç›´çº¿ä½ç½®ï¼ŒäºŒé€‰ä¸€ç‚¹äº®</p><p>æ— è€»åœ°ç›—ä¸ªå›¾</p><p><img src="https://camo.githubusercontent.com/c5669fe7d006c897cf652afa9a06f9ed9e773553/68747470733a2f2f696d6773612e62616964752e636f6d2f6261696b652f63302533446261696b6538302532433525324335253243383025324332362f7369676e3d36326235313930343938353034666332623635326238353738346234386337342f643031333733663038323032356161666539393465626337663865646162363430333466316131332e6a7067" alt="BresenhamåŸç†å›¾"></p><p>åŒæ ·å– <code>èµ·ç‚¹p0(0, 0) ç»ˆç‚¹p6(6, 4)</code> ä»£å…¥å…¬å¼ <strong>y = k Â· x + b</strong> å¾— <code>k = 1.5ï¼Œb = 0</code></p><p>å­˜åœ¨è§„å¾‹ <code>y2 = y1 + k</code>ï¼Œè‹¥ <code>y1</code> åä¸Šåˆ™ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼Œè‹¥ <code>y2</code> åä¸‹åˆ™ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼Œå³æ¯”è¾ƒäº¤ç‚¹ <code>y2</code> ä¸åƒç´ é—´è·ä¸­ç‚¹ä½ç½®</p><p>è®° <code>d = (y2 - y1) / (x2 - x1) + (y2 - y1) / (x2 - x1) - â”” (y2 - y1) / (x2 - x1) + (y1 - y0) / (x1 - x0) â”˜</code> ï¼Œï¼ˆ<code>â””xâ”˜</code> è¡¨ç¤ºå–ä¸‹æ•´ï¼Œå¦‚ <code>â””1.2â”˜ = 1</code>ï¼›å‡å»å–ä¸‹æ•´å€¼æ˜¯ä¸ºä¿è¯ <code>d âˆˆ [0, 1]</code>ï¼‰åˆ™</p><p>å½“ <code>d &gt; 0.5</code> æ—¶ï¼Œ<code>x2 = x1 + 1ï¼Œy2 = y1 + 1</code>ï¼ˆå³ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼‰</p><p>å½“ <code>d = 0.5</code> æ—¶ï¼Œ<code>x2 = x1 + 1ï¼Œy2 = y1 + 1</code>ï¼ˆå³ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼‰æˆ– <code>x2 = x1 + 1</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰</p><p>å½“ <code>d &lt; 0.5</code> æ—¶ï¼Œ<code>x2 = x1 + 1</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰</p><p>è¿›ä¸€æ­¥è®¾ <code>e = d - 0.5</code> åˆ™</p><p>å½“ <code>e &gt; 0</code> æ—¶ï¼Œ<code>x2 = x1 + 1ï¼Œy2 = y1 + 1</code>ï¼ˆå³ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼‰</p><p>å½“ <code>e = 0</code> æ—¶ï¼Œ<code>x2 = x1 + 1ï¼Œy2 = y1 + 1</code>ï¼ˆå³ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼‰æˆ– <code>x2 = x1 + 1</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰</p><p>å½“ <code>e &lt; 0</code> æ—¶ï¼Œ<code>x2 = x1 + 1</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰</p><p>è‡³æ­¤ç®—æ³•æ¼”å˜ä¸ºåˆ¤æ–­ <code>e</code> çš„æ­£è´Ÿå·ï¼Œæ—¢ç„¶å¦‚æ­¤æˆ‘ä»¬å¯å°†ç®—å¼è½¬ä¸ºæ•´æ•°åŠ å‡å½¢å¼é¿å…é™¤æ³•æé«˜æ•ˆç‡</p><p><em>`e = (2d - 1) </em> (x2 - x1) <em> â€¦â€¦ </em> (x1 - x0) = 2 <em> (y2 - y1) </em> â€¦â€¦ <em> (x1 - x0) + â€¦â€¦ + (y1 - y0) </em> â€¦â€¦ <em> (x2 - x1) - 2 </em> â”” (y2 - y1) / (x2 - x1) + â€¦â€¦ + (y1 - y0) / (x1 - x0) â”˜ <em> (x2 - x1) </em> â€¦â€¦ <em> (x1 - x0)  - 2 </em> â”” â€¦â€¦ + (y1 - y0) / (x1 - x0) â”˜ <em> (x2 - x1) </em> â€¦â€¦ <em> (x1 - x0) - (x2 - x1) </em> â€¦â€¦ <em> (x1 - x0)`</em></p><p>å¥½å®¶ä¼™ï¼ŒåŠ³èµ„è¿˜æ˜¯åšæŒæ‰“ç²—æ¥äº†ï¼ˆ= =ï¼‰</p><p>çœ‹ä¼¼æœ‰è§„å¾‹ï¼Œé‡‡å–æ•°å­¦å½’çº³æ³•</p><p>è®° <code>e1 = (2d1 - 1) * (x1 - x0) = 2 * (y1 - y0) - 2 * â”” (y1 - y0) / (x1 - x0) â”˜ * (x1 - x0) - (x1 - x0)</code></p><p>è®° <code>e2 = (2d2 - 1) * (x2 - x1) * (x1 - x0) = 2 * (y2 - y1) * (x1 - x0) + 2 * (y1 - y0) * (x2 - x1) - 2 * â”” (y2 - y1) / (x2 - x1) + (y1 - y0) / (x1 - x0) â”˜ * (x2 - x1) * (x1 - x0) - 2 * â”” (y1 - y0) / (x1 - x0) â”˜ * (x2 - x1) * (x1 - x0) - (x2 - x1) * (x1 - x0)</code></p><p>å–ä¸‹æ•´é‡‡ç”¨åˆ†æƒ…å†µè®¨è®ºï¼ˆå½“ <code>d = 0.5</code> æ—¶ï¼Œ<code>x2 = x1 + 1</code>ï¼‰</p><p>å½“ <code>d2 &lt; 1</code> æ—¶</p><p><code>e1 = (2d1 - 1) * (x1 - x0) = 2 * (y1 - y0) - (x1 - x0)</code></p><p><code>e2 = (2d2 - 1) * (x2 - x1) * (x1 - x0) = 2 * (y2 - y1) * (x1 - x0) + 2 * (y1 - y0) * (x2 - x1) - (x2 - x1) * (x1 - x0)</code></p><p>å³</p><p><code>e2 = e1 * (x2 - x1) + 2 * (y2 - y1) * (x1 - x0)</code></p><p>å½“ <code>d2 &gt; 1</code> æˆ– <code>d2 = 1</code> æ—¶</p><p><code>e1 = (2d1 - 1) * (x1 - x0) = 2 * (y1 - y0) - (x1 - x0)</code></p><p><code>e2 = (2(d2 - 1) - 1) * (x2 - x1) * (x1 - x0) = 2 * (y2 - y1) * (x1 - x0) + 2 * (y1 - y0) * (x2 - x1) - (x2 - x1) * (x1 - x0) - 2 * (x2 - x1) * (x1 - x0)</code></p><p>å³</p><p><code>e2 = e1 * (x2 - x1) + 2 * (y2 - y1) * (x1 - x0) - 2 * (x2 - x1) * (x1 - x0)</code></p><p>å¤§å¯åˆ©ç”¨ç¼–ç¨‹è¯­è¨€ <code>d = d + k</code> ç‰¹æ€§ï¼Œä¸” <code>dx = (x2 - x1) = 1ï¼Œdy = (y2 - y1) = k</code> ä¸ºå›ºå®šå€¼</p><p>å½“ <code>d &lt; 1</code> å³ <code>d - 0.5 &lt; 1 - 0.5 -&gt; 2 * (d - 0.5) &lt; 1</code> -&gt; <code>2 * (d - 0.5) * dx &lt; dx</code> -&gt; <code>e &lt; dx</code> æ—¶</p><p><code>e = e * dx + 2 * dy * dx</code></p><p>å½“ <code>d &gt; 1</code> æˆ– <code>d = 1</code> åŒç†å³ <code>e &gt; dx</code> æˆ– <code>e = dx</code> æ—¶</p><p><code>e = e * dx + 2 * dy * dx - 2 * dx * dx</code></p><p><strong><code>e</code> åˆå§‹å€¼ä¸º <code>e0 = 2 * (0 - 0.5) * (x1 - x0) = -(x1 - x0) = -dx</code></strong></p><p><strong>å½“ <code>e &gt; dx</code> æ—¶ï¼Œ<code>e = e + 2 * dy * dx - 2 * dx * dx</code>ï¼ˆå³ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼‰</strong></p><p><strong>å½“ <code>e = dx</code> æ—¶ï¼Œ<code>e = e + 2 * dy * dx - 2 * dx * dx</code>ï¼ˆå³ç‚¹äº®å³ä¸Šæ–¹åƒç´ ç‚¹ï¼‰</strong></p><p><strong>å½“ <code>e &lt; dx</code> æ—¶ï¼Œ<code>e = e - 2 * dx * dx</code>ï¼ˆå³ç‚¹äº®å³æ–¹åƒç´ ç‚¹ï¼‰</strong></p><p><strong><em>åŒä¸€yå€¼ä¸‹ä»…ç‚¹äº®ä¸€ç‚¹åƒç´ ï¼Œä¸”è®¡ç®—è¿‡ç¨‹å‡ä¸ºåŠ å‡æ³• (ä¸Šå¼ä¹˜æ•°å›ºå®šå€¼)ï¼Œé€‚ç”¨å„è±¡é™æ— éœ€åˆ†ç±»ï¼Œé«˜æ•ˆå¿«æ·</em></strong></p><p>æœ€ç»ˆä»£ç å¦‚ä¸‹<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ä½¿ç”¨openGLçš„glutåº“</span></span><br><span class="line"><span class="comment">#include &lt;gl\glut.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;math.h&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawLineBresenham</span><span class="params">(GLint x1, GLint y1, GLint x2, GLint y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);<span class="comment">//ç½®é¢œè‰²ä¸ºçº¢</span></span><br><span class="line"><span class="keyword">int</span> dx = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">double</span> dy = (y2 - y1) / (<span class="keyword">double</span>)(x2 - x1);</span><br><span class="line"><span class="keyword">double</span> e = -dx;</span><br><span class="line"><span class="keyword">double</span> x = x1;</span><br><span class="line"><span class="keyword">double</span> y = y1;</span><br><span class="line">glBegin(GL_POINTS);</span><br><span class="line"><span class="keyword">while</span> (x &lt; x2 + <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">glVertex2f(x / <span class="number">10.0</span>, y / <span class="number">10.0</span>);<span class="comment">//ç»˜åˆ¶äºæ ‡å‡†åŒ–åæ ‡ç³»ï¼Œæ•…é™¤ä»¥10.0</span></span><br><span class="line">x++;</span><br><span class="line">e = e + <span class="number">2</span> * dy * dx;<span class="comment">//å¯æ¢ä¸ºå•ä¸€å˜é‡æ— éœ€å¤šæ¬¡åšä¹˜æ³•</span></span><br><span class="line"><span class="keyword">if</span> (e &gt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">y++;</span><br><span class="line">e = e - <span class="number">2</span> * dx * dx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">glEnd();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç»˜åˆ¶ç»“æœå¦‚å›¾ï¼ˆè¡¥ä¸Šé»‘è‰²ç½‘æ ¼ï¼Œè“çº¿ä¸ºé¢„æœŸæ•ˆæœï¼Œç»¿ç‚¹ä¸ºå¯ç‚¹äº®åƒç´ ç‚¹ï¼Œç™½è‰²éƒ¨åˆ†ä»£è¡¨åƒç´ ç©ºéš™ï¼ˆæ”¾å¤§æ•ˆæœï¼‰ï¼‰</p><p><img src="https://raw.githubusercontent.com/cz111000/DrawLine/master/Bresenham.PNG" alt="Bresenhamç®—æ³•æ•ˆæœå›¾"></p><hr><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><em><a href="http://baike.baidu.com/item/DDA%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">DDAç®—æ³•_ç™¾åº¦ç™¾ç§‘</a></em></p><p><em><a href="https://wenku.baidu.com/view/7df948146c175f0e7cd1377f.html" target="_blank" rel="noopener">é€ç‚¹æ¯”è¾ƒæ³•ç›´çº¿æ’è¡¥</a></em></p><p><em><a href="https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm" target="_blank" rel="noopener">Bresenhamâ€™s line algorithm - Wikipedia</a></em></p><p><em><a href="http://www.360doc.com/content/13/1220/09/11400509_338596444.shtml" target="_blank" rel="noopener">Bresenhamç›´çº¿ç®—æ³•ä¸ç”»åœ†ç®—æ³•</a></em></p>]]></content>
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾å½¢å­¦ </tag>
            
            <tag> ç›´çº¿ </tag>
            
            <tag> ç»˜åˆ¶ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ’åºç®—æ³•æ€»ç»“(ä¸Š)</title>
      <link href="/2018/03/22/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93(%E4%B8%8A)/"/>
      <url>/2018/03/22/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93(%E4%B8%8A)/</url>
      <content type="html"><![CDATA[<h1 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h1><hr><h2 id="Whatâ€™s-Algorithm"><a href="#Whatâ€™s-Algorithm" class="headerlink" title="Whatâ€™s Algorithm ?"></a>Whatâ€™s Algorithm ?</h2><p>æåŠâ€œ<strong>ç®—æ³•</strong>â€ï¼Œå°ç™½é¢å¯¹é«˜å¤§ä¸Šè¯´è¯ä»°æ…•ä¹‹å¿ƒæ²¹ç„¶è€Œç”Ÿ @o@</p><p>ç„¶è€Œï¼Œç®—æ³•å¹¶ä¸ç¥ç§˜ = =</p><p>é¡¾åæ€ä¹‰ï¼Œ<strong>è®¡ç®—æ–¹æ³•</strong>ç®€ç§°ç®—æ³•ï¼ˆä»€ï¼Œä»€ï¼Œä»€ï¼Œä»€ä¹ˆï¼è¿™ä¹ˆç®€å•ï¼Ÿâ†’_â†’ï¼‰</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><blockquote><p>ä»å°å­¦å°±æ¥è§¦çš„ä¹˜æ³•ï¼šå¯¹ n+n+n+â€¦+n çš„ç®€å†™å°±æ˜¯ä¸€ç§ç®—æ³•ï¼ˆé€’æ¨æ³•<a href="é€’æ¨æ³•å³æ˜¯æŠŠä¸€ä¸ªå¤æ‚çš„åºå¤§çš„è®¡ç®—è¿‡ç¨‹è½¬åŒ–ä¸ºç®€å•è¿‡ç¨‹çš„å¤šæ¬¡é‡å¤">^A</a>ï¼‰,<br>ç®—æ³•æ³¨å®šè¦æœ‰è¾“å…¥ä¸è¾“å‡ºï¼šç®—å¼ä¸­çš„ n å³ä¸ºè¾“å…¥ï¼Œä¹˜ç§¯å³ä¸ºè¾“å‡ºã€‚</p></blockquote><p>æ³¨ï¼š</p><ul><li>ç®—æ³•ä¸­çš„çŠ¶æ€å˜åŒ–æ˜¯ä¸ç¡®å®šçš„</li><li>ç®—æ³•å¿…å®šèƒ½åœ¨æ‰§è¡Œæœ‰é™ä¸ªæ­¥éª¤ä¹‹åç»ˆæ­¢</li><li>æŸäº›ç®—æ³•åŠ å…¥éšæœºè¾“å…¥ï¼Œç§°ä¸ºéšæœºåŒ–ç®—æ³•</li></ul><h2 id="How-to-Assess-Algorithm"><a href="#How-to-Assess-Algorithm" class="headerlink" title="How to Assess Algorithm ?"></a>How to Assess Algorithm ?</h2><p>å¯¹ç®—æ³•çš„è¯„å®šåˆ†æä¸»è¦ä»<strong>æ—¶é—´å¤æ‚åº¦</strong>(æ‰€è€—æ—¶é—´é•¿çŸ­)ä¸<strong>ç©ºé—´å¤æ‚åº¦</strong>(ç©ºé—´å¼€æ”¯å¤§å°)æ¥è€ƒè™‘ã€‚</p><p>å…³äºå¤æ‚åº¦çš„è®¡ç®—éœ€è¦å¼•å…¥å¦‚ä¸‹æ¸è¿‘è®°å·ï¼š</p><blockquote><p><em>å¤§Oè®°å·ï¼š</em></p><blockquote><p><em>O(g(n)) = { f(n) : å­˜åœ¨æ­£å¸¸æ•°cå’Œn0 ï¼Œä½¿å¯¹æ‰€æœ‰çš„n &gt;= n0ï¼Œéƒ½æœ‰ 0 &lt;= f(n) &lt;= cg(n) }</em></p></blockquote></blockquote><blockquote><p><em>å¤§Î©è®°å·ï¼š</em></p><blockquote><p><em>Î©(g(n)) = { f(n) : å­˜åœ¨æ­£å¸¸æ•°cå’Œn0 ï¼Œä½¿å¯¹æ‰€æœ‰çš„n &gt;= n0ï¼Œéƒ½æœ‰ 0 &lt;= cg(n) &lt;= f(n) }</em></p></blockquote></blockquote><blockquote><p><em>å¤§Î˜è®°å·ï¼š</em></p><blockquote><p><em>Î˜(g(n)) = { f(n) : å­˜åœ¨æ­£å¸¸æ•°c1å’Œc2å’Œn0 ï¼Œä½¿å¯¹æ‰€æœ‰çš„n &gt;= n0ï¼Œéƒ½æœ‰ 0 &lt;= c1g(n) &lt;= f(n) &lt;= c2g(n) }</em></p></blockquote></blockquote><p><em>æ•°å­¦è¯æ˜èµ„æ–™ï¼š<a href="http://www.cnblogs.com/zabery/archive/2011/07/19/2110994.html" target="_blank" rel="noopener">è®¡ç®—æœºç®—æ³•åˆ†æä¹‹æ¸è¿›è®°å·</a></em></p><p>å…·ä½“è®¡ç®—æ–¹å¼å°†äºå®ä¾‹ä¸­ç»™å‡º ï½(~â–½~)ï½</p><h2 id="DIY-Algorithm-ï¼"><a href="#DIY-Algorithm-ï¼" class="headerlink" title="DIY Algorithm ï¼"></a>DIY Algorithm ï¼</h2><p>ä»¥ä¸‹ç»™å‡ºæ’åºç®—æ³•C++ä»£ç ï¼š</p><p>1.å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰<a href="å†’æ³¡æ’åºçš„æ€æƒ³æ˜¯è®©æœ€å¤§çš„æ•°æµ®åŠ¨åˆ°æ•°ç»„æœ€åçš„ä½ç½®ï¼Œå…¶æ¬¡å¤§çš„æ•°æµ®åŠ¨åˆ°æ•°ç»„å€’æ•°ç¬¬äºŒä¸ªä½ç½®ï¼Œä¾æ¬¡æ¨ç±»">^B</a><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">T temp;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n - <span class="number">1</span>;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n - <span class="number">1</span> - i;j++)</span><br><span class="line"><span class="keyword">if</span>(arr[j] &gt; arr[j + <span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line">temp = arr[j];</span><br><span class="line">arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ—¶é—´å¤æ‚åº¦åˆ†æï¼š</p><p>è€ƒè™‘æœ€åæƒ…å†µâ€“å°†é€†åºæ•°åˆ—å˜ä¸ºé¡ºåºï¼ˆæ­¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½éœ€è¦è¿›è¡Œäº¤æ¢è¿ç®—ï¼‰ T_T</p><blockquote><p>å†ä¸¾ä¸ªæ —å­ï¼š<strong>æ•°åˆ— 5 4 3 2 1 è¿›è¡Œå†’æ³¡å‡åºæ’åˆ—</strong><br>ç¬¬ä¸€æ¬¡å¤–å±‚å¾ªç¯ä»ç¬¬ä¸€ä¸ªæ•°5å¼€å§‹åˆ°å€’æ•°ç¬¬äºŒä¸ªæ•°2ç»“æŸï¼Œ<br>å…±è¿›è¡Œ4æ¬¡æ¯”è¾ƒäº¤æ¢è¿ç®—ï¼Œ5ç§»åˆ°æœ«å°¾ã€‚<br>ç¬¬äºŒæ¬¡å¤–å±‚å¾ªç¯ä»ç¬¬ä¸€ä¸ªæ•°4å¼€å§‹åˆ°å€’æ•°ç¬¬ä¸‰ä¸ªæ•°2ç»“æŸã€‚<br>å…±è¿›è¡Œ3æ¬¡æ¯”è¾ƒäº¤æ¢è¿ç®—ï¼Œ4ç§»åˆ°å€’æ•°ç¬¬äºŒä¸ªæ•°ã€‚<br>â€¦â€¦<br>ä¾æ¬¡æ¨ç±»ï¼Œæ€»æ¯”è¾ƒæ¬¡æ•°ä¸º 4 + 3 + 2 + 1 = 10 æ¬¡</p></blockquote><p>è¯æ˜ï¼š</p><p>æ ¹æ®æ•°å­¦å½’çº³æ³•,å¯¹äºnä½çš„æ•°åˆ—åˆ™æœ‰æ¯”è¾ƒæ¬¡æ•°ä¸º<code>(n-1) + (n-2) + ... + 1 = n \* (n - 1) / 2 = (n^2 - n) / 2</code></p><p>å¦‚å›¾<img src="http://images.51cto.com/files/uploadimg/20110826/211021569.jpg" alt="æ¯”è¾ƒæ¬¡æ•°"></p><p>è‹¥n = 10000ï¼Œåˆ™<code>(n^2 - n) / 2 = (100000000 - 10000) / 2</code></p><p>ç›¸å¯¹ 100000000 æ¥è¯´ 10000 å¾®ä¹å…¶å¾®ï¼Œæ•…æ€»è®¡ç®—æ¬¡æ•°çº¦ä¸º<code>0.5 \* N^2</code></p><p>ç”¨O(N^2)å°±è¡¨ç¤ºäº†å…¶æ•°é‡çº§ï¼ˆå¿½ç•¥å‰é¢ç³»æ•°0.5ï¼‰</p><p>å¾— <strong>å†’æ³¡æ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å†’æ³¡æ’åºæ”¹è¿›ç‰ˆï¼šè‹¥éå†ä¸­å¾—çŸ¥æ•°ç»„æœ‰åºåˆ™ç»“æŸæ’åº</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">T temp;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n - <span class="number">1</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n - <span class="number">1</span> - i;j++)</span><br><span class="line"><span class="keyword">if</span>(arr[j] &gt; arr[j + <span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="literal">true</span>;</span><br><span class="line">temp = arr[j];</span><br><span class="line">arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag == <span class="literal">false</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ”¹è¿›ç®—æ³•åï¼Œå¯¹äºä¸€ä¸ªæœ‰åºæ•°ç»„å®Œæˆä¸€æ¬¡å¤–å±‚å¾ªç¯åå°±ä¼šç»“æŸï¼Œå…±å‘ç”Ÿ N - 1 æ¬¡æ¯”è¾ƒï¼Œæ•…å‡çº§ç‰ˆå†’æ³¡æ’åºåœ¨æœ€ä¼˜æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N)</p><p>2.æ’å…¥æ’åº(Insert Sort)<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">T temp;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)</span><br><span class="line"><span class="keyword">if</span>(arr[i] &lt; arr[i - <span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line">temp = arr[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i - <span class="number">1</span>;j &gt;= <span class="number">0</span> &amp;&amp; arr[j] &gt; temp;j--)</span><br><span class="line">arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><em>èµ„æ–™ï¼š<a href="http://baidu.ku6.com/watch/05586300336858352205.html" target="_blank" rel="noopener">æ’å…¥æ’åºèˆè¹ˆ</a></em></p><p>3.*å½’å¹¶æ’åºï¼ˆMerge Sortï¼‰<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(T arr[],T temp[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(start &lt; last)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> mid = (start + last) / <span class="number">2</span>;</span><br><span class="line">mergeSort(arr,temp,start,mid);</span><br><span class="line">mergeSort(arr,temp,mid + <span class="number">1</span>,last);</span><br><span class="line">arrUnion(arr,temp,start,mid,last);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">arrUnion</span><span class="params">(T arr[],T temp[],<span class="keyword">int</span> start,<span class="keyword">int</span> mid,<span class="keyword">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j,k;</span><br><span class="line">i = start;</span><br><span class="line">j = mid + <span class="number">1</span>;</span><br><span class="line">k = start;</span><br><span class="line"><span class="keyword">while</span>(i != mid + <span class="number">1</span> &amp;&amp; j != last + <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(arr[i] &lt; arr[j])</span><br><span class="line">temp[k++] = arr[i++];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">temp[k++] = arr[j++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(i != mid + <span class="number">1</span>)</span><br><span class="line">temp[k++] = arr[i++];</span><br><span class="line"><span class="keyword">while</span>(j != last + <span class="number">1</span>)</span><br><span class="line">temp[k++] = arr[j++];</span><br><span class="line"><span class="keyword">for</span>(i = start;i &lt; last + <span class="number">1</span>;i++)</span><br><span class="line">arr[i] = temp[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><em>èµ„æ–™ï¼š<a href="http://visualgo.net/sorting" target="_blank" rel="noopener">æ’åºåŠ¨ç”»æ¼”ç¤º</a></em></p><h2 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison ."></a>Comparison .</h2><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡è¿™æ®µCè¯­è¨€ä»£ç æ¯”è¾ƒæ’åºé€Ÿåº¦ï¼Œç›´è§‚æ„Ÿå—æ—¶é—´å¤æ‚åº¦ã€‚<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArr</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(T arr[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quickSortRand</span><span class="params">(T arr[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(T arr[],T temp[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSortPlus</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">choseSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">clock_t</span> start, end;</span><br><span class="line">    <span class="keyword">int</span> a[N], b[N], c[N], d[N], e[N], f[N], g[N];</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        g[i] = f[i] = e[i] = d[i] = c[i] = b[i] = a[i] = rand()%<span class="number">100</span> + rand()%<span class="number">1000</span>;</span><br><span class="line">        <span class="comment">//g[i] = f[i] = e[i] = d[i] = c[i] = b[i] = a[i] = N - i;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">start = clock();</span><br><span class="line">    quickSortRand(a,<span class="number">0</span>,N - <span class="number">1</span>);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"éšæœºå¿«é€Ÿæ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(a,N);</span></span><br><span class="line"></span><br><span class="line">start = clock();</span><br><span class="line">    quickSort(b,<span class="number">0</span>,N - <span class="number">1</span>);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"å¿«é€Ÿæ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(b,N);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>* temp = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * N);</span><br><span class="line">    start = clock();</span><br><span class="line">    mergeSort(c,temp,<span class="number">0</span>,N - <span class="number">1</span>);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"å½’å¹¶æ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(c,N);</span></span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line"></span><br><span class="line">    start = clock();</span><br><span class="line">    insertSort(d,N);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"æ’å…¥æ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(d,N);</span></span><br><span class="line"></span><br><span class="line">    start = clock();</span><br><span class="line">    bubbleSort(e,N);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"å†’æ³¡æ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(e,N);</span></span><br><span class="line"></span><br><span class="line">    start = clock();</span><br><span class="line">    bubbleSortPlus(f,N);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"å‡çº§ç‰ˆå†’æ³¡æ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(f,N);</span></span><br><span class="line"></span><br><span class="line">start = clock();</span><br><span class="line">    choseSort(g,N);</span><br><span class="line">    end = clock();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"é€‰æ‹©æ’åºç”¨æ—¶%lfsec\n"</span>,(<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC);</span><br><span class="line">    <span class="comment">//printArr(g,N);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(T arr[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(start &lt; last)</span><br><span class="line">&#123;</span><br><span class="line">T temp;</span><br><span class="line"><span class="keyword">int</span> i = start;</span><br><span class="line"><span class="keyword">int</span> j = last;</span><br><span class="line"><span class="keyword">while</span>(i != j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(arr[j] &gt;= arr[start] &amp;&amp; j != i)</span><br><span class="line">j--;</span><br><span class="line"><span class="keyword">while</span>(arr[i] &lt;= arr[start] &amp;&amp; i != j)</span><br><span class="line">i++;</span><br><span class="line"><span class="keyword">if</span>(i != j)</span><br><span class="line">&#123;</span><br><span class="line">temp = arr[i];</span><br><span class="line">arr[i] = arr[j];</span><br><span class="line">arr[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">temp = arr[i];</span><br><span class="line">arr[i] = arr[start];</span><br><span class="line">arr[start] = temp;</span><br><span class="line">quickSort(arr, start, i - <span class="number">1</span>);</span><br><span class="line">quickSort(arr, i + <span class="number">1</span>, last);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quickSortRand</span><span class="params">(T arr[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(start &lt; last)</span><br><span class="line">&#123;</span><br><span class="line">T temp;</span><br><span class="line"><span class="keyword">int</span> i = start;</span><br><span class="line"><span class="keyword">int</span> j = last;</span><br><span class="line"><span class="keyword">int</span> pos = rand() % (last - start) + start;</span><br><span class="line">temp = arr[start];</span><br><span class="line">arr[start] = arr[pos];</span><br><span class="line">arr[pos] = temp;</span><br><span class="line"><span class="keyword">while</span>(i != j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(arr[j] &gt;= arr[start] &amp;&amp; j != i)</span><br><span class="line">j--;</span><br><span class="line"><span class="keyword">while</span>(arr[i] &lt;= arr[start] &amp;&amp; i != j)</span><br><span class="line">i++;</span><br><span class="line"><span class="keyword">if</span>(i != j)</span><br><span class="line">&#123;</span><br><span class="line">temp = arr[i];</span><br><span class="line">arr[i] = arr[j];</span><br><span class="line">arr[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">temp = arr[i];</span><br><span class="line">arr[i] = arr[start];</span><br><span class="line">arr[start] = temp;</span><br><span class="line">quickSortRand(arr, start, i - <span class="number">1</span>);</span><br><span class="line">quickSortRand(arr, i + <span class="number">1</span>, last);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(T arr[],T temp[],<span class="keyword">int</span> start,<span class="keyword">int</span> last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(start &lt; last)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (start + last) / <span class="number">2</span>;</span><br><span class="line">        mergeSort(arr,temp,start,mid);</span><br><span class="line">        mergeSort(arr,temp,mid + <span class="number">1</span>,last);</span><br><span class="line">        <span class="keyword">int</span> i,j,k;</span><br><span class="line">i = start;</span><br><span class="line">j = mid + <span class="number">1</span>;</span><br><span class="line">k = start;</span><br><span class="line"><span class="keyword">while</span>(i != mid + <span class="number">1</span> &amp;&amp; j != last + <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(arr[i] &lt; arr[j])</span><br><span class="line">temp[k++] = arr[i++];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">temp[k++] = arr[j++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(i != mid + <span class="number">1</span>)</span><br><span class="line">temp[k++] = arr[i++];</span><br><span class="line"><span class="keyword">while</span>(j != last + <span class="number">1</span>)</span><br><span class="line">temp[k++] = arr[j++];</span><br><span class="line"><span class="keyword">for</span>(i = start;i &lt; last + <span class="number">1</span>;i++)</span><br><span class="line">arr[i] = temp[i];</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)</span><br><span class="line">        <span class="keyword">if</span>(arr[i] &lt; arr[i - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            temp = arr[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i - <span class="number">1</span>;j &gt;= <span class="number">0</span> &amp;&amp; arr[j] &gt; temp;j--)</span><br><span class="line">                arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">            arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n - <span class="number">1</span>;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n - <span class="number">1</span> - i;j++)</span><br><span class="line">            <span class="keyword">if</span>(arr[j] &gt; arr[j + <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = arr[j];</span><br><span class="line">                arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">                arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSortPlus</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    T temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n - <span class="number">1</span> &amp;&amp; flag;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n - <span class="number">1</span> - i;j++)</span><br><span class="line">            <span class="keyword">if</span>(arr[j] &gt; arr[j + <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="literal">true</span>;</span><br><span class="line">                temp = arr[j];</span><br><span class="line">                arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">                arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">choseSort</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">T temp;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n - <span class="number">1</span>;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>;j &lt; n;j++)</span><br><span class="line"><span class="keyword">if</span>(arr[i] &gt; arr[j])</span><br><span class="line">&#123;</span><br><span class="line">                temp = arr[j];</span><br><span class="line">                arr[j] = arr[i];</span><br><span class="line">                arr[i] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArr</span><span class="params">(T arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, arr[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰§è¡Œæ¡ä»¶ï¼š</p><p><strong>ç¼–è¯‘ç¨‹åºVC 6.0</strong></p><p><strong>æ•°ç»„æˆå‘˜ 5000</strong></p><p>æ‰§è¡Œç»“æœï¼š</p><p><strong>éšæœºå¿«é€Ÿæ’åºç”¨æ—¶0.001000sec</strong></p><p><strong>å¿«é€Ÿæ’åºç”¨æ—¶0.001000sec</strong></p><p><strong>å½’å¹¶æ’åºç”¨æ—¶0.002000sec</strong></p><p><strong>æ’å…¥æ’åºç”¨æ—¶0.033000sec</strong></p><p><strong>å†’æ³¡æ’åºç”¨æ—¶0.090000sec</strong></p><p><strong>å‡çº§ç‰ˆå†’æ³¡æ’åºç”¨æ—¶0.089000sec</strong></p><p><strong>é€‰æ‹©æ’åºç”¨æ—¶0.083000sec</strong></p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡è¿™æ®µJAVAè¯­è¨€ä»£ç æ¯”è¾ƒæ’åºé€Ÿåº¦ï¼Œç›´è§‚æ„Ÿå—æ—¶é—´å¤æ‚åº¦ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Test.java</span></span><br><span class="line"><span class="keyword">package</span> pers.cz.sortcompare;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> pers.cz.sortcompare.Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> n = <span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] b = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] c = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] d = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] e = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] g = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">long</span> start, end;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">            g[i] = f[i] = e[i] = d[i] = c[i] = b[i] = a[i] = rand.nextInt();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        Sort.QuickSort(a, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"QuickSort cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(a);</span></span><br><span class="line">        </span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        Sort.QuickSortRand(b, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"QuickSortRand cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(b);</span></span><br><span class="line">        </span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">int</span>[] temp = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        Sort.MargeSort(c, <span class="number">0</span>, n - <span class="number">1</span>, temp);</span><br><span class="line">        temp = <span class="keyword">null</span>;</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"MargeSort cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(c);</span></span><br><span class="line"></span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        Sort.InsertSort(d);</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"InstertSort cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(d);</span></span><br><span class="line"></span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        Sort.BubbleSortPlus(e);</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"BubbleSortPlus cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(e);</span></span><br><span class="line"></span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        Sort.BubbleSort(f);</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"BubbleSort cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(f);</span></span><br><span class="line">        </span><br><span class="line">        start = System.currentTimeMillis();</span><br><span class="line">        Sort.ChoseSort(g);</span><br><span class="line">        end = System.currentTimeMillis();</span><br><span class="line">        System.out.print(<span class="string">"ChoseSort cost time(sec):"</span>);</span><br><span class="line">        System.out.println(end - start);</span><br><span class="line">        <span class="comment">//PrintArrData(g);</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintArrData</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> value : arr) &#123;</span><br><span class="line">            System.out.println(value);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Sort.java</span></span><br><span class="line"><span class="keyword">package</span> pers.cz.sortcompare;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ChoseSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[i] &gt; arr[j]) &#123;</span><br><span class="line">                    temp = arr[i];</span><br><span class="line">                    arr[i] = arr[j];</span><br><span class="line">                    arr[j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BubbleSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; arr.length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                    temp = arr[j];</span><br><span class="line">                    arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">                    arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BubbleSortPlus</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span> &amp;&amp; flag; i++) &#123;</span><br><span class="line">            flag = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; arr.length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                    flag = <span class="keyword">true</span>;</span><br><span class="line">                    temp = arr[j];</span><br><span class="line">                    arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">                    arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">InsertSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j, number;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &lt; arr[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                number = arr[i];</span><br><span class="line">                <span class="keyword">for</span> (j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; arr[j] &gt; number; j--) &#123;</span><br><span class="line">                    arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">                &#125;</span><br><span class="line">                arr[j + <span class="number">1</span>] = number;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MargeSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> start, <span class="keyword">int</span> last, <span class="keyword">int</span>[] temp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (start &lt; last) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (start + last) / <span class="number">2</span>;</span><br><span class="line">            Sort.MargeSort(arr, start, mid, temp);</span><br><span class="line">            Sort.MargeSort(arr, mid + <span class="number">1</span>, last, temp);</span><br><span class="line">            <span class="keyword">int</span> i, j, k;</span><br><span class="line">            i = start;</span><br><span class="line">            j = mid + <span class="number">1</span>;</span><br><span class="line">            k = start;</span><br><span class="line">            <span class="keyword">while</span> (i != mid + <span class="number">1</span> &amp;&amp; j != last + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[i] &lt; arr[j]) &#123;</span><br><span class="line">                    temp[k++] = arr[i++];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    temp[k++] = arr[j++];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (i != mid + <span class="number">1</span>) &#123;</span><br><span class="line">                temp[k++] = arr[i++];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (j != last + <span class="number">1</span>) &#123;</span><br><span class="line">                temp[k++] = arr[j++];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (i = start; i &lt; last + <span class="number">1</span>; i++) &#123;</span><br><span class="line">                arr[i] = temp[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">QuickSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> start, <span class="keyword">int</span> last)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (start &lt; last) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp;</span><br><span class="line">            <span class="keyword">int</span> i = start;</span><br><span class="line">            <span class="keyword">int</span> j = last;</span><br><span class="line">            <span class="keyword">while</span> (i != j) &#123;</span><br><span class="line">                <span class="keyword">while</span> (arr[j] &gt;= arr[start] &amp;&amp; j != i) &#123;</span><br><span class="line">                    j--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (arr[i] &lt;= arr[start] &amp;&amp; i != j) &#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i != j) &#123;</span><br><span class="line">                    temp = arr[i];</span><br><span class="line">                    arr[i] = arr[j];</span><br><span class="line">                    arr[j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            temp = arr[start];</span><br><span class="line">            arr[start] = arr[i];</span><br><span class="line">            arr[i] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">QuickSortRand</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> start, <span class="keyword">int</span> last)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (start &lt; last) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp;</span><br><span class="line">            <span class="keyword">int</span> i = start;</span><br><span class="line">            <span class="keyword">int</span> j = last;</span><br><span class="line">            Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> pos = rand.nextInt(last - start) + start;</span><br><span class="line">            temp = arr[start];</span><br><span class="line">            arr[start] = arr[pos];</span><br><span class="line">            arr[pos] = temp;</span><br><span class="line">            <span class="keyword">while</span> (i != j) &#123;</span><br><span class="line">                <span class="keyword">while</span> (arr[j] &gt;= arr[start] &amp;&amp; j != i) &#123;</span><br><span class="line">                    j--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (arr[i] &lt;= arr[start] &amp;&amp; i != j) &#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i != j) &#123;</span><br><span class="line">                    temp = arr[i];</span><br><span class="line">                    arr[i] = arr[j];</span><br><span class="line">                    arr[j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            temp = arr[start];</span><br><span class="line">            arr[start] = arr[i];</span><br><span class="line">            arr[i] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ¡ä»¶ï¼š</p><p><strong>ç¼–è¯‘ç¨‹åºNetBeans IDE 8.1</strong></p><p><strong>æ•°ç»„æˆå‘˜ 1000</strong></p><p>æ‰§è¡Œç»“æœï¼š</p><p><strong>QuickSort cost time(sec):1</strong></p><p><strong>QuickSortRand cost time(sec):0</strong></p><p><strong>MargeSort cost time(sec):1</strong></p><p><strong>InstertSort cost time(sec):5</strong></p><p><strong>BubbleSortPlus cost time(sec):14</strong></p><p><strong>BubbleSort cost time(sec):18</strong></p><p><strong>ChoseSort cost time(sec):9</strong></p>]]></content>
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å†’æ³¡ </tag>
            
            <tag> æ’å…¥ </tag>
            
            <tag> å½’å¹¶ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Test</title>
      <link href="/2018/03/22/Test/"/>
      <url>/2018/03/22/Test/</url>
      <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¸–</p>]]></content>
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test </tag>
            
            <tag> first </tag>
            
        </tags>
      
    </entry>
    
  
  
    
    <entry>
      <title>tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      <content type="html"><![CDATA[]]></content>
    </entry>
    
    <entry>
      <title>links</title>
      <link href="/links/index.html"/>
      <url>/links/index.html</url>
      <content type="html"><![CDATA[]]></content>
    </entry>
    
    <entry>
      <title>About</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é„™äººä¸æ‰ï¼Œå°åšä¾›é˜…</p><h2 id="è”ç³»æ–¹å¼"><a href="#è”ç³»æ–¹å¼" class="headerlink" title="è”ç³»æ–¹å¼"></a>è”ç³»æ–¹å¼</h2><ul><li>QQï¼š<a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2506649223&amp;site=qq&amp;menu=yes" target="_blank" rel="noopener">2506649223</a></li><li>Emailï¼š<a href="mailto:cz335360@gmail.com" target="_blank" rel="noopener">cz335360@gmail.com</a></li></ul>]]></content>
    </entry>
    
  
</search>
